{
  "hash": "64999f3bcaaa9645391ec2ef1ecf9020",
  "result": {
    "markdown": "---\ntitle: Access via API and R\nnumber-sections: true\n---\n\n\n\n\n\n\n**An application programming interface (API) is a way for two or more computer programs to communicate with each other.** More information about how to amend API links can be found [here](https://docs.oracle.com/en/database/oracle/oracle-rest-data-services/22.3/books.html#AELIG90103/). Useful introductions to using APIs in `R` can be found [here](https://www.dataquest.io/blog/r-api-tutorial/). \n\nThere are three tables the user can pull from the API. Learn more about them on the [FOSS data description page](https://afsc-gap-products.github.io/gap_products/content/foss-metadata.html). Here, you can see them in their raw JSON format:\n -  haul: (https://apps-st.fisheries.noaa.gov/ods/foss/afsc_groundfish_survey_haul/)[https://apps-st.fisheries.noaa.gov/ods/foss/afsc_groundfish_survey_haul/]\n - catch: (https://apps-st.fisheries.noaa.gov/ods/foss/afsc_groundfish_survey_catch/)[https://apps-st.fisheries.noaa.gov/ods/foss/afsc_groundfish_survey_catch/]\n - species: (https://apps-st.fisheries.noaa.gov/ods/foss/afsc_groundfish_survey_species/)[https://apps-st.fisheries.noaa.gov/ods/foss/afsc_groundfish_survey_species/]\n\nHere are some examples of how to use the data with R:\n\n# Examples of all species in all survey regions in all years\n\n## Ex. Load all rows of the catch, haul, and species data tables\n\nNote that without specifying, a basic query to the API will only return 25 entries. \n\n### Haul data: \n\n\n::: {.cell}\n\n```{.r .cell-code}\n# link to the API\napi_link_haul <- 'https://apps-st.fisheries.noaa.gov/ods/foss/afsc_groundfish_survey_haul/'\n```\n:::\n\n::: {.cell}\n\n:::\n\n\n**Load first 25 rows of data:** \n\n\n::: {.cell}\n\n```{.r .cell-code}\nres <- httr::GET(url = api_link_haul)\n# res ## Test connection\n\n## convert from JSON format\ndata <- jsonlite::fromJSON(base::rawToChar(res$content))\n\n# Find how many rows and columns are in the data pull\nprint(paste0(\"rows: \", dim(data$items)[1], \"; cols: \", dim(data$items)[2]))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"rows: 25; cols: 28\"\n```\n:::\n:::\n\n\n**Load all data:**\n\nSince the maxim number of rows a user can pull is 10,000 rows in a query, the user needs to cycle through by `offsetting` to the next 10,000 rows (as is shown here). \n\n\n::: {.cell}\n\n```{.r .cell-code}\ndat <- data.frame()\nfor (i in seq(0, 500000, 10000)){\n  ## find how many iterations it takes to cycle through the data\n  print(i)\n  ## query the API link\n  res <- httr::GET(url = paste0(api_link_haul, \"?offset=\",i,\"&limit=10000\"))\n  ## convert from JSON format\n  data <- jsonlite::fromJSON(base::rawToChar(res$content)) \n  \n  ## if there are no data, stop the loop\n  if (is.null(nrow(data$items))) {\n    break\n  }\n  \n  ## bind sub-pull to dat data.frame\n  dat <- dplyr::bind_rows(dat, \n                          data$items %>%\n                            dplyr::select(-links)) # necessary for API accounting, but not part of the dataset)\n}\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0\n[1] 10000\n[1] 20000\n[1] 30000\n[1] 40000\n```\n:::\n\n```{.r .cell-code}\nsummary(dat)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n      year          srvy              survey          survey_name       \n Min.   :1982   Length:33334       Length:33334       Length:33334      \n 1st Qu.:1996   Class :character   Class :character   Class :character  \n Median :2005   Mode  :character   Mode  :character   Mode  :character  \n Mean   :2005                                                           \n 3rd Qu.:2014                                                           \n Max.   :2023                                                           \n                                                                        \n survey_definition_id     cruise         cruisejoin         hauljoin      \n Min.   : 47.00       Min.   :198201   Min.   :   -766   Min.   : -23126  \n 1st Qu.: 47.00       1st Qu.:199601   1st Qu.:   -691   1st Qu.: -13535  \n Median : 78.00       Median :200501   Median :   -612   Median :  -3958  \n Mean   : 74.51       Mean   :200507   Mean   : 300438   Mean   : 295896  \n 3rd Qu.: 98.00       3rd Qu.:201401   3rd Qu.: 837800   3rd Qu.: 821743  \n Max.   :143.00       Max.   :202302   Max.   :1225395   Max.   :1225635  \n                                                                          \n      haul          stratum        station            vessel_id    \n Min.   :  1.0   Min.   : 10.0   Length:33334       Min.   :  1.0  \n 1st Qu.: 56.0   1st Qu.: 31.0   Class :character   1st Qu.: 88.0  \n Median :112.0   Median : 50.0   Mode  :character   Median : 94.0  \n Mean   :117.6   Mean   :129.1                      Mean   :106.9  \n 3rd Qu.:170.0   3rd Qu.:141.0                      3rd Qu.:147.0  \n Max.   :355.0   Max.   :794.0                      Max.   :178.0  \n                                                                   \n vessel_name         date_time         latitude_dd_start longitude_dd_start\n Length:33334       Length:33334       Min.   :51.19     Min.   :-180.0    \n Class :character   Class :character   1st Qu.:55.02     1st Qu.:-170.7    \n Mode  :character   Mode  :character   Median :57.18     Median :-165.2    \n                                       Mean   :56.89     Mean   :-140.4    \n                                       3rd Qu.:58.98     3rd Qu.:-154.4    \n                                       Max.   :65.34     Max.   : 180.0    \n                                                                           \n latitude_dd_end longitude_dd_end bottom_temperature_c surface_temperature_c\n Min.   :51.19   Min.   :-180.0   Min.   :-2.10        Min.   :-1.100       \n 1st Qu.:55.02   1st Qu.:-170.7   1st Qu.: 2.70        1st Qu.: 5.800       \n Median :57.18   Median :-165.2   Median : 4.10        Median : 7.500       \n Mean   :56.89   Mean   :-140.4   Mean   : 3.84        Mean   : 7.832       \n 3rd Qu.:58.97   3rd Qu.:-154.4   3rd Qu.: 5.20        3rd Qu.: 9.400       \n Max.   :65.35   Max.   : 180.0   Max.   :15.30        Max.   :18.100       \n NA's   :4       NA's   :4        NA's   :1601         NA's   :849          \n    depth_m     distance_fished_km  duration_hr      net_width_m   \n Min.   :   9   Min.   :0.135      Min.   :0.0250   Min.   : 7.51  \n 1st Qu.:  68   1st Qu.:1.498      1st Qu.:0.2710   1st Qu.:15.59  \n Median : 102   Median :2.527      Median :0.4900   Median :16.40  \n Mean   : 138   Mean   :2.207      Mean   :0.4007   Mean   :16.42  \n 3rd Qu.: 156   3rd Qu.:2.831      3rd Qu.:0.5090   3rd Qu.:17.21  \n Max.   :1200   Max.   :4.334      Max.   :0.9800   Max.   :23.82  \n                                                                   \n  net_height_m    area_swept_km2      performance    \n Min.   : 0.000   Min.   :0.002314   Min.   :0.0000  \n 1st Qu.: 2.399   1st Qu.:0.024251   1st Qu.:0.0000  \n Median : 5.886   Median :0.039562   Median :0.0000  \n Mean   : 4.841   Mean   :0.036404   Mean   :0.2777  \n 3rd Qu.: 6.799   3rd Qu.:0.047326   3rd Qu.:0.0000  \n Max.   :11.038   Max.   :0.077795   Max.   :7.0000  \n NA's   :3269                                        \n```\n:::\n\n```{.r .cell-code}\n# Find how many rows and columns are in the data pull\nprint(paste0(\"rows: \", dim(dat)[1], \"; cols: \", dim(dat)[2]))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"rows: 33334; cols: 27\"\n```\n:::\n\n```{.r .cell-code}\n# save outputs for later comparison\ndat_haul_api <- dat\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Print the first few lines of the data \nhead(dat, 3)\n```\n:::\n\n::: {.cell tbl-cap='First few rows of haul data. '}\n::: {.cell-output-display}\n```{=html}\n<div class=\"tabwid\"><style>.cl-f5333bac{}.cl-f52758b4{font-family:'Arial';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-f52758c8{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-f52ba086{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-f52ba09a{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-f52bbc06{width:0.75in;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f52bbc10{width:0.75in;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f52bbc11{width:0.75in;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f52bbc1a{width:0.75in;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f52bbc1b{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f52bbc24{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-f5333bac'><thead><tr style=\"overflow-wrap:break-word;\"><th class=\"cl-f52bbc06\"><p class=\"cl-f52ba086\"><span class=\"cl-f52758b4\">year</span></p></th><th class=\"cl-f52bbc10\"><p class=\"cl-f52ba09a\"><span class=\"cl-f52758b4\">srvy</span></p></th><th class=\"cl-f52bbc10\"><p class=\"cl-f52ba09a\"><span class=\"cl-f52758b4\">survey</span></p></th><th class=\"cl-f52bbc10\"><p class=\"cl-f52ba09a\"><span class=\"cl-f52758b4\">survey_name</span></p></th><th class=\"cl-f52bbc06\"><p class=\"cl-f52ba086\"><span class=\"cl-f52758b4\">survey_definition_id</span></p></th><th class=\"cl-f52bbc06\"><p class=\"cl-f52ba086\"><span class=\"cl-f52758b4\">cruise</span></p></th><th class=\"cl-f52bbc06\"><p class=\"cl-f52ba086\"><span class=\"cl-f52758b4\">cruisejoin</span></p></th><th class=\"cl-f52bbc06\"><p class=\"cl-f52ba086\"><span class=\"cl-f52758b4\">hauljoin</span></p></th><th class=\"cl-f52bbc06\"><p class=\"cl-f52ba086\"><span class=\"cl-f52758b4\">haul</span></p></th><th class=\"cl-f52bbc06\"><p class=\"cl-f52ba086\"><span class=\"cl-f52758b4\">stratum</span></p></th><th class=\"cl-f52bbc10\"><p class=\"cl-f52ba09a\"><span class=\"cl-f52758b4\">station</span></p></th><th class=\"cl-f52bbc06\"><p class=\"cl-f52ba086\"><span class=\"cl-f52758b4\">vessel_id</span></p></th><th class=\"cl-f52bbc10\"><p class=\"cl-f52ba09a\"><span class=\"cl-f52758b4\">vessel_name</span></p></th><th class=\"cl-f52bbc10\"><p class=\"cl-f52ba09a\"><span class=\"cl-f52758b4\">date_time</span></p></th><th class=\"cl-f52bbc06\"><p class=\"cl-f52ba086\"><span class=\"cl-f52758b4\">latitude_dd_start</span></p></th><th class=\"cl-f52bbc06\"><p class=\"cl-f52ba086\"><span class=\"cl-f52758b4\">longitude_dd_start</span></p></th><th class=\"cl-f52bbc06\"><p class=\"cl-f52ba086\"><span class=\"cl-f52758b4\">latitude_dd_end</span></p></th><th class=\"cl-f52bbc06\"><p class=\"cl-f52ba086\"><span class=\"cl-f52758b4\">longitude_dd_end</span></p></th><th class=\"cl-f52bbc06\"><p class=\"cl-f52ba086\"><span class=\"cl-f52758b4\">bottom_temperature_c</span></p></th><th class=\"cl-f52bbc06\"><p class=\"cl-f52ba086\"><span class=\"cl-f52758b4\">surface_temperature_c</span></p></th><th class=\"cl-f52bbc06\"><p class=\"cl-f52ba086\"><span class=\"cl-f52758b4\">depth_m</span></p></th><th class=\"cl-f52bbc06\"><p class=\"cl-f52ba086\"><span class=\"cl-f52758b4\">distance_fished_km</span></p></th><th class=\"cl-f52bbc06\"><p class=\"cl-f52ba086\"><span class=\"cl-f52758b4\">duration_hr</span></p></th><th class=\"cl-f52bbc06\"><p class=\"cl-f52ba086\"><span class=\"cl-f52758b4\">net_width_m</span></p></th><th class=\"cl-f52bbc06\"><p class=\"cl-f52ba086\"><span class=\"cl-f52758b4\">net_height_m</span></p></th><th class=\"cl-f52bbc06\"><p class=\"cl-f52ba086\"><span class=\"cl-f52758b4\">area_swept_km2</span></p></th><th class=\"cl-f52bbc06\"><p class=\"cl-f52ba086\"><span class=\"cl-f52758b4\">performance</span></p></th></tr></thead><tbody><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-f52bbc11\"><p class=\"cl-f52ba086\"><span class=\"cl-f52758c8\">2016</span></p></td><td class=\"cl-f52bbc1a\"><p class=\"cl-f52ba09a\"><span class=\"cl-f52758c8\">EBS</span></p></td><td class=\"cl-f52bbc1a\"><p class=\"cl-f52ba09a\"><span class=\"cl-f52758c8\">eastern Bering Sea</span></p></td><td class=\"cl-f52bbc1a\"><p class=\"cl-f52ba09a\"><span class=\"cl-f52758c8\">Eastern Bering Sea Crab/Groundfish Bottom Trawl Survey</span></p></td><td class=\"cl-f52bbc11\"><p class=\"cl-f52ba086\"><span class=\"cl-f52758c8\">98</span></p></td><td class=\"cl-f52bbc11\"><p class=\"cl-f52ba086\"><span class=\"cl-f52758c8\">201601</span></p></td><td class=\"cl-f52bbc11\"><p class=\"cl-f52ba086\"><span class=\"cl-f52758c8\">-707</span></p></td><td class=\"cl-f52bbc11\"><p class=\"cl-f52ba086\"><span class=\"cl-f52758c8\">-15,804</span></p></td><td class=\"cl-f52bbc11\"><p class=\"cl-f52ba086\"><span class=\"cl-f52758c8\">195</span></p></td><td class=\"cl-f52bbc11\"><p class=\"cl-f52ba086\"><span class=\"cl-f52758c8\">61</span></p></td><td class=\"cl-f52bbc1a\"><p class=\"cl-f52ba09a\"><span class=\"cl-f52758c8\">G-26</span></p></td><td class=\"cl-f52bbc11\"><p class=\"cl-f52ba086\"><span class=\"cl-f52758c8\">162</span></p></td><td class=\"cl-f52bbc1a\"><p class=\"cl-f52ba09a\"><span class=\"cl-f52758c8\">ALASKA KNIGHT</span></p></td><td class=\"cl-f52bbc1a\"><p class=\"cl-f52ba09a\"><span class=\"cl-f52758c8\">2016-07-26T08:08:20Z</span></p></td><td class=\"cl-f52bbc11\"><p class=\"cl-f52ba086\"><span class=\"cl-f52758c8\">57.01199</span></p></td><td class=\"cl-f52bbc11\"><p class=\"cl-f52ba086\"><span class=\"cl-f52758c8\">-173.2774</span></p></td><td class=\"cl-f52bbc11\"><p class=\"cl-f52ba086\"><span class=\"cl-f52758c8\">56.99235</span></p></td><td class=\"cl-f52bbc11\"><p class=\"cl-f52ba086\"><span class=\"cl-f52758c8\">-173.2501</span></p></td><td class=\"cl-f52bbc11\"><p class=\"cl-f52ba086\"><span class=\"cl-f52758c8\">4.4</span></p></td><td class=\"cl-f52bbc11\"><p class=\"cl-f52ba086\"><span class=\"cl-f52758c8\">11.6</span></p></td><td class=\"cl-f52bbc11\"><p class=\"cl-f52ba086\"><span class=\"cl-f52758c8\">143</span></p></td><td class=\"cl-f52bbc11\"><p class=\"cl-f52ba086\"><span class=\"cl-f52758c8\">2.743</span></p></td><td class=\"cl-f52bbc11\"><p class=\"cl-f52ba086\"><span class=\"cl-f52758c8\">0.497</span></p></td><td class=\"cl-f52bbc11\"><p class=\"cl-f52ba086\"><span class=\"cl-f52758c8\">17.534</span></p></td><td class=\"cl-f52bbc11\"><p class=\"cl-f52ba086\"><span class=\"cl-f52758c8\">1.739</span></p></td><td class=\"cl-f52bbc11\"><p class=\"cl-f52ba086\"><span class=\"cl-f52758c8\">0.048096</span></p></td><td class=\"cl-f52bbc11\"><p class=\"cl-f52ba086\"><span class=\"cl-f52758c8\">0</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-f52bbc1b\"><p class=\"cl-f52ba086\"><span class=\"cl-f52758c8\">2016</span></p></td><td class=\"cl-f52bbc24\"><p class=\"cl-f52ba09a\"><span class=\"cl-f52758c8\">EBS</span></p></td><td class=\"cl-f52bbc24\"><p class=\"cl-f52ba09a\"><span class=\"cl-f52758c8\">eastern Bering Sea</span></p></td><td class=\"cl-f52bbc24\"><p class=\"cl-f52ba09a\"><span class=\"cl-f52758c8\">Eastern Bering Sea Crab/Groundfish Bottom Trawl Survey</span></p></td><td class=\"cl-f52bbc1b\"><p class=\"cl-f52ba086\"><span class=\"cl-f52758c8\">98</span></p></td><td class=\"cl-f52bbc1b\"><p class=\"cl-f52ba086\"><span class=\"cl-f52758c8\">201601</span></p></td><td class=\"cl-f52bbc1b\"><p class=\"cl-f52ba086\"><span class=\"cl-f52758c8\">-706</span></p></td><td class=\"cl-f52bbc1b\"><p class=\"cl-f52ba086\"><span class=\"cl-f52758c8\">-15,779</span></p></td><td class=\"cl-f52bbc1b\"><p class=\"cl-f52ba086\"><span class=\"cl-f52758c8\">177</span></p></td><td class=\"cl-f52bbc1b\"><p class=\"cl-f52ba086\"><span class=\"cl-f52758c8\">62</span></p></td><td class=\"cl-f52bbc24\"><p class=\"cl-f52ba09a\"><span class=\"cl-f52758c8\">N-27</span></p></td><td class=\"cl-f52bbc1b\"><p class=\"cl-f52ba086\"><span class=\"cl-f52758c8\">94</span></p></td><td class=\"cl-f52bbc24\"><p class=\"cl-f52ba09a\"><span class=\"cl-f52758c8\">VESTERAALEN</span></p></td><td class=\"cl-f52bbc24\"><p class=\"cl-f52ba09a\"><span class=\"cl-f52758c8\">2016-07-23T07:20:29Z</span></p></td><td class=\"cl-f52bbc1b\"><p class=\"cl-f52ba086\"><span class=\"cl-f52758c8\">59.33460</span></p></td><td class=\"cl-f52bbc1b\"><p class=\"cl-f52ba086\"><span class=\"cl-f52758c8\">-174.4640</span></p></td><td class=\"cl-f52bbc1b\"><p class=\"cl-f52ba086\"><span class=\"cl-f52758c8\">59.33421</span></p></td><td class=\"cl-f52bbc1b\"><p class=\"cl-f52ba086\"><span class=\"cl-f52758c8\">-174.4129</span></p></td><td class=\"cl-f52bbc1b\"><p class=\"cl-f52ba086\"><span class=\"cl-f52758c8\">2.9</span></p></td><td class=\"cl-f52bbc1b\"><p class=\"cl-f52ba086\"><span class=\"cl-f52758c8\">11.3</span></p></td><td class=\"cl-f52bbc1b\"><p class=\"cl-f52ba086\"><span class=\"cl-f52758c8\">121</span></p></td><td class=\"cl-f52bbc1b\"><p class=\"cl-f52ba086\"><span class=\"cl-f52758c8\">2.915</span></p></td><td class=\"cl-f52bbc1b\"><p class=\"cl-f52ba086\"><span class=\"cl-f52758c8\">0.519</span></p></td><td class=\"cl-f52bbc1b\"><p class=\"cl-f52ba086\"><span class=\"cl-f52758c8\">17.531</span></p></td><td class=\"cl-f52bbc1b\"><p class=\"cl-f52ba086\"><span class=\"cl-f52758c8\">2.026</span></p></td><td class=\"cl-f52bbc1b\"><p class=\"cl-f52ba086\"><span class=\"cl-f52758c8\">0.051103</span></p></td><td class=\"cl-f52bbc1b\"><p class=\"cl-f52ba086\"><span class=\"cl-f52758c8\">0</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-f52bbc11\"><p class=\"cl-f52ba086\"><span class=\"cl-f52758c8\">2016</span></p></td><td class=\"cl-f52bbc1a\"><p class=\"cl-f52ba09a\"><span class=\"cl-f52758c8\">EBS</span></p></td><td class=\"cl-f52bbc1a\"><p class=\"cl-f52ba09a\"><span class=\"cl-f52758c8\">eastern Bering Sea</span></p></td><td class=\"cl-f52bbc1a\"><p class=\"cl-f52ba09a\"><span class=\"cl-f52758c8\">Eastern Bering Sea Crab/Groundfish Bottom Trawl Survey</span></p></td><td class=\"cl-f52bbc11\"><p class=\"cl-f52ba086\"><span class=\"cl-f52758c8\">98</span></p></td><td class=\"cl-f52bbc11\"><p class=\"cl-f52ba086\"><span class=\"cl-f52758c8\">201601</span></p></td><td class=\"cl-f52bbc11\"><p class=\"cl-f52ba086\"><span class=\"cl-f52758c8\">-706</span></p></td><td class=\"cl-f52bbc11\"><p class=\"cl-f52ba086\"><span class=\"cl-f52758c8\">-15,332</span></p></td><td class=\"cl-f52bbc11\"><p class=\"cl-f52ba086\"><span class=\"cl-f52758c8\">30</span></p></td><td class=\"cl-f52bbc11\"><p class=\"cl-f52ba086\"><span class=\"cl-f52758c8\">20</span></p></td><td class=\"cl-f52bbc1a\"><p class=\"cl-f52ba09a\"><span class=\"cl-f52758c8\">N-05</span></p></td><td class=\"cl-f52bbc11\"><p class=\"cl-f52ba086\"><span class=\"cl-f52758c8\">94</span></p></td><td class=\"cl-f52bbc1a\"><p class=\"cl-f52ba09a\"><span class=\"cl-f52758c8\">VESTERAALEN</span></p></td><td class=\"cl-f52bbc1a\"><p class=\"cl-f52ba09a\"><span class=\"cl-f52758c8\">2016-06-06T17:38:50Z</span></p></td><td class=\"cl-f52bbc11\"><p class=\"cl-f52ba086\"><span class=\"cl-f52758c8\">59.31723</span></p></td><td class=\"cl-f52bbc11\"><p class=\"cl-f52ba086\"><span class=\"cl-f52758c8\">-165.3036</span></p></td><td class=\"cl-f52bbc11\"><p class=\"cl-f52ba086\"><span class=\"cl-f52758c8\">59.34582</span></p></td><td class=\"cl-f52bbc11\"><p class=\"cl-f52ba086\"><span class=\"cl-f52758c8\">-165.3173</span></p></td><td class=\"cl-f52bbc11\"><p class=\"cl-f52ba086\"><span class=\"cl-f52758c8\">8.7</span></p></td><td class=\"cl-f52bbc11\"><p class=\"cl-f52ba086\"><span class=\"cl-f52758c8\">8.8</span></p></td><td class=\"cl-f52bbc11\"><p class=\"cl-f52ba086\"><span class=\"cl-f52758c8\">20</span></p></td><td class=\"cl-f52bbc11\"><p class=\"cl-f52ba086\"><span class=\"cl-f52758c8\">3.272</span></p></td><td class=\"cl-f52bbc11\"><p class=\"cl-f52ba086\"><span class=\"cl-f52758c8\">0.570</span></p></td><td class=\"cl-f52bbc11\"><p class=\"cl-f52ba086\"><span class=\"cl-f52758c8\">15.826</span></p></td><td class=\"cl-f52bbc11\"><p class=\"cl-f52ba086\"><span class=\"cl-f52758c8\">2.331</span></p></td><td class=\"cl-f52bbc11\"><p class=\"cl-f52ba086\"><span class=\"cl-f52758c8\">0.051783</span></p></td><td class=\"cl-f52bbc11\"><p class=\"cl-f52ba086\"><span class=\"cl-f52758c8\">0</span></p></td></tr></tbody></table></div>\n```\n:::\n:::\n\n\n### Catch data:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# link to the API\napi_link_catch <- 'https://apps-st.fisheries.noaa.gov/ods/foss/afsc_groundfish_survey_catch/'\n```\n:::\n\n::: {.cell}\n\n:::\n\n\n**Load first 25 rows of data:**\n\n\n::: {.cell}\n\n```{.r .cell-code}\nres <- httr::GET(url = api_link_catch)\n# res ## Test connection\n\n## convert from JSON format\ndata <- jsonlite::fromJSON(base::rawToChar(res$content))\n\n# Find how many rows and columns are in the data pull\nprint(paste0(\"rows: \", dim(data$items)[1], \"; cols: \", dim(data$items)[2]))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"rows: 25; cols: 8\"\n```\n:::\n:::\n\n\n**Load all data:**\n\nSince the maxim number of rows a user can pull is 10,000 rows in a query, the user needs to cycle through by `offsetting` to the next 10,000 rows (as is shown here). \n\n\n::: {.cell}\n\n```{.r .cell-code}\ndat <- data.frame()\nfor (i in seq(0, 1000000, 10000)){\n  ## find how many iterations it takes to cycle through the data\n  print(i)\n  ## query the API link\n  res <- httr::GET(url = paste0(api_link_catch, \"?offset=\",i,\"&limit=10000\"))\n  ## convert from JSON format\n  data <- jsonlite::fromJSON(base::rawToChar(res$content)) \n  \n  ## if there are no data, stop the loop\n  if (is.null(nrow(data$items))) {\n    break\n  }\n  \n  ## bind sub-pull to dat data.frame\n  dat <- dplyr::bind_rows(dat, \n                          data$items %>%\n                            dplyr::select(-links)) # necessary for API accounting, but not part of the dataset)\n}\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0\n[1] 10000\n[1] 20000\n[1] 30000\n[1] 40000\n[1] 50000\n[1] 60000\n[1] 70000\n[1] 80000\n[1] 90000\n[1] 100000\n[1] 110000\n[1] 120000\n[1] 130000\n[1] 140000\n[1] 150000\n[1] 160000\n[1] 170000\n[1] 180000\n[1] 190000\n[1] 200000\n[1] 210000\n[1] 220000\n[1] 230000\n[1] 240000\n[1] 250000\n[1] 260000\n[1] 270000\n[1] 280000\n[1] 290000\n[1] 300000\n[1] 310000\n[1] 320000\n[1] 330000\n[1] 340000\n[1] 350000\n[1] 360000\n[1] 370000\n[1] 380000\n[1] 390000\n[1] 400000\n[1] 410000\n[1] 420000\n[1] 430000\n[1] 440000\n[1] 450000\n[1] 460000\n[1] 470000\n[1] 480000\n[1] 490000\n[1] 500000\n[1] 510000\n[1] 520000\n[1] 530000\n[1] 540000\n[1] 550000\n[1] 560000\n[1] 570000\n[1] 580000\n[1] 590000\n[1] 600000\n[1] 610000\n[1] 620000\n[1] 630000\n[1] 640000\n[1] 650000\n[1] 660000\n[1] 670000\n[1] 680000\n[1] 690000\n[1] 700000\n[1] 710000\n[1] 720000\n[1] 730000\n[1] 740000\n[1] 750000\n[1] 760000\n[1] 770000\n[1] 780000\n[1] 790000\n[1] 800000\n[1] 810000\n[1] 820000\n[1] 830000\n[1] 840000\n[1] 850000\n[1] 860000\n[1] 870000\n[1] 880000\n[1] 890000\n[1] 900000\n[1] 910000\n[1] 920000\n[1] 930000\n[1] 940000\n```\n:::\n\n```{.r .cell-code}\nsummary(dat)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n    hauljoin        species_code     cpue_kgkm2        cpue_nokm2      \n Min.   : -23126   Min.   :    1   Min.   :      0   Min.   :      13  \n 1st Qu.: -13968   1st Qu.:21333   1st Qu.:      5   1st Qu.:      56  \n Median :  -5200   Median :43010   Median :     40   Median :     207  \n Mean   : 286755   Mean   :47620   Mean   :   1146   Mean   :    4379  \n 3rd Qu.: 816166   3rd Qu.:72751   3rd Qu.:    316   3rd Qu.:    1079  \n Max.   :1225635   Max.   :99999   Max.   :3226235   Max.   :21780780  \n                                                     NA's   :118525    \n     count          weight_kg         taxon_confidence  \n Min.   :     1   Min.   :    0.001   Length:939197     \n 1st Qu.:     2   1st Qu.:    0.168   Class :character  \n Median :     7   Median :    1.480   Mode  :character  \n Mean   :   172   Mean   :   38.354                     \n 3rd Qu.:    41   3rd Qu.:   11.700                     \n Max.   :867119   Max.   :18187.700                     \n NA's   :118525                                         \n```\n:::\n\n```{.r .cell-code}\n# Find how many rows and columns are in the data pull\nprint(paste0(\"rows: \", dim(dat)[1], \"; cols: \", dim(dat)[2]))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"rows: 939197; cols: 7\"\n```\n:::\n\n```{.r .cell-code}\n# save outputs for later comparison\ndat_catch_api <- dat\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Print the first few lines of the data \nhead(dat_catch_api, 3)\n```\n:::\n\n::: {.cell tbl-cap='First few rows of catch data. '}\n::: {.cell-output-display}\n```{=html}\n<div class=\"tabwid\"><style>.cl-98838afa{}.cl-9878f89c{font-family:'Arial';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-9878f8b0{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-987cbe8c{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-987cbea0{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-987cd7f0{width:0.75in;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-987cd7fa{width:0.75in;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-987cd804{width:0.75in;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-987cd805{width:0.75in;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-987cd80e{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-987cd818{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-98838afa'><thead><tr style=\"overflow-wrap:break-word;\"><th class=\"cl-987cd7f0\"><p class=\"cl-987cbe8c\"><span class=\"cl-9878f89c\">hauljoin</span></p></th><th class=\"cl-987cd7f0\"><p class=\"cl-987cbe8c\"><span class=\"cl-9878f89c\">species_code</span></p></th><th class=\"cl-987cd7f0\"><p class=\"cl-987cbe8c\"><span class=\"cl-9878f89c\">cpue_kgkm2</span></p></th><th class=\"cl-987cd7f0\"><p class=\"cl-987cbe8c\"><span class=\"cl-9878f89c\">cpue_nokm2</span></p></th><th class=\"cl-987cd7f0\"><p class=\"cl-987cbe8c\"><span class=\"cl-9878f89c\">count</span></p></th><th class=\"cl-987cd7f0\"><p class=\"cl-987cbe8c\"><span class=\"cl-9878f89c\">weight_kg</span></p></th><th class=\"cl-987cd7fa\"><p class=\"cl-987cbea0\"><span class=\"cl-9878f89c\">taxon_confidence</span></p></th></tr></thead><tbody><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-987cd804\"><p class=\"cl-987cbe8c\"><span class=\"cl-9878f8b0\">-12,549</span></p></td><td class=\"cl-987cd804\"><p class=\"cl-987cbe8c\"><span class=\"cl-9878f8b0\">72500</span></p></td><td class=\"cl-987cd804\"><p class=\"cl-987cbe8c\"><span class=\"cl-9878f8b0\">2.827807</span></p></td><td class=\"cl-987cd804\"><p class=\"cl-987cbe8c\"><span class=\"cl-9878f8b0\">45.60979</span></p></td><td class=\"cl-987cd804\"><p class=\"cl-987cbe8c\"><span class=\"cl-9878f8b0\">1</span></p></td><td class=\"cl-987cd804\"><p class=\"cl-987cbe8c\"><span class=\"cl-9878f8b0\">0.062</span></p></td><td class=\"cl-987cd805\"><p class=\"cl-987cbea0\"><span class=\"cl-9878f8b0\">1</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-987cd80e\"><p class=\"cl-987cbe8c\"><span class=\"cl-9878f8b0\">-12,556</span></p></td><td class=\"cl-987cd80e\"><p class=\"cl-987cbe8c\"><span class=\"cl-9878f8b0\">99993</span></p></td><td class=\"cl-987cd80e\"><p class=\"cl-987cbe8c\"><span class=\"cl-9878f8b0\">0.169097</span></p></td><td class=\"cl-987cd80e\"><p class=\"cl-987cbe8c\"><span class=\"cl-9878f8b0\">42.27421</span></p></td><td class=\"cl-987cd80e\"><p class=\"cl-987cbe8c\"><span class=\"cl-9878f8b0\">1</span></p></td><td class=\"cl-987cd80e\"><p class=\"cl-987cbe8c\"><span class=\"cl-9878f8b0\">0.004</span></p></td><td class=\"cl-987cd818\"><p class=\"cl-987cbea0\"><span class=\"cl-9878f8b0\">1</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-987cd804\"><p class=\"cl-987cbe8c\"><span class=\"cl-9878f8b0\">-12,521</span></p></td><td class=\"cl-987cd804\"><p class=\"cl-987cbe8c\"><span class=\"cl-9878f8b0\">30060</span></p></td><td class=\"cl-987cd804\"><p class=\"cl-987cbe8c\"><span class=\"cl-9878f8b0\">24.596616</span></p></td><td class=\"cl-987cd804\"><p class=\"cl-987cbe8c\"><span class=\"cl-9878f8b0\">43.15196</span></p></td><td class=\"cl-987cd804\"><p class=\"cl-987cbe8c\"><span class=\"cl-9878f8b0\">1</span></p></td><td class=\"cl-987cd804\"><p class=\"cl-987cbe8c\"><span class=\"cl-9878f8b0\">0.570</span></p></td><td class=\"cl-987cd805\"><p class=\"cl-987cbea0\"><span class=\"cl-9878f8b0\">1</span></p></td></tr></tbody></table></div>\n```\n:::\n:::\n\n\n### Species data:\n\nSince there are less than 10,000 rows of species data (and the maxim number of rows a user can pull from this API is 10,000 rows in a query), we can simply call `?offset=0&limit=10000` in our query call. \n\n\n::: {.cell}\n\n```{.r .cell-code}\n# link to the API\napi_link_species <- 'https://apps-st.fisheries.noaa.gov/ods/foss/afsc_groundfish_survey_species/'\n```\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nres <- httr::GET(url = paste0(api_link_species, \"?offset=0&limit=10000\"))\n\n# res ## Test connection\n\n## convert from JSON format\ndata <- jsonlite::fromJSON(base::rawToChar(res$content))\ndat <- data$items  %>%\n  dplyr::select(-links) # necessary for API accounting, but not part of the dataset\n\nsummary(dat)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  species_code   scientific_name    common_name          id_rank         \n Min.   :    1   Length:1894        Length:1894        Length:1894       \n 1st Qu.:30105   Class :character   Class :character   Class :character  \n Median :70061   Mode  :character   Mode  :character   Mode  :character  \n Mean   :58788                                                           \n 3rd Qu.:80543                                                           \n Max.   :99999                                                           \n                                                                         \n     worms              itis        \n Min.   :     51   Min.   :  46861  \n 1st Qu.: 134194   1st Qu.:  79433  \n Median : 254533   Median : 157165  \n Mean   : 299858   Mean   : 209114  \n 3rd Qu.: 368813   3rd Qu.: 167413  \n Max.   :1699283   Max.   :1206057  \n NA's   :233       NA's   :388      \n```\n:::\n\n```{.r .cell-code}\n# Find how many rows and columns are in the data pull\nprint(paste0(\"rows: \", dim(dat)[1], \"; cols: \", dim(dat)[2]))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"rows: 1894; cols: 6\"\n```\n:::\n\n```{.r .cell-code}\n# save outputs for later comparison\ndat_species_api <- dat\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Print the first few lines of the data \nhead(data$items, 3)\n```\n:::\n\n::: {.cell tbl-cap='First few rows of species data. '}\n::: {.cell-output-display}\n```{=html}\n<div class=\"tabwid\"><style>.cl-991862ce{}.cl-990da078{font-family:'Arial';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-990da082{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-99118440{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-9911844a{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-99119e08{width:0.75in;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-99119e1c{width:0.75in;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-99119e1d{width:0.75in;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-99119e26{width:0.75in;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-99119e27{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-99119e30{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-991862ce'><thead><tr style=\"overflow-wrap:break-word;\"><th class=\"cl-99119e08\"><p class=\"cl-99118440\"><span class=\"cl-990da078\">species_code</span></p></th><th class=\"cl-99119e1c\"><p class=\"cl-9911844a\"><span class=\"cl-990da078\">scientific_name</span></p></th><th class=\"cl-99119e1c\"><p class=\"cl-9911844a\"><span class=\"cl-990da078\">common_name</span></p></th><th class=\"cl-99119e1c\"><p class=\"cl-9911844a\"><span class=\"cl-990da078\">id_rank</span></p></th><th class=\"cl-99119e08\"><p class=\"cl-99118440\"><span class=\"cl-990da078\">worms</span></p></th><th class=\"cl-99119e08\"><p class=\"cl-99118440\"><span class=\"cl-990da078\">itis</span></p></th><th class=\"cl-99119e08\"><p class=\"cl-99118440\"><span class=\"cl-990da078\">links</span></p></th></tr></thead><tbody><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-99119e1d\"><p class=\"cl-99118440\"><span class=\"cl-990da082\">22200</span></p></td><td class=\"cl-99119e26\"><p class=\"cl-9911844a\"><span class=\"cl-990da082\">Liparidae</span></p></td><td class=\"cl-99119e26\"><p class=\"cl-9911844a\"><span class=\"cl-990da082\">snailfish unid.</span></p></td><td class=\"cl-99119e26\"><p class=\"cl-9911844a\"><span class=\"cl-990da082\">family</span></p></td><td class=\"cl-99119e1d\"><p class=\"cl-99118440\"><span class=\"cl-990da082\">234519</span></p></td><td class=\"cl-99119e1d\"><p class=\"cl-99118440\"><span class=\"cl-990da082\">555701</span></p></td><td class=\"cl-99119e1d\"><p class=\"cl-99118440\"><span class=\"cl-990da082\">[[data.frame]]</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-99119e27\"><p class=\"cl-99118440\"><span class=\"cl-990da082\">22204</span></p></td><td class=\"cl-99119e30\"><p class=\"cl-9911844a\"><span class=\"cl-990da082\">Liparis dennyi</span></p></td><td class=\"cl-99119e30\"><p class=\"cl-9911844a\"><span class=\"cl-990da082\">marbled snailfish</span></p></td><td class=\"cl-99119e30\"><p class=\"cl-9911844a\"><span class=\"cl-990da082\">species</span></p></td><td class=\"cl-99119e27\"><p class=\"cl-99118440\"><span class=\"cl-990da082\">254550</span></p></td><td class=\"cl-99119e27\"><p class=\"cl-99118440\"><span class=\"cl-990da082\">167557</span></p></td><td class=\"cl-99119e27\"><p class=\"cl-99118440\"><span class=\"cl-990da082\">[[data.frame]]</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-99119e1d\"><p class=\"cl-99118440\"><span class=\"cl-990da082\">22209</span></p></td><td class=\"cl-99119e26\"><p class=\"cl-9911844a\"><span class=\"cl-990da082\">Liparis callyodon</span></p></td><td class=\"cl-99119e26\"><p class=\"cl-9911844a\"><span class=\"cl-990da082\">spotted snailfish</span></p></td><td class=\"cl-99119e26\"><p class=\"cl-9911844a\"><span class=\"cl-990da082\">species</span></p></td><td class=\"cl-99119e1d\"><p class=\"cl-99118440\"><span class=\"cl-990da082\">274505</span></p></td><td class=\"cl-99119e1d\"><p class=\"cl-99118440\"><span class=\"cl-990da082\">167553</span></p></td><td class=\"cl-99119e1d\"><p class=\"cl-99118440\"><span class=\"cl-990da082\">[[data.frame]]</span></p></td></tr></tbody></table></div>\n```\n:::\n:::\n\n\n### Create zero-filled data for 2023 eastern Bering Sea walleye pollock and plot\n\nIt is important to create and have access to zero-fill (presence and absence) so you can do simple analyses and plot data. \n\n\n::: {.cell}\n\n```{.r .cell-code}\n# come up with full combination of what species should be listed for what hauls/surveys\n# for zero-filled data, all species caught in a survey need to have zero or non-zero row entries for a haul\ncomb <- dplyr::full_join(\n  # find all species that have been caught, by survey\n  x = dplyr::left_join(dat_catch_api, dat_haul_api, by = \"hauljoin\") %>%\n    dplyr::select(survey_definition_id, species_code) %>%\n    dplyr::distinct(),\n  # find all haul events (hauljoins), by survey\n  y = dat_haul_api %>%\n    dplyr::select(survey_definition_id, hauljoin) %>%\n    dplyr::distinct(),\n  relationship = \"many-to-many\",\n  by = \"survey_definition_id\"\n) %>% \n  dplyr::select(-survey_definition_id) # redundant\n\nhead(comb, 3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  species_code hauljoin\n1        72500   -21545\n2        72500   -21474\n3        72500   -21217\n```\n:::\n\n```{.r .cell-code}\n# Join data to make a full zero-filled CPUE dataset\n\ndat_zerofill_api <- comb %>%\n  # add species data to unique species by survey table\n  dplyr::left_join(dat_species_api) %>% # , \"species_code\"\n  # add haul data\n  dplyr::left_join(dat_haul_api) %>% # , c(\"hauljoin\")\n  # add catch data\n  dplyr::left_join(dat_catch_api) %>% # , c(\"species_code\", \"hauljoin\")\n  # modify zero-filled rows\n  dplyr::mutate(\n    cpue_kgkm2 = ifelse(is.na(cpue_kgkm2), 0, cpue_kgkm2),\n    cpue_nokm2 = ifelse(is.na(cpue_nokm2), 0, cpue_nokm2),\n    count = ifelse(is.na(count), 0, count),\n    weight_kg = ifelse(is.na(weight_kg), 0, weight_kg))\n\n## Find how many rows and columns are in the data pull. \n## Because all of the data have been full joined together, \n## there should be the maximum number of rows. \nprint(paste0(\"rows: \", dim(dat)[1], \"; cols: \", dim(dat)[2]))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"rows: 1894; cols: 6\"\n```\n:::\n\n```{.r .cell-code}\nhead(dat, 3) %>% \n  flextable::flextable() %>% flextable::theme_zebra()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"tabwid\"><style>.cl-b8135170{}.cl-b805ec92{font-family:'Arial';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-b805ed00{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-b80b142e{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-b80b1442{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-b80b34a4{width:0.75in;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b80b34ae{width:0.75in;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b80b34b8{width:0.75in;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b80b34c2{width:0.75in;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b80b34cc{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b80b34cd{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-b8135170'><thead><tr style=\"overflow-wrap:break-word;\"><th class=\"cl-b80b34a4\"><p class=\"cl-b80b142e\"><span class=\"cl-b805ec92\">species_code</span></p></th><th class=\"cl-b80b34ae\"><p class=\"cl-b80b1442\"><span class=\"cl-b805ec92\">scientific_name</span></p></th><th class=\"cl-b80b34ae\"><p class=\"cl-b80b1442\"><span class=\"cl-b805ec92\">common_name</span></p></th><th class=\"cl-b80b34ae\"><p class=\"cl-b80b1442\"><span class=\"cl-b805ec92\">id_rank</span></p></th><th class=\"cl-b80b34a4\"><p class=\"cl-b80b142e\"><span class=\"cl-b805ec92\">worms</span></p></th><th class=\"cl-b80b34a4\"><p class=\"cl-b80b142e\"><span class=\"cl-b805ec92\">itis</span></p></th></tr></thead><tbody><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-b80b34b8\"><p class=\"cl-b80b142e\"><span class=\"cl-b805ed00\">22,200</span></p></td><td class=\"cl-b80b34c2\"><p class=\"cl-b80b1442\"><span class=\"cl-b805ed00\">Liparidae</span></p></td><td class=\"cl-b80b34c2\"><p class=\"cl-b80b1442\"><span class=\"cl-b805ed00\">snailfish unid.</span></p></td><td class=\"cl-b80b34c2\"><p class=\"cl-b80b1442\"><span class=\"cl-b805ed00\">family</span></p></td><td class=\"cl-b80b34b8\"><p class=\"cl-b80b142e\"><span class=\"cl-b805ed00\">234,519</span></p></td><td class=\"cl-b80b34b8\"><p class=\"cl-b80b142e\"><span class=\"cl-b805ed00\">555,701</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-b80b34cc\"><p class=\"cl-b80b142e\"><span class=\"cl-b805ed00\">22,204</span></p></td><td class=\"cl-b80b34cd\"><p class=\"cl-b80b1442\"><span class=\"cl-b805ed00\">Liparis dennyi</span></p></td><td class=\"cl-b80b34cd\"><p class=\"cl-b80b1442\"><span class=\"cl-b805ed00\">marbled snailfish</span></p></td><td class=\"cl-b80b34cd\"><p class=\"cl-b80b1442\"><span class=\"cl-b805ed00\">species</span></p></td><td class=\"cl-b80b34cc\"><p class=\"cl-b80b142e\"><span class=\"cl-b805ed00\">254,550</span></p></td><td class=\"cl-b80b34cc\"><p class=\"cl-b80b142e\"><span class=\"cl-b805ed00\">167,557</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-b80b34b8\"><p class=\"cl-b80b142e\"><span class=\"cl-b805ed00\">22,209</span></p></td><td class=\"cl-b80b34c2\"><p class=\"cl-b80b1442\"><span class=\"cl-b805ed00\">Liparis callyodon</span></p></td><td class=\"cl-b80b34c2\"><p class=\"cl-b80b1442\"><span class=\"cl-b805ed00\">spotted snailfish</span></p></td><td class=\"cl-b80b34c2\"><p class=\"cl-b80b1442\"><span class=\"cl-b805ed00\">species</span></p></td><td class=\"cl-b80b34b8\"><p class=\"cl-b80b142e\"><span class=\"cl-b805ed00\">274,505</span></p></td><td class=\"cl-b80b34b8\"><p class=\"cl-b80b142e\"><span class=\"cl-b805ed00\">167,553</span></p></td></tr></tbody></table></div>\n```\n:::\n:::\n\n\n### Visualize CPUE data in distribution map\n\nUsing the zero-filled data from the previous example, we can make a few plots! \n\nHere is some example data of 2023 through 2019 (`year %in% 2019:2023`) eastern and northern Bering Sea (`srvy == c(\"EBS\", \"NBS)`) walleye pollock (`species_code == 21740`). \n\n\n::: {.cell}\n\n```{.r .cell-code}\ndat0 <- dat_zerofill_api %>% \n  dplyr::filter(year %in% c(2019:2023) & \n                  srvy == c(\"EBS\", \"NBS\") & \n                  species_code == 21740)\nprint(paste0(\"rows: \", dim(dat)[1], \"; cols: \", dim(dat)[2]))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"rows: 1894; cols: 6\"\n```\n:::\n\n```{.r .cell-code}\nhead(dat0, 3) %>% flextable::flextable() %>% flextable::theme_zebra()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"tabwid\"><style>.cl-ba010d92{}.cl-b9f3d99c{font-family:'Arial';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-b9f3d9b0{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-b9f8a63e{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-b9f8a648{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-b9f8c560{width:0.75in;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b9f8c561{width:0.75in;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b9f8c56a{width:0.75in;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b9f8c574{width:0.75in;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b9f8c575{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b9f8c57e{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-ba010d92'><thead><tr style=\"overflow-wrap:break-word;\"><th class=\"cl-b9f8c560\"><p class=\"cl-b9f8a63e\"><span class=\"cl-b9f3d99c\">species_code</span></p></th><th class=\"cl-b9f8c560\"><p class=\"cl-b9f8a63e\"><span class=\"cl-b9f3d99c\">hauljoin</span></p></th><th class=\"cl-b9f8c561\"><p class=\"cl-b9f8a648\"><span class=\"cl-b9f3d99c\">scientific_name</span></p></th><th class=\"cl-b9f8c561\"><p class=\"cl-b9f8a648\"><span class=\"cl-b9f3d99c\">common_name</span></p></th><th class=\"cl-b9f8c561\"><p class=\"cl-b9f8a648\"><span class=\"cl-b9f3d99c\">id_rank</span></p></th><th class=\"cl-b9f8c560\"><p class=\"cl-b9f8a63e\"><span class=\"cl-b9f3d99c\">worms</span></p></th><th class=\"cl-b9f8c560\"><p class=\"cl-b9f8a63e\"><span class=\"cl-b9f3d99c\">itis</span></p></th><th class=\"cl-b9f8c560\"><p class=\"cl-b9f8a63e\"><span class=\"cl-b9f3d99c\">year</span></p></th><th class=\"cl-b9f8c561\"><p class=\"cl-b9f8a648\"><span class=\"cl-b9f3d99c\">srvy</span></p></th><th class=\"cl-b9f8c561\"><p class=\"cl-b9f8a648\"><span class=\"cl-b9f3d99c\">survey</span></p></th><th class=\"cl-b9f8c561\"><p class=\"cl-b9f8a648\"><span class=\"cl-b9f3d99c\">survey_name</span></p></th><th class=\"cl-b9f8c560\"><p class=\"cl-b9f8a63e\"><span class=\"cl-b9f3d99c\">survey_definition_id</span></p></th><th class=\"cl-b9f8c560\"><p class=\"cl-b9f8a63e\"><span class=\"cl-b9f3d99c\">cruise</span></p></th><th class=\"cl-b9f8c560\"><p class=\"cl-b9f8a63e\"><span class=\"cl-b9f3d99c\">cruisejoin</span></p></th><th class=\"cl-b9f8c560\"><p class=\"cl-b9f8a63e\"><span class=\"cl-b9f3d99c\">haul</span></p></th><th class=\"cl-b9f8c560\"><p class=\"cl-b9f8a63e\"><span class=\"cl-b9f3d99c\">stratum</span></p></th><th class=\"cl-b9f8c561\"><p class=\"cl-b9f8a648\"><span class=\"cl-b9f3d99c\">station</span></p></th><th class=\"cl-b9f8c560\"><p class=\"cl-b9f8a63e\"><span class=\"cl-b9f3d99c\">vessel_id</span></p></th><th class=\"cl-b9f8c561\"><p class=\"cl-b9f8a648\"><span class=\"cl-b9f3d99c\">vessel_name</span></p></th><th class=\"cl-b9f8c561\"><p class=\"cl-b9f8a648\"><span class=\"cl-b9f3d99c\">date_time</span></p></th><th class=\"cl-b9f8c560\"><p class=\"cl-b9f8a63e\"><span class=\"cl-b9f3d99c\">latitude_dd_start</span></p></th><th class=\"cl-b9f8c560\"><p class=\"cl-b9f8a63e\"><span class=\"cl-b9f3d99c\">longitude_dd_start</span></p></th><th class=\"cl-b9f8c560\"><p class=\"cl-b9f8a63e\"><span class=\"cl-b9f3d99c\">latitude_dd_end</span></p></th><th class=\"cl-b9f8c560\"><p class=\"cl-b9f8a63e\"><span class=\"cl-b9f3d99c\">longitude_dd_end</span></p></th><th class=\"cl-b9f8c560\"><p class=\"cl-b9f8a63e\"><span class=\"cl-b9f3d99c\">bottom_temperature_c</span></p></th><th class=\"cl-b9f8c560\"><p class=\"cl-b9f8a63e\"><span class=\"cl-b9f3d99c\">surface_temperature_c</span></p></th><th class=\"cl-b9f8c560\"><p class=\"cl-b9f8a63e\"><span class=\"cl-b9f3d99c\">depth_m</span></p></th><th class=\"cl-b9f8c560\"><p class=\"cl-b9f8a63e\"><span class=\"cl-b9f3d99c\">distance_fished_km</span></p></th><th class=\"cl-b9f8c560\"><p class=\"cl-b9f8a63e\"><span class=\"cl-b9f3d99c\">duration_hr</span></p></th><th class=\"cl-b9f8c560\"><p class=\"cl-b9f8a63e\"><span class=\"cl-b9f3d99c\">net_width_m</span></p></th><th class=\"cl-b9f8c560\"><p class=\"cl-b9f8a63e\"><span class=\"cl-b9f3d99c\">net_height_m</span></p></th><th class=\"cl-b9f8c560\"><p class=\"cl-b9f8a63e\"><span class=\"cl-b9f3d99c\">area_swept_km2</span></p></th><th class=\"cl-b9f8c560\"><p class=\"cl-b9f8a63e\"><span class=\"cl-b9f3d99c\">performance</span></p></th><th class=\"cl-b9f8c560\"><p class=\"cl-b9f8a63e\"><span class=\"cl-b9f3d99c\">cpue_kgkm2</span></p></th><th class=\"cl-b9f8c560\"><p class=\"cl-b9f8a63e\"><span class=\"cl-b9f3d99c\">cpue_nokm2</span></p></th><th class=\"cl-b9f8c560\"><p class=\"cl-b9f8a63e\"><span class=\"cl-b9f3d99c\">count</span></p></th><th class=\"cl-b9f8c560\"><p class=\"cl-b9f8a63e\"><span class=\"cl-b9f3d99c\">weight_kg</span></p></th><th class=\"cl-b9f8c561\"><p class=\"cl-b9f8a648\"><span class=\"cl-b9f3d99c\">taxon_confidence</span></p></th></tr></thead><tbody><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-b9f8c56a\"><p class=\"cl-b9f8a63e\"><span class=\"cl-b9f3d9b0\">21,740</span></p></td><td class=\"cl-b9f8c56a\"><p class=\"cl-b9f8a63e\"><span class=\"cl-b9f3d9b0\">-22,490</span></p></td><td class=\"cl-b9f8c574\"><p class=\"cl-b9f8a648\"><span class=\"cl-b9f3d9b0\">Gadus chalcogrammus</span></p></td><td class=\"cl-b9f8c574\"><p class=\"cl-b9f8a648\"><span class=\"cl-b9f3d9b0\">walleye pollock</span></p></td><td class=\"cl-b9f8c574\"><p class=\"cl-b9f8a648\"><span class=\"cl-b9f3d9b0\">species</span></p></td><td class=\"cl-b9f8c56a\"><p class=\"cl-b9f8a63e\"><span class=\"cl-b9f3d9b0\">300,735</span></p></td><td class=\"cl-b9f8c56a\"><p class=\"cl-b9f8a63e\"><span class=\"cl-b9f3d9b0\">934,083</span></p></td><td class=\"cl-b9f8c56a\"><p class=\"cl-b9f8a63e\"><span class=\"cl-b9f3d9b0\">2,023</span></p></td><td class=\"cl-b9f8c574\"><p class=\"cl-b9f8a648\"><span class=\"cl-b9f3d9b0\">EBS</span></p></td><td class=\"cl-b9f8c574\"><p class=\"cl-b9f8a648\"><span class=\"cl-b9f3d9b0\">eastern Bering Sea</span></p></td><td class=\"cl-b9f8c574\"><p class=\"cl-b9f8a648\"><span class=\"cl-b9f3d9b0\">Eastern Bering Sea Crab/Groundfish Bottom Trawl Survey</span></p></td><td class=\"cl-b9f8c56a\"><p class=\"cl-b9f8a63e\"><span class=\"cl-b9f3d9b0\">98</span></p></td><td class=\"cl-b9f8c56a\"><p class=\"cl-b9f8a63e\"><span class=\"cl-b9f3d9b0\">202,301</span></p></td><td class=\"cl-b9f8c56a\"><p class=\"cl-b9f8a63e\"><span class=\"cl-b9f3d9b0\">-759</span></p></td><td class=\"cl-b9f8c56a\"><p class=\"cl-b9f8a63e\"><span class=\"cl-b9f3d9b0\">109</span></p></td><td class=\"cl-b9f8c56a\"><p class=\"cl-b9f8a63e\"><span class=\"cl-b9f3d9b0\">32</span></p></td><td class=\"cl-b9f8c574\"><p class=\"cl-b9f8a648\"><span class=\"cl-b9f3d9b0\">G-18</span></p></td><td class=\"cl-b9f8c56a\"><p class=\"cl-b9f8a63e\"><span class=\"cl-b9f3d9b0\">162</span></p></td><td class=\"cl-b9f8c574\"><p class=\"cl-b9f8a648\"><span class=\"cl-b9f3d9b0\">ALASKA KNIGHT</span></p></td><td class=\"cl-b9f8c574\"><p class=\"cl-b9f8a648\"><span class=\"cl-b9f3d9b0\">2023-06-21T12:51:22Z</span></p></td><td class=\"cl-b9f8c56a\"><p class=\"cl-b9f8a63e\"><span class=\"cl-b9f3d9b0\">56.99438</span></p></td><td class=\"cl-b9f8c56a\"><p class=\"cl-b9f8a63e\"><span class=\"cl-b9f3d9b0\">-168.3313</span></p></td><td class=\"cl-b9f8c56a\"><p class=\"cl-b9f8a63e\"><span class=\"cl-b9f3d9b0\">57.01985</span></p></td><td class=\"cl-b9f8c56a\"><p class=\"cl-b9f8a63e\"><span class=\"cl-b9f3d9b0\">-168.3298</span></p></td><td class=\"cl-b9f8c56a\"><p class=\"cl-b9f8a63e\"><span class=\"cl-b9f3d9b0\">3.5</span></p></td><td class=\"cl-b9f8c56a\"><p class=\"cl-b9f8a63e\"><span class=\"cl-b9f3d9b0\">7.4</span></p></td><td class=\"cl-b9f8c56a\"><p class=\"cl-b9f8a63e\"><span class=\"cl-b9f3d9b0\">81</span></p></td><td class=\"cl-b9f8c56a\"><p class=\"cl-b9f8a63e\"><span class=\"cl-b9f3d9b0\">2.832</span></p></td><td class=\"cl-b9f8c56a\"><p class=\"cl-b9f8a63e\"><span class=\"cl-b9f3d9b0\">0.518</span></p></td><td class=\"cl-b9f8c56a\"><p class=\"cl-b9f8a63e\"><span class=\"cl-b9f3d9b0\">17.410</span></p></td><td class=\"cl-b9f8c56a\"><p class=\"cl-b9f8a63e\"><span class=\"cl-b9f3d9b0\">1.718</span></p></td><td class=\"cl-b9f8c56a\"><p class=\"cl-b9f8a63e\"><span class=\"cl-b9f3d9b0\">0.049305</span></p></td><td class=\"cl-b9f8c56a\"><p class=\"cl-b9f8a63e\"><span class=\"cl-b9f3d9b0\">0</span></p></td><td class=\"cl-b9f8c56a\"><p class=\"cl-b9f8a63e\"><span class=\"cl-b9f3d9b0\">3,484.7902</span></p></td><td class=\"cl-b9f8c56a\"><p class=\"cl-b9f8a63e\"><span class=\"cl-b9f3d9b0\">5,983.151</span></p></td><td class=\"cl-b9f8c56a\"><p class=\"cl-b9f8a63e\"><span class=\"cl-b9f3d9b0\">295</span></p></td><td class=\"cl-b9f8c56a\"><p class=\"cl-b9f8a63e\"><span class=\"cl-b9f3d9b0\">171.818</span></p></td><td class=\"cl-b9f8c574\"><p class=\"cl-b9f8a648\"><span class=\"cl-b9f3d9b0\"></span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-b9f8c575\"><p class=\"cl-b9f8a63e\"><span class=\"cl-b9f3d9b0\">21,740</span></p></td><td class=\"cl-b9f8c575\"><p class=\"cl-b9f8a63e\"><span class=\"cl-b9f3d9b0\">-21,735</span></p></td><td class=\"cl-b9f8c57e\"><p class=\"cl-b9f8a648\"><span class=\"cl-b9f3d9b0\">Gadus chalcogrammus</span></p></td><td class=\"cl-b9f8c57e\"><p class=\"cl-b9f8a648\"><span class=\"cl-b9f3d9b0\">walleye pollock</span></p></td><td class=\"cl-b9f8c57e\"><p class=\"cl-b9f8a648\"><span class=\"cl-b9f3d9b0\">species</span></p></td><td class=\"cl-b9f8c575\"><p class=\"cl-b9f8a63e\"><span class=\"cl-b9f3d9b0\">300,735</span></p></td><td class=\"cl-b9f8c575\"><p class=\"cl-b9f8a63e\"><span class=\"cl-b9f3d9b0\">934,083</span></p></td><td class=\"cl-b9f8c575\"><p class=\"cl-b9f8a63e\"><span class=\"cl-b9f3d9b0\">2,022</span></p></td><td class=\"cl-b9f8c57e\"><p class=\"cl-b9f8a648\"><span class=\"cl-b9f3d9b0\">EBS</span></p></td><td class=\"cl-b9f8c57e\"><p class=\"cl-b9f8a648\"><span class=\"cl-b9f3d9b0\">eastern Bering Sea</span></p></td><td class=\"cl-b9f8c57e\"><p class=\"cl-b9f8a648\"><span class=\"cl-b9f3d9b0\">Eastern Bering Sea Crab/Groundfish Bottom Trawl Survey</span></p></td><td class=\"cl-b9f8c575\"><p class=\"cl-b9f8a63e\"><span class=\"cl-b9f3d9b0\">98</span></p></td><td class=\"cl-b9f8c575\"><p class=\"cl-b9f8a63e\"><span class=\"cl-b9f3d9b0\">202,201</span></p></td><td class=\"cl-b9f8c575\"><p class=\"cl-b9f8a63e\"><span class=\"cl-b9f3d9b0\">-755</span></p></td><td class=\"cl-b9f8c575\"><p class=\"cl-b9f8a63e\"><span class=\"cl-b9f3d9b0\">186</span></p></td><td class=\"cl-b9f8c575\"><p class=\"cl-b9f8a63e\"><span class=\"cl-b9f3d9b0\">90</span></p></td><td class=\"cl-b9f8c57e\"><p class=\"cl-b9f8a648\"><span class=\"cl-b9f3d9b0\">S-28</span></p></td><td class=\"cl-b9f8c575\"><p class=\"cl-b9f8a63e\"><span class=\"cl-b9f3d9b0\">94</span></p></td><td class=\"cl-b9f8c57e\"><p class=\"cl-b9f8a648\"><span class=\"cl-b9f3d9b0\">VESTERAALEN</span></p></td><td class=\"cl-b9f8c57e\"><p class=\"cl-b9f8a648\"><span class=\"cl-b9f3d9b0\">2022-07-26T10:57:25Z</span></p></td><td class=\"cl-b9f8c575\"><p class=\"cl-b9f8a63e\"><span class=\"cl-b9f3d9b0\">61.02685</span></p></td><td class=\"cl-b9f8c575\"><p class=\"cl-b9f8a63e\"><span class=\"cl-b9f3d9b0\">-175.5337</span></p></td><td class=\"cl-b9f8c575\"><p class=\"cl-b9f8a63e\"><span class=\"cl-b9f3d9b0\">61.00428</span></p></td><td class=\"cl-b9f8c575\"><p class=\"cl-b9f8a63e\"><span class=\"cl-b9f3d9b0\">-175.5545</span></p></td><td class=\"cl-b9f8c575\"><p class=\"cl-b9f8a63e\"><span class=\"cl-b9f3d9b0\">0.6</span></p></td><td class=\"cl-b9f8c575\"><p class=\"cl-b9f8a63e\"><span class=\"cl-b9f3d9b0\">8.2</span></p></td><td class=\"cl-b9f8c575\"><p class=\"cl-b9f8a63e\"><span class=\"cl-b9f3d9b0\">100</span></p></td><td class=\"cl-b9f8c575\"><p class=\"cl-b9f8a63e\"><span class=\"cl-b9f3d9b0\">2.752</span></p></td><td class=\"cl-b9f8c575\"><p class=\"cl-b9f8a63e\"><span class=\"cl-b9f3d9b0\">0.531</span></p></td><td class=\"cl-b9f8c575\"><p class=\"cl-b9f8a63e\"><span class=\"cl-b9f3d9b0\">18.523</span></p></td><td class=\"cl-b9f8c575\"><p class=\"cl-b9f8a63e\"><span class=\"cl-b9f3d9b0\">1.479</span></p></td><td class=\"cl-b9f8c575\"><p class=\"cl-b9f8a63e\"><span class=\"cl-b9f3d9b0\">0.050975</span></p></td><td class=\"cl-b9f8c575\"><p class=\"cl-b9f8a63e\"><span class=\"cl-b9f3d9b0\">0</span></p></td><td class=\"cl-b9f8c575\"><p class=\"cl-b9f8a63e\"><span class=\"cl-b9f3d9b0\">7,290.7669</span></p></td><td class=\"cl-b9f8c575\"><p class=\"cl-b9f8a63e\"><span class=\"cl-b9f3d9b0\">23,835.075</span></p></td><td class=\"cl-b9f8c575\"><p class=\"cl-b9f8a63e\"><span class=\"cl-b9f3d9b0\">1,215</span></p></td><td class=\"cl-b9f8c575\"><p class=\"cl-b9f8a63e\"><span class=\"cl-b9f3d9b0\">371.649</span></p></td><td class=\"cl-b9f8c57e\"><p class=\"cl-b9f8a648\"><span class=\"cl-b9f3d9b0\">1</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-b9f8c56a\"><p class=\"cl-b9f8a63e\"><span class=\"cl-b9f3d9b0\">21,740</span></p></td><td class=\"cl-b9f8c56a\"><p class=\"cl-b9f8a63e\"><span class=\"cl-b9f3d9b0\">-21,626</span></p></td><td class=\"cl-b9f8c574\"><p class=\"cl-b9f8a648\"><span class=\"cl-b9f3d9b0\">Gadus chalcogrammus</span></p></td><td class=\"cl-b9f8c574\"><p class=\"cl-b9f8a648\"><span class=\"cl-b9f3d9b0\">walleye pollock</span></p></td><td class=\"cl-b9f8c574\"><p class=\"cl-b9f8a648\"><span class=\"cl-b9f3d9b0\">species</span></p></td><td class=\"cl-b9f8c56a\"><p class=\"cl-b9f8a63e\"><span class=\"cl-b9f3d9b0\">300,735</span></p></td><td class=\"cl-b9f8c56a\"><p class=\"cl-b9f8a63e\"><span class=\"cl-b9f3d9b0\">934,083</span></p></td><td class=\"cl-b9f8c56a\"><p class=\"cl-b9f8a63e\"><span class=\"cl-b9f3d9b0\">2,022</span></p></td><td class=\"cl-b9f8c574\"><p class=\"cl-b9f8a648\"><span class=\"cl-b9f3d9b0\">EBS</span></p></td><td class=\"cl-b9f8c574\"><p class=\"cl-b9f8a648\"><span class=\"cl-b9f3d9b0\">eastern Bering Sea</span></p></td><td class=\"cl-b9f8c574\"><p class=\"cl-b9f8a648\"><span class=\"cl-b9f3d9b0\">Eastern Bering Sea Crab/Groundfish Bottom Trawl Survey</span></p></td><td class=\"cl-b9f8c56a\"><p class=\"cl-b9f8a63e\"><span class=\"cl-b9f3d9b0\">98</span></p></td><td class=\"cl-b9f8c56a\"><p class=\"cl-b9f8a63e\"><span class=\"cl-b9f3d9b0\">202,201</span></p></td><td class=\"cl-b9f8c56a\"><p class=\"cl-b9f8a63e\"><span class=\"cl-b9f3d9b0\">-756</span></p></td><td class=\"cl-b9f8c56a\"><p class=\"cl-b9f8a63e\"><span class=\"cl-b9f3d9b0\">155</span></p></td><td class=\"cl-b9f8c56a\"><p class=\"cl-b9f8a63e\"><span class=\"cl-b9f3d9b0\">43</span></p></td><td class=\"cl-b9f8c574\"><p class=\"cl-b9f8a648\"><span class=\"cl-b9f3d9b0\">Q-25</span></p></td><td class=\"cl-b9f8c56a\"><p class=\"cl-b9f8a63e\"><span class=\"cl-b9f3d9b0\">162</span></p></td><td class=\"cl-b9f8c574\"><p class=\"cl-b9f8a648\"><span class=\"cl-b9f3d9b0\">ALASKA KNIGHT</span></p></td><td class=\"cl-b9f8c574\"><p class=\"cl-b9f8a648\"><span class=\"cl-b9f3d9b0\">2022-07-17T16:00:43Z</span></p></td><td class=\"cl-b9f8c56a\"><p class=\"cl-b9f8a63e\"><span class=\"cl-b9f3d9b0\">60.30844</span></p></td><td class=\"cl-b9f8c56a\"><p class=\"cl-b9f8a63e\"><span class=\"cl-b9f3d9b0\">-173.3738</span></p></td><td class=\"cl-b9f8c56a\"><p class=\"cl-b9f8a63e\"><span class=\"cl-b9f3d9b0\">60.29943</span></p></td><td class=\"cl-b9f8c56a\"><p class=\"cl-b9f8a63e\"><span class=\"cl-b9f3d9b0\">-173.3667</span></p></td><td class=\"cl-b9f8c56a\"><p class=\"cl-b9f8a63e\"><span class=\"cl-b9f3d9b0\">2.4</span></p></td><td class=\"cl-b9f8c56a\"><p class=\"cl-b9f8a63e\"><span class=\"cl-b9f3d9b0\">8.1</span></p></td><td class=\"cl-b9f8c56a\"><p class=\"cl-b9f8a63e\"><span class=\"cl-b9f3d9b0\">63</span></p></td><td class=\"cl-b9f8c56a\"><p class=\"cl-b9f8a63e\"><span class=\"cl-b9f3d9b0\">1.078</span></p></td><td class=\"cl-b9f8c56a\"><p class=\"cl-b9f8a63e\"><span class=\"cl-b9f3d9b0\">0.189</span></p></td><td class=\"cl-b9f8c56a\"><p class=\"cl-b9f8a63e\"><span class=\"cl-b9f3d9b0\">17.600</span></p></td><td class=\"cl-b9f8c56a\"><p class=\"cl-b9f8a63e\"><span class=\"cl-b9f3d9b0\">1.884</span></p></td><td class=\"cl-b9f8c56a\"><p class=\"cl-b9f8a63e\"><span class=\"cl-b9f3d9b0\">0.018973</span></p></td><td class=\"cl-b9f8c56a\"><p class=\"cl-b9f8a63e\"><span class=\"cl-b9f3d9b0\">0</span></p></td><td class=\"cl-b9f8c56a\"><p class=\"cl-b9f8a63e\"><span class=\"cl-b9f3d9b0\">528.6515</span></p></td><td class=\"cl-b9f8c56a\"><p class=\"cl-b9f8a63e\"><span class=\"cl-b9f3d9b0\">1,370.383</span></p></td><td class=\"cl-b9f8c56a\"><p class=\"cl-b9f8a63e\"><span class=\"cl-b9f3d9b0\">26</span></p></td><td class=\"cl-b9f8c56a\"><p class=\"cl-b9f8a63e\"><span class=\"cl-b9f3d9b0\">10.030</span></p></td><td class=\"cl-b9f8c574\"><p class=\"cl-b9f8a648\"><span class=\"cl-b9f3d9b0\">1</span></p></td></tr></tbody></table></div>\n```\n:::\n:::\n\n\n### Plot locations\n\n\n::: {.cell tbl-cap='CPUE (kg/km^2) of walleye pollock catch at each station in the 2023 eastern Bering Sea bottom trawl survey. Red triangles denote stations where walleye pollock were not caught. '}\n\n```{.r .cell-code}\nlibrary(ggplot2)\n\nggplot2::ggplot(data = dat0 %>% dplyr::filter(cpue_kgkm2 != 0), \n                mapping = aes(x = longitude_dd_start, \n                              y = latitude_dd_start, \n                              size = cpue_kgkm2)) + \n  ggplot2::geom_point(alpha = .75) +\n  ggplot2::geom_point(data = dat0 %>% dplyr::filter(cpue_kgkm2 == 0), \n                      color = \"red\", \n                      shape = 17,\n                      alpha = .75,\n                      size = 3) +\n  ggplot2::xlab(\"Longitude *W\") +\n  ggplot2::ylab(\"Latitude *N\") +\n  ggplot2::ggtitle(label = \"Catches of walleye pollock (Weight CPUE; kg/km2)\", \n                   subtitle = \"Eastern Bering Sea bottom trawl survey\") +\n  ggplot2::scale_size_continuous(name = \"Weight (kg)\") + \n  ggplot2::facet_wrap(facets = vars(year)) + \n  ggplot2::theme_bw()\n```\n\n::: {.cell-output-display}\n![](foss-api-r_files/figure-html/pollock-multi-loc-1.png){width=672}\n:::\n:::\n\n\n### Plot inverse-distance weighted modeled product of locations\n\nThis map is constructed using [`akgfmaps`](https://github.com/afsc-gap-products/akgfmaps). To make IDW plots, you must have data from all stations surveyed, even if no fish of interest were found there. \n\n\n::: {.cell tbl-cap='CPUE of walleye pollock catch at each station in the 2023 eastern Bering Sea bottom trawl survey. '}\n\n```{.r .cell-code}\nidw <- akgfmaps::make_idw_stack(\n  x = dat0 %>% \n    dplyr::select(COMMON_NAME = common_name, \n                  CPUE_KGHA = cpue_kgkm2, \n                  LATITUDE = latitude_dd_start, \n                  LONGITUDE = longitude_dd_start, \n                  year), \n  grouping.vars = \"year\", \n  region = \"bs.all\", # Predefined EBS area\n  set.breaks = \"jenks\", # Gets Jenks breaks from classint::classIntervals()\n  in.crs = \"+proj=longlat\", # Set input coordinate reference system\n  out.crs = \"EPSG:3338\", # Set output coordinate reference system\n  extrapolation.grid.type = \"sf\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[inverse distance weighted interpolation]\n[inverse distance weighted interpolation]\n[inverse distance weighted interpolation]\n[inverse distance weighted interpolation]\n[inverse distance weighted interpolation]\n[inverse distance weighted interpolation]\n[inverse distance weighted interpolation]\n[inverse distance weighted interpolation]\n```\n:::\n\n```{.r .cell-code}\nshps <- akgfmaps::get_base_layers(\n  select.region = \"bs.all\", \n  include.corners = TRUE, \n  set.crs = \"EPSG:3338\")\n\n# set.breaks <- akgfmaps::eval_plot_breaks(CPUE = dat0$cpue_kgkm2, n.breaks = 5)\n# set.breaks <- as.vector(unlist(set.breaks[set.breaks$style == \"pretty\", -1]))\nset.breaks <- c(0, 50000, 100000, 150000, 200000, 250000)\n\nfigure_print <- ggplot() +\n  # add map of alaska\n  ggplot2::geom_sf(data = shps$akland,\n                   color = NA,\n                   fill = \"grey50\") +\n  # add IDW plots\n  geom_sf(data = idw$extrapolation.stack,\n          mapping = aes(fill = var1.pred),\n          na.rm = FALSE,\n          show.legend = TRUE, \n          color = NA) +\n  ggplot2::scale_fill_manual(\n    name = \"walleye pollock\\nCPUE (kg/km2)\",\n    values =  c(\"gray90\",\n                viridis::viridis(\n                  option = \"mako\",\n                  direction = -1,\n                  n = length(set.breaks)-1,\n                  begin = 0.20,\n                  end = 0.80)),\n    na.translate = FALSE, # Don't use NA\n    drop = FALSE) + \n  # seperate plots by year\n  ggplot2::facet_wrap(facets = vars(year), nrow = 2) + \n  # add survey area\n  ggplot2::geom_sf(\n    data = shps$survey.area, \n    mapping = aes(color = SURVEY, \n                  geometry = geometry), \n    fill = \"transparent\", \n    linewidth = 1, \n    show.legend = FALSE) +\n  ggplot2::scale_color_manual(\n    name = \" \", \n    values = c(\"grey30\", \"grey50\"),\n    breaks = shps$survey.area$SURVEY,\n    labels = shps$survey.area$SRVY) + \n  # lat/lon axis and map bounds\n  ggplot2::scale_x_continuous(name = \"Longitude W\",\n                              breaks = seq(-180, -150, 5)) +\n  ggplot2::scale_y_continuous(name = \"Latitude N\",\n                              breaks = seq(50, 65, 5)) + # seq(52, 62, 2)\n  ggplot2::coord_sf(xlim = sf::st_bbox(shps$survey.area)[c(1,3)],\n                    ylim = sf::st_bbox(shps$survey.area)[c(2,4)]) +\n  # add theme aesthetics\n  ggplot2::guides(\n    fill = guide_legend(\n      order = 1,\n      title.position = \"top\",\n      label.position = \"bottom\",\n      title.hjust = 0.5,\n      override.aes = list(color = NA),\n      nrow = 1),\n    color = \"none\") +\n  ggplot2::theme( \n    panel.background = element_rect(fill = \"white\", colour = NA), \n    panel.border = element_rect(fill = NA, colour = \"grey20\"), \n    strip.background = element_blank(), \n    strip.text = element_text(size = 10, face = \"bold\"), \n    legend.text = element_text(size = 9),\n    legend.background = element_rect(colour = \"transparent\", \n                                     fill = \"transparent\"),\n    legend.key = element_rect(colour = \"transparent\", \n                              fill = \"transparent\"),\n    legend.position = \"bottom\", \n    legend.box = \"horizontal\",\n    legend.box.spacing = unit(0, \"pt\"), # reduce space between legend & plot\n    legend.margin=margin(0, 0, 0, 0) )\n\nfigure_print\n```\n\n::: {.cell-output-display}\n![](foss-api-r_files/figure-html/pollock-multi-idw-1.png){width=576}\n:::\n:::\n\n\n# Examples or one species in one survey region in one year\n\n## Ex. Show catch data for 2023 eastern Bering Sea Walleye Pollock\n\nData downloads and joins for just one species, survey, and year are much faster and easier to do. \n\nFirst, because `year` is identified in the haul table, we need to identify all of the hauls (or more specifically, `hauljoin` codes) that were completed in the eastern Bering Sea (`\"srvy\":\"EBS\"`) in 2023 (`\"year\":2023`). \n\n\n::: {.cell}\n\n```{.r .cell-code}\n## query the API link\nres <- httr::GET(url = paste0(api_link_haul, '?limit=10000&q={\"year\":2023,\"srvy\":\"EBS\"}'))\n\n## convert from JSON format\ndata <- jsonlite::fromJSON(base::rawToChar(res$content)) \ndat <- data$items %>%\n  dplyr::select(-links) # necessary for API accounting, but not part of the dataset\n\n## show summary of data to make sure it is subset correctly\nsummary(dat %>% dplyr::mutate(srvy = as.factor(srvy)))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n      year       srvy        survey          survey_name       \n Min.   :2023   EBS:376   Length:376         Length:376        \n 1st Qu.:2023             Class :character   Class :character  \n Median :2023             Mode  :character   Mode  :character  \n Mean   :2023                                                  \n 3rd Qu.:2023                                                  \n Max.   :2023                                                  \n survey_definition_id     cruise         cruisejoin        hauljoin     \n Min.   :98           Min.   :202301   Min.   :-760.0   Min.   :-23019  \n 1st Qu.:98           1st Qu.:202301   1st Qu.:-760.0   1st Qu.:-22776  \n Median :98           Median :202301   Median :-759.0   Median :-22539  \n Mean   :98           Mean   :202301   Mean   :-759.5   Mean   :-22552  \n 3rd Qu.:98           3rd Qu.:202301   3rd Qu.:-759.0   3rd Qu.:-22333  \n Max.   :98           Max.   :202301   Max.   :-759.0   Max.   :-22110  \n      haul           stratum        station            vessel_id    \n Min.   :  7.00   Min.   :10.00   Length:376         Min.   :134.0  \n 1st Qu.: 65.75   1st Qu.:31.00   Class :character   1st Qu.:134.0  \n Median :114.00   Median :41.00   Mode  :character   Median :162.0  \n Mean   :114.16   Mean   :39.22                      Mean   :148.3  \n 3rd Qu.:161.25   3rd Qu.:50.00                      3rd Qu.:162.0  \n Max.   :224.00   Max.   :90.00                      Max.   :162.0  \n vessel_name         date_time         latitude_dd_start longitude_dd_start\n Length:376         Length:376         Min.   :54.66     Min.   :-178.2    \n Class :character   Class :character   1st Qu.:57.00     1st Qu.:-172.7    \n Mode  :character   Mode  :character   Median :58.02     Median :-168.9    \n                                       Mean   :58.26     Mean   :-168.8    \n                                       3rd Qu.:59.50     3rd Qu.:-165.2    \n                                       Max.   :62.01     Max.   :-158.3    \n latitude_dd_end longitude_dd_end bottom_temperature_c surface_temperature_c\n Min.   :54.68   Min.   :-178.2   Min.   :-1.600       Min.   : 1.700       \n 1st Qu.:57.01   1st Qu.:-172.7   1st Qu.: 1.200       1st Qu.: 4.200       \n Median :58.02   Median :-168.9   Median : 2.700       Median : 6.550       \n Mean   :58.26   Mean   :-168.8   Mean   : 2.249       Mean   : 6.386       \n 3rd Qu.:59.50   3rd Qu.:-165.2   3rd Qu.: 3.500       3rd Qu.: 8.525       \n Max.   :62.01   Max.   :-158.3   Max.   : 5.400       Max.   :11.000       \n    depth_m       distance_fished_km  duration_hr      net_width_m   \n Min.   : 20.00   Min.   :1.065      Min.   :0.1890   Min.   :12.90  \n 1st Qu.: 54.75   1st Qu.:2.805      1st Qu.:0.5100   1st Qu.:16.66  \n Median : 74.00   Median :2.889      Median :0.5180   Median :17.27  \n Mean   : 80.75   Mean   :2.854      Mean   :0.5129   Mean   :17.15  \n 3rd Qu.:105.00   3rd Qu.:2.945      3rd Qu.:0.5260   3rd Qu.:17.83  \n Max.   :171.00   Max.   :3.849      Max.   :0.6560   Max.   :20.29  \n  net_height_m   area_swept_km2     performance    \n Min.   :1.300   Min.   :0.02017   Min.   :0.0000  \n 1st Qu.:1.875   1st Qu.:0.04725   1st Qu.:0.0000  \n Median :2.064   Median :0.04944   Median :0.0000  \n Mean   :2.107   Mean   :0.04892   Mean   :0.1075  \n 3rd Qu.:2.343   3rd Qu.:0.05134   3rd Qu.:0.0000  \n Max.   :3.196   Max.   :0.06369   Max.   :6.2200  \n```\n:::\n\n```{.r .cell-code}\n## Find how many rows and columns are in the data pull. \n## The eastern Bering Sea survey has 376 stations in it, \n## so this should have a similar number of rows. \nprint(paste0(\"rows: \", dim(dat)[1], \"; cols: \", dim(dat)[2]))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"rows: 376; cols: 27\"\n```\n:::\n\n```{.r .cell-code}\n# save outputs for later comparison\ndat_haul_ex <- dat\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Print the first few lines of the data \nhead(dat_haul_ex, 3)\n```\n:::\n\n::: {.cell tbl-cap='Haul data filtered by `year = 2023` and `SRVY = \\'EBS\\'`. '}\n::: {.cell-output-display}\n```{=html}\n<div class=\"tabwid\"><style>.cl-e4028986{}.cl-e3f498a8{font-family:'Arial';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-e3f498bc{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-e3f97b16{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-e3f97b2a{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-e3f9a32a{width:0.75in;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e3f9a334{width:0.75in;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e3f9a335{width:0.75in;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e3f9a33e{width:0.75in;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e3f9a33f{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e3f9a348{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-e4028986'><thead><tr style=\"overflow-wrap:break-word;\"><th class=\"cl-e3f9a32a\"><p class=\"cl-e3f97b16\"><span class=\"cl-e3f498a8\">year</span></p></th><th class=\"cl-e3f9a334\"><p class=\"cl-e3f97b2a\"><span class=\"cl-e3f498a8\">srvy</span></p></th><th class=\"cl-e3f9a334\"><p class=\"cl-e3f97b2a\"><span class=\"cl-e3f498a8\">survey</span></p></th><th class=\"cl-e3f9a334\"><p class=\"cl-e3f97b2a\"><span class=\"cl-e3f498a8\">survey_name</span></p></th><th class=\"cl-e3f9a32a\"><p class=\"cl-e3f97b16\"><span class=\"cl-e3f498a8\">survey_definition_id</span></p></th><th class=\"cl-e3f9a32a\"><p class=\"cl-e3f97b16\"><span class=\"cl-e3f498a8\">cruise</span></p></th><th class=\"cl-e3f9a32a\"><p class=\"cl-e3f97b16\"><span class=\"cl-e3f498a8\">cruisejoin</span></p></th><th class=\"cl-e3f9a32a\"><p class=\"cl-e3f97b16\"><span class=\"cl-e3f498a8\">hauljoin</span></p></th><th class=\"cl-e3f9a32a\"><p class=\"cl-e3f97b16\"><span class=\"cl-e3f498a8\">haul</span></p></th><th class=\"cl-e3f9a32a\"><p class=\"cl-e3f97b16\"><span class=\"cl-e3f498a8\">stratum</span></p></th><th class=\"cl-e3f9a334\"><p class=\"cl-e3f97b2a\"><span class=\"cl-e3f498a8\">station</span></p></th><th class=\"cl-e3f9a32a\"><p class=\"cl-e3f97b16\"><span class=\"cl-e3f498a8\">vessel_id</span></p></th><th class=\"cl-e3f9a334\"><p class=\"cl-e3f97b2a\"><span class=\"cl-e3f498a8\">vessel_name</span></p></th><th class=\"cl-e3f9a334\"><p class=\"cl-e3f97b2a\"><span class=\"cl-e3f498a8\">date_time</span></p></th><th class=\"cl-e3f9a32a\"><p class=\"cl-e3f97b16\"><span class=\"cl-e3f498a8\">latitude_dd_start</span></p></th><th class=\"cl-e3f9a32a\"><p class=\"cl-e3f97b16\"><span class=\"cl-e3f498a8\">longitude_dd_start</span></p></th><th class=\"cl-e3f9a32a\"><p class=\"cl-e3f97b16\"><span class=\"cl-e3f498a8\">latitude_dd_end</span></p></th><th class=\"cl-e3f9a32a\"><p class=\"cl-e3f97b16\"><span class=\"cl-e3f498a8\">longitude_dd_end</span></p></th><th class=\"cl-e3f9a32a\"><p class=\"cl-e3f97b16\"><span class=\"cl-e3f498a8\">bottom_temperature_c</span></p></th><th class=\"cl-e3f9a32a\"><p class=\"cl-e3f97b16\"><span class=\"cl-e3f498a8\">surface_temperature_c</span></p></th><th class=\"cl-e3f9a32a\"><p class=\"cl-e3f97b16\"><span class=\"cl-e3f498a8\">depth_m</span></p></th><th class=\"cl-e3f9a32a\"><p class=\"cl-e3f97b16\"><span class=\"cl-e3f498a8\">distance_fished_km</span></p></th><th class=\"cl-e3f9a32a\"><p class=\"cl-e3f97b16\"><span class=\"cl-e3f498a8\">duration_hr</span></p></th><th class=\"cl-e3f9a32a\"><p class=\"cl-e3f97b16\"><span class=\"cl-e3f498a8\">net_width_m</span></p></th><th class=\"cl-e3f9a32a\"><p class=\"cl-e3f97b16\"><span class=\"cl-e3f498a8\">net_height_m</span></p></th><th class=\"cl-e3f9a32a\"><p class=\"cl-e3f97b16\"><span class=\"cl-e3f498a8\">area_swept_km2</span></p></th><th class=\"cl-e3f9a32a\"><p class=\"cl-e3f97b16\"><span class=\"cl-e3f498a8\">performance</span></p></th></tr></thead><tbody><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-e3f9a335\"><p class=\"cl-e3f97b16\"><span class=\"cl-e3f498bc\">2023</span></p></td><td class=\"cl-e3f9a33e\"><p class=\"cl-e3f97b2a\"><span class=\"cl-e3f498bc\">EBS</span></p></td><td class=\"cl-e3f9a33e\"><p class=\"cl-e3f97b2a\"><span class=\"cl-e3f498bc\">eastern Bering Sea</span></p></td><td class=\"cl-e3f9a33e\"><p class=\"cl-e3f97b2a\"><span class=\"cl-e3f498bc\">Eastern Bering Sea Crab/Groundfish Bottom Trawl Survey</span></p></td><td class=\"cl-e3f9a335\"><p class=\"cl-e3f97b16\"><span class=\"cl-e3f498bc\">98</span></p></td><td class=\"cl-e3f9a335\"><p class=\"cl-e3f97b16\"><span class=\"cl-e3f498bc\">202301</span></p></td><td class=\"cl-e3f9a335\"><p class=\"cl-e3f97b16\"><span class=\"cl-e3f498bc\">-759</span></p></td><td class=\"cl-e3f9a335\"><p class=\"cl-e3f97b16\"><span class=\"cl-e3f498bc\">-22,490</span></p></td><td class=\"cl-e3f9a335\"><p class=\"cl-e3f97b16\"><span class=\"cl-e3f498bc\">109</span></p></td><td class=\"cl-e3f9a335\"><p class=\"cl-e3f97b16\"><span class=\"cl-e3f498bc\">32</span></p></td><td class=\"cl-e3f9a33e\"><p class=\"cl-e3f97b2a\"><span class=\"cl-e3f498bc\">G-18</span></p></td><td class=\"cl-e3f9a335\"><p class=\"cl-e3f97b16\"><span class=\"cl-e3f498bc\">162</span></p></td><td class=\"cl-e3f9a33e\"><p class=\"cl-e3f97b2a\"><span class=\"cl-e3f498bc\">ALASKA KNIGHT</span></p></td><td class=\"cl-e3f9a33e\"><p class=\"cl-e3f97b2a\"><span class=\"cl-e3f498bc\">2023-06-21T12:51:22Z</span></p></td><td class=\"cl-e3f9a335\"><p class=\"cl-e3f97b16\"><span class=\"cl-e3f498bc\">56.99438</span></p></td><td class=\"cl-e3f9a335\"><p class=\"cl-e3f97b16\"><span class=\"cl-e3f498bc\">-168.3313</span></p></td><td class=\"cl-e3f9a335\"><p class=\"cl-e3f97b16\"><span class=\"cl-e3f498bc\">57.01985</span></p></td><td class=\"cl-e3f9a335\"><p class=\"cl-e3f97b16\"><span class=\"cl-e3f498bc\">-168.3298</span></p></td><td class=\"cl-e3f9a335\"><p class=\"cl-e3f97b16\"><span class=\"cl-e3f498bc\">3.5</span></p></td><td class=\"cl-e3f9a335\"><p class=\"cl-e3f97b16\"><span class=\"cl-e3f498bc\">7.4</span></p></td><td class=\"cl-e3f9a335\"><p class=\"cl-e3f97b16\"><span class=\"cl-e3f498bc\">81</span></p></td><td class=\"cl-e3f9a335\"><p class=\"cl-e3f97b16\"><span class=\"cl-e3f498bc\">2.832</span></p></td><td class=\"cl-e3f9a335\"><p class=\"cl-e3f97b16\"><span class=\"cl-e3f498bc\">0.518</span></p></td><td class=\"cl-e3f9a335\"><p class=\"cl-e3f97b16\"><span class=\"cl-e3f498bc\">17.410</span></p></td><td class=\"cl-e3f9a335\"><p class=\"cl-e3f97b16\"><span class=\"cl-e3f498bc\">1.718</span></p></td><td class=\"cl-e3f9a335\"><p class=\"cl-e3f97b16\"><span class=\"cl-e3f498bc\">0.049305</span></p></td><td class=\"cl-e3f9a335\"><p class=\"cl-e3f97b16\"><span class=\"cl-e3f498bc\">0</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-e3f9a33f\"><p class=\"cl-e3f97b16\"><span class=\"cl-e3f498bc\">2023</span></p></td><td class=\"cl-e3f9a348\"><p class=\"cl-e3f97b2a\"><span class=\"cl-e3f498bc\">EBS</span></p></td><td class=\"cl-e3f9a348\"><p class=\"cl-e3f97b2a\"><span class=\"cl-e3f498bc\">eastern Bering Sea</span></p></td><td class=\"cl-e3f9a348\"><p class=\"cl-e3f97b2a\"><span class=\"cl-e3f498bc\">Eastern Bering Sea Crab/Groundfish Bottom Trawl Survey</span></p></td><td class=\"cl-e3f9a33f\"><p class=\"cl-e3f97b16\"><span class=\"cl-e3f498bc\">98</span></p></td><td class=\"cl-e3f9a33f\"><p class=\"cl-e3f97b16\"><span class=\"cl-e3f498bc\">202301</span></p></td><td class=\"cl-e3f9a33f\"><p class=\"cl-e3f97b16\"><span class=\"cl-e3f498bc\">-760</span></p></td><td class=\"cl-e3f9a33f\"><p class=\"cl-e3f97b16\"><span class=\"cl-e3f498bc\">-22,519</span></p></td><td class=\"cl-e3f9a33f\"><p class=\"cl-e3f97b16\"><span class=\"cl-e3f498bc\">99</span></p></td><td class=\"cl-e3f9a33f\"><p class=\"cl-e3f97b16\"><span class=\"cl-e3f498bc\">32</span></p></td><td class=\"cl-e3f9a348\"><p class=\"cl-e3f97b2a\"><span class=\"cl-e3f498bc\">F-19</span></p></td><td class=\"cl-e3f9a33f\"><p class=\"cl-e3f97b16\"><span class=\"cl-e3f498bc\">134</span></p></td><td class=\"cl-e3f9a348\"><p class=\"cl-e3f97b2a\"><span class=\"cl-e3f498bc\">NORTHWEST EXPLORER</span></p></td><td class=\"cl-e3f9a348\"><p class=\"cl-e3f97b2a\"><span class=\"cl-e3f498bc\">2023-06-23T12:29:26Z</span></p></td><td class=\"cl-e3f9a33f\"><p class=\"cl-e3f97b16\"><span class=\"cl-e3f498bc\">56.66742</span></p></td><td class=\"cl-e3f9a33f\"><p class=\"cl-e3f97b16\"><span class=\"cl-e3f498bc\">-168.9206</span></p></td><td class=\"cl-e3f9a33f\"><p class=\"cl-e3f97b16\"><span class=\"cl-e3f498bc\">56.68896</span></p></td><td class=\"cl-e3f9a33f\"><p class=\"cl-e3f97b16\"><span class=\"cl-e3f498bc\">-168.8964</span></p></td><td class=\"cl-e3f9a33f\"><p class=\"cl-e3f97b16\"><span class=\"cl-e3f498bc\">4.1</span></p></td><td class=\"cl-e3f9a33f\"><p class=\"cl-e3f97b16\"><span class=\"cl-e3f498bc\">7.3</span></p></td><td class=\"cl-e3f9a33f\"><p class=\"cl-e3f97b16\"><span class=\"cl-e3f498bc\">99</span></p></td><td class=\"cl-e3f9a33f\"><p class=\"cl-e3f97b16\"><span class=\"cl-e3f498bc\">2.820</span></p></td><td class=\"cl-e3f9a33f\"><p class=\"cl-e3f97b16\"><span class=\"cl-e3f498bc\">0.514</span></p></td><td class=\"cl-e3f9a33f\"><p class=\"cl-e3f97b16\"><span class=\"cl-e3f498bc\">18.057</span></p></td><td class=\"cl-e3f9a33f\"><p class=\"cl-e3f97b16\"><span class=\"cl-e3f498bc\">1.969</span></p></td><td class=\"cl-e3f9a33f\"><p class=\"cl-e3f97b16\"><span class=\"cl-e3f498bc\">0.050921</span></p></td><td class=\"cl-e3f9a33f\"><p class=\"cl-e3f97b16\"><span class=\"cl-e3f498bc\">0</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-e3f9a335\"><p class=\"cl-e3f97b16\"><span class=\"cl-e3f498bc\">2023</span></p></td><td class=\"cl-e3f9a33e\"><p class=\"cl-e3f97b2a\"><span class=\"cl-e3f498bc\">EBS</span></p></td><td class=\"cl-e3f9a33e\"><p class=\"cl-e3f97b2a\"><span class=\"cl-e3f498bc\">eastern Bering Sea</span></p></td><td class=\"cl-e3f9a33e\"><p class=\"cl-e3f97b2a\"><span class=\"cl-e3f498bc\">Eastern Bering Sea Crab/Groundfish Bottom Trawl Survey</span></p></td><td class=\"cl-e3f9a335\"><p class=\"cl-e3f97b16\"><span class=\"cl-e3f498bc\">98</span></p></td><td class=\"cl-e3f9a335\"><p class=\"cl-e3f97b16\"><span class=\"cl-e3f498bc\">202301</span></p></td><td class=\"cl-e3f9a335\"><p class=\"cl-e3f97b16\"><span class=\"cl-e3f498bc\">-759</span></p></td><td class=\"cl-e3f9a335\"><p class=\"cl-e3f97b16\"><span class=\"cl-e3f498bc\">-22,827</span></p></td><td class=\"cl-e3f9a335\"><p class=\"cl-e3f97b16\"><span class=\"cl-e3f498bc\">175</span></p></td><td class=\"cl-e3f9a335\"><p class=\"cl-e3f97b16\"><span class=\"cl-e3f498bc\">43</span></p></td><td class=\"cl-e3f9a33e\"><p class=\"cl-e3f97b2a\"><span class=\"cl-e3f498bc\">QP2524</span></p></td><td class=\"cl-e3f9a335\"><p class=\"cl-e3f97b16\"><span class=\"cl-e3f498bc\">162</span></p></td><td class=\"cl-e3f9a33e\"><p class=\"cl-e3f97b2a\"><span class=\"cl-e3f498bc\">ALASKA KNIGHT</span></p></td><td class=\"cl-e3f9a33e\"><p class=\"cl-e3f97b2a\"><span class=\"cl-e3f498bc\">2023-07-18T15:36:29Z</span></p></td><td class=\"cl-e3f9a335\"><p class=\"cl-e3f97b16\"><span class=\"cl-e3f498bc\">60.18568</span></p></td><td class=\"cl-e3f9a335\"><p class=\"cl-e3f97b16\"><span class=\"cl-e3f498bc\">-173.0366</span></p></td><td class=\"cl-e3f9a335\"><p class=\"cl-e3f97b16\"><span class=\"cl-e3f498bc\">60.16572</span></p></td><td class=\"cl-e3f9a335\"><p class=\"cl-e3f97b16\"><span class=\"cl-e3f498bc\">-173.0021</span></p></td><td class=\"cl-e3f9a335\"><p class=\"cl-e3f97b16\"><span class=\"cl-e3f498bc\">-0.8</span></p></td><td class=\"cl-e3f9a335\"><p class=\"cl-e3f97b16\"><span class=\"cl-e3f498bc\">7.5</span></p></td><td class=\"cl-e3f9a335\"><p class=\"cl-e3f97b16\"><span class=\"cl-e3f498bc\">59</span></p></td><td class=\"cl-e3f9a335\"><p class=\"cl-e3f97b16\"><span class=\"cl-e3f498bc\">2.936</span></p></td><td class=\"cl-e3f9a335\"><p class=\"cl-e3f97b16\"><span class=\"cl-e3f498bc\">0.532</span></p></td><td class=\"cl-e3f9a335\"><p class=\"cl-e3f97b16\"><span class=\"cl-e3f498bc\">17.630</span></p></td><td class=\"cl-e3f9a335\"><p class=\"cl-e3f97b16\"><span class=\"cl-e3f498bc\">2.210</span></p></td><td class=\"cl-e3f9a335\"><p class=\"cl-e3f97b16\"><span class=\"cl-e3f498bc\">0.051762</span></p></td><td class=\"cl-e3f9a335\"><p class=\"cl-e3f97b16\"><span class=\"cl-e3f498bc\">0</span></p></td></tr></tbody></table></div>\n```\n:::\n:::\n\n\n### Identify `species_code` for walleye pollock\n\nIn the catch data, we itemize species catches by `species_code`. To find out which `species_code` to use, you can check variations on the following code. Note that here the word `pollock` is case sensitive. All species `common_name` entries are lower case except for proper nouns (e.g., \"Pacific\"). The notation for finding a string is to use `%` around the phrase. Since `%` is a reserved character in a URL, you have to replace `%` with `%25`. Similarly, `%20` needs to be used in place of a space (e.g., between \"walleye\" and \"pollock\": `\"walleye%20pollock\"}'`).  \n\n\n::: {.cell}\n\n```{.r .cell-code}\n## query the API link. Use: \nres <- httr::GET(url = paste0(api_link_species, '?q={%22common_name%22:%22walleye%20pollock%22}'))\n# OR\nres <- httr::GET(url = paste0(api_link_species, '?q={\"common_name\":{\"$like\":\"%25pollock%25\"}}'))\n# OR\nres <- httr::GET(url = paste0(api_link_species, '?q={\"common_name\":\"walleye%20pollock\"}'))\n\n## convert from JSON format\ndata <- jsonlite::fromJSON(base::rawToChar(res$content)) \n\n# save outputs for later comparison\ndat_species_ex <- data$items %>% dplyr::select(-links) # necessary for API accounting, but not part of the dataset\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndat_species_ex\n```\n:::\n\n::: {.cell tbl-cap='Walleye pollock species information. '}\n::: {.cell-output-display}\n```{=html}\n<div class=\"tabwid\"><style>.cl-e477374a{}.cl-e46be656{font-family:'Arial';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-e46be660{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-e4703b34{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-e4703b48{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-e4705772{width:0.75in;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e470577c{width:0.75in;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e4705786{width:0.75in;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e4705790{width:0.75in;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-e477374a'><thead><tr style=\"overflow-wrap:break-word;\"><th class=\"cl-e4705772\"><p class=\"cl-e4703b34\"><span class=\"cl-e46be656\">species_code</span></p></th><th class=\"cl-e470577c\"><p class=\"cl-e4703b48\"><span class=\"cl-e46be656\">scientific_name</span></p></th><th class=\"cl-e470577c\"><p class=\"cl-e4703b48\"><span class=\"cl-e46be656\">common_name</span></p></th><th class=\"cl-e470577c\"><p class=\"cl-e4703b48\"><span class=\"cl-e46be656\">id_rank</span></p></th><th class=\"cl-e4705772\"><p class=\"cl-e4703b34\"><span class=\"cl-e46be656\">worms</span></p></th><th class=\"cl-e4705772\"><p class=\"cl-e4703b34\"><span class=\"cl-e46be656\">itis</span></p></th></tr></thead><tbody><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-e4705786\"><p class=\"cl-e4703b34\"><span class=\"cl-e46be660\">21740</span></p></td><td class=\"cl-e4705790\"><p class=\"cl-e4703b48\"><span class=\"cl-e46be660\">Gadus chalcogrammus</span></p></td><td class=\"cl-e4705790\"><p class=\"cl-e4703b48\"><span class=\"cl-e46be660\">walleye pollock</span></p></td><td class=\"cl-e4705790\"><p class=\"cl-e4703b48\"><span class=\"cl-e46be660\">species</span></p></td><td class=\"cl-e4705786\"><p class=\"cl-e4703b34\"><span class=\"cl-e46be660\">300735</span></p></td><td class=\"cl-e4705786\"><p class=\"cl-e4703b34\"><span class=\"cl-e46be660\">934083</span></p></td></tr></tbody></table></div>\n```\n:::\n:::\n\n\n### Then, apply the `hauljoins` and `species_code` to catch query\n\nWe'll use the data from the haul and species table we collected before to select 2023 eastern Bering Sea walleye pollock catch data. \n\n\n::: {.cell}\n\n```{.r .cell-code}\n## query the API link\n# data for all walleye pollock caught in all 2023 eastern Bering Sea survey hauls\ndat <- data.frame()\n# there must be a better way to select multiple values for one parameter, \n# but saving that, we will loop through each hauljoin and collect the data of interest\nfor (i in 1:nrow(dat_haul_ex)) {\n  res <- httr::GET(url = paste0(\n    api_link_catch, \n    '?q={\"species_code\":21740,\"hauljoin\":', dat_haul_ex$hauljoin[i],'}'))\n  ## convert from JSON format\n  data <- jsonlite::fromJSON(base::rawToChar(res$content)) \n  if (length(data$items) != 0) {\n    dat <- dplyr::bind_rows(\n      dat,\n      data$items %>% \n        dplyr::select(-links)) # necessary for API accounting, but not part of the dataset\n  }\n}\n\n## show summary of data to make sure it is subset correctly\nsummary(dat)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n    hauljoin       species_code     cpue_kgkm2          cpue_nokm2       \n Min.   :-23019   Min.   :21740   Min.   :    10.34   Min.   :    18.26  \n 1st Qu.:-22777   1st Qu.:21740   1st Qu.:  1454.44   1st Qu.:  2278.72  \n Median :-22540   Median :21740   Median :  3286.76   Median :  5875.33  \n Mean   :-22553   Mean   :21740   Mean   :  6364.85   Mean   : 11565.45  \n 3rd Qu.:-22324   3rd Qu.:21740   3rd Qu.:  6956.25   3rd Qu.: 12512.98  \n Max.   :-22110   Max.   :21740   Max.   :148679.68   Max.   :202321.08  \n                                                      NA's   :1          \n     count        weight_kg        taxon_confidence\n Min.   :   1   Min.   :   0.492   Mode:logical    \n 1st Qu.: 114   1st Qu.:  71.560   NA's:374        \n Median : 286   Median : 162.310                   \n Mean   : 574   Mean   : 315.419                   \n 3rd Qu.: 619   3rd Qu.: 350.399                   \n Max.   :9997   Max.   :7346.495                   \n NA's   :1                                         \n```\n:::\n\n```{.r .cell-code}\n## Find how many rows and columns are in the data pull. \n## The eastern Bering Sea survey has 376 stations in it, \n## and pollock are often found in throughout the region\n## so this should have a similar number of rows. \nprint(paste0(\"rows: \", dim(dat)[1], \"; cols: \", dim(dat)[2]))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"rows: 374; cols: 7\"\n```\n:::\n\n```{.r .cell-code}\n# save outputs for later comparison\ndat_catch_ex <- dat\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Print the first few lines of the data \nhead(dat, 3)\n```\n:::\n\n::: {.cell tbl-cap='Catch data for all 2023 eastern Bering Sea Walleye Pollock. '}\n::: {.cell-output-display}\n```{=html}\n<div class=\"tabwid\"><style>.cl-107479a2{}.cl-10688458{font-family:'Arial';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-10688462{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-106c6636{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-106c81ca{width:0.75in;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-106c81cb{width:0.75in;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-106c81d4{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-107479a2'><thead><tr style=\"overflow-wrap:break-word;\"><th class=\"cl-106c81ca\"><p class=\"cl-106c6636\"><span class=\"cl-10688458\">hauljoin</span></p></th><th class=\"cl-106c81ca\"><p class=\"cl-106c6636\"><span class=\"cl-10688458\">species_code</span></p></th><th class=\"cl-106c81ca\"><p class=\"cl-106c6636\"><span class=\"cl-10688458\">cpue_kgkm2</span></p></th><th class=\"cl-106c81ca\"><p class=\"cl-106c6636\"><span class=\"cl-10688458\">cpue_nokm2</span></p></th><th class=\"cl-106c81ca\"><p class=\"cl-106c6636\"><span class=\"cl-10688458\">count</span></p></th><th class=\"cl-106c81ca\"><p class=\"cl-106c6636\"><span class=\"cl-10688458\">weight_kg</span></p></th><th class=\"cl-106c81ca\"><p class=\"cl-106c6636\"><span class=\"cl-10688458\">taxon_confidence</span></p></th></tr></thead><tbody><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-106c81cb\"><p class=\"cl-106c6636\"><span class=\"cl-10688462\">-22,490</span></p></td><td class=\"cl-106c81cb\"><p class=\"cl-106c6636\"><span class=\"cl-10688462\">21740</span></p></td><td class=\"cl-106c81cb\"><p class=\"cl-106c6636\"><span class=\"cl-10688462\">3,484.790</span></p></td><td class=\"cl-106c81cb\"><p class=\"cl-106c6636\"><span class=\"cl-10688462\">5,983.151</span></p></td><td class=\"cl-106c81cb\"><p class=\"cl-106c6636\"><span class=\"cl-10688462\">295</span></p></td><td class=\"cl-106c81cb\"><p class=\"cl-106c6636\"><span class=\"cl-10688462\">171.818</span></p></td><td class=\"cl-106c81cb\"><p class=\"cl-106c6636\"><span class=\"cl-10688462\"></span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-106c81d4\"><p class=\"cl-106c6636\"><span class=\"cl-10688462\">-22,519</span></p></td><td class=\"cl-106c81d4\"><p class=\"cl-106c6636\"><span class=\"cl-10688462\">21740</span></p></td><td class=\"cl-106c81d4\"><p class=\"cl-106c6636\"><span class=\"cl-10688462\">13,112.849</span></p></td><td class=\"cl-106c81d4\"><p class=\"cl-106c6636\"><span class=\"cl-10688462\">34,799.180</span></p></td><td class=\"cl-106c81d4\"><p class=\"cl-106c6636\"><span class=\"cl-10688462\">1,772</span></p></td><td class=\"cl-106c81d4\"><p class=\"cl-106c6636\"><span class=\"cl-10688462\">667.716</span></p></td><td class=\"cl-106c81d4\"><p class=\"cl-106c6636\"><span class=\"cl-10688462\"></span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-106c81cb\"><p class=\"cl-106c6636\"><span class=\"cl-10688462\">-22,827</span></p></td><td class=\"cl-106c81cb\"><p class=\"cl-106c6636\"><span class=\"cl-10688462\">21740</span></p></td><td class=\"cl-106c81cb\"><p class=\"cl-106c6636\"><span class=\"cl-10688462\">2,544.044</span></p></td><td class=\"cl-106c81cb\"><p class=\"cl-106c6636\"><span class=\"cl-10688462\">6,124.222</span></p></td><td class=\"cl-106c81cb\"><p class=\"cl-106c6636\"><span class=\"cl-10688462\">317</span></p></td><td class=\"cl-106c81cb\"><p class=\"cl-106c6636\"><span class=\"cl-10688462\">131.684</span></p></td><td class=\"cl-106c81cb\"><p class=\"cl-106c6636\"><span class=\"cl-10688462\"></span></p></td></tr></tbody></table></div>\n```\n:::\n:::\n\n\nFor reference and to help break down the above query, see these other query examples:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# data for haul -22775 (i.e., one specific haul)?\nres <- httr::GET(url = paste0(api_link_catch, \n                              '?offset=',i,'&limit=10000&q={\"hauljoin\":-22775}'))\n\n# data for all walleye pollock (i.e., one species) caught in all years and surveys\nres <- httr::GET(url = paste0(api_link_catch, \n                              '?offset=',i,'&limit=10000&q={\"species_code\":21740}'))\n```\n:::\n\n\n\n\n### Create zero-filled data for 2023 eastern Bering Sea walleye pollock and plot\n\nIt is important to create and have access to zero-fill (presence and absence) so you can do simple analyses and plot data. \n\n\n::: {.cell}\n\n```{.r .cell-code}\ndat <- dplyr::full_join(\n  dat_haul_ex,\n  dat_catch_ex) %>% \n  dplyr::full_join(\n    dat_species_ex)  %>% \n  # modify zero-filled rows\n  dplyr::mutate(\n    cpue_kgkm2 = ifelse(is.na(cpue_kgkm2), 0, cpue_kgkm2),\n    cpue_nokm2 = ifelse(is.na(cpue_nokm2), 0, cpue_nokm2),\n    count = ifelse(is.na(count), 0, count),\n    weight_kg = ifelse(is.na(weight_kg), 0, weight_kg))\n\n## show summary of data to make sure it is subset correctly\nsummary(dat)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n      year          srvy              survey          survey_name       \n Min.   :2023   Length:376         Length:376         Length:376        \n 1st Qu.:2023   Class :character   Class :character   Class :character  \n Median :2023   Mode  :character   Mode  :character   Mode  :character  \n Mean   :2023                                                           \n 3rd Qu.:2023                                                           \n Max.   :2023                                                           \n                                                                        \n survey_definition_id     cruise         cruisejoin        hauljoin     \n Min.   :98           Min.   :202301   Min.   :-760.0   Min.   :-23019  \n 1st Qu.:98           1st Qu.:202301   1st Qu.:-760.0   1st Qu.:-22776  \n Median :98           Median :202301   Median :-759.0   Median :-22539  \n Mean   :98           Mean   :202301   Mean   :-759.5   Mean   :-22552  \n 3rd Qu.:98           3rd Qu.:202301   3rd Qu.:-759.0   3rd Qu.:-22333  \n Max.   :98           Max.   :202301   Max.   :-759.0   Max.   :-22110  \n                                                                        \n      haul           stratum        station            vessel_id    \n Min.   :  7.00   Min.   :10.00   Length:376         Min.   :134.0  \n 1st Qu.: 65.75   1st Qu.:31.00   Class :character   1st Qu.:134.0  \n Median :114.00   Median :41.00   Mode  :character   Median :162.0  \n Mean   :114.16   Mean   :39.22                      Mean   :148.3  \n 3rd Qu.:161.25   3rd Qu.:50.00                      3rd Qu.:162.0  \n Max.   :224.00   Max.   :90.00                      Max.   :162.0  \n                                                                    \n vessel_name         date_time         latitude_dd_start longitude_dd_start\n Length:376         Length:376         Min.   :54.66     Min.   :-178.2    \n Class :character   Class :character   1st Qu.:57.00     1st Qu.:-172.7    \n Mode  :character   Mode  :character   Median :58.02     Median :-168.9    \n                                       Mean   :58.26     Mean   :-168.8    \n                                       3rd Qu.:59.50     3rd Qu.:-165.2    \n                                       Max.   :62.01     Max.   :-158.3    \n                                                                           \n latitude_dd_end longitude_dd_end bottom_temperature_c surface_temperature_c\n Min.   :54.68   Min.   :-178.2   Min.   :-1.600       Min.   : 1.700       \n 1st Qu.:57.01   1st Qu.:-172.7   1st Qu.: 1.200       1st Qu.: 4.200       \n Median :58.02   Median :-168.9   Median : 2.700       Median : 6.550       \n Mean   :58.26   Mean   :-168.8   Mean   : 2.249       Mean   : 6.386       \n 3rd Qu.:59.50   3rd Qu.:-165.2   3rd Qu.: 3.500       3rd Qu.: 8.525       \n Max.   :62.01   Max.   :-158.3   Max.   : 5.400       Max.   :11.000       \n                                                                            \n    depth_m       distance_fished_km  duration_hr      net_width_m   \n Min.   : 20.00   Min.   :1.065      Min.   :0.1890   Min.   :12.90  \n 1st Qu.: 54.75   1st Qu.:2.805      1st Qu.:0.5100   1st Qu.:16.66  \n Median : 74.00   Median :2.889      Median :0.5180   Median :17.27  \n Mean   : 80.75   Mean   :2.854      Mean   :0.5129   Mean   :17.15  \n 3rd Qu.:105.00   3rd Qu.:2.945      3rd Qu.:0.5260   3rd Qu.:17.83  \n Max.   :171.00   Max.   :3.849      Max.   :0.6560   Max.   :20.29  \n                                                                     \n  net_height_m   area_swept_km2     performance      species_code  \n Min.   :1.300   Min.   :0.02017   Min.   :0.0000   Min.   :21740  \n 1st Qu.:1.875   1st Qu.:0.04725   1st Qu.:0.0000   1st Qu.:21740  \n Median :2.064   Median :0.04944   Median :0.0000   Median :21740  \n Mean   :2.107   Mean   :0.04892   Mean   :0.1075   Mean   :21740  \n 3rd Qu.:2.343   3rd Qu.:0.05134   3rd Qu.:0.0000   3rd Qu.:21740  \n Max.   :3.196   Max.   :0.06369   Max.   :6.2200   Max.   :21740  \n                                                    NA's   :2      \n   cpue_kgkm2       cpue_nokm2         count          weight_kg      \n Min.   :     0   Min.   :     0   Min.   :   0.0   Min.   :   0.00  \n 1st Qu.:  1431   1st Qu.:  2238   1st Qu.: 111.5   1st Qu.:  70.64  \n Median :  3273   Median :  5842   Median : 280.0   Median : 161.44  \n Mean   :  6331   Mean   : 11473   Mean   : 569.4   Mean   : 313.74  \n 3rd Qu.:  6946   3rd Qu.: 12345   3rd Qu.: 611.5   3rd Qu.: 349.81  \n Max.   :148680   Max.   :202321   Max.   :9997.0   Max.   :7346.49  \n                                                                     \n taxon_confidence scientific_name    common_name          id_rank         \n Mode:logical     Length:376         Length:376         Length:376        \n NA's:376         Class :character   Class :character   Class :character  \n                  Mode  :character   Mode  :character   Mode  :character  \n                                                                          \n                                                                          \n                                                                          \n                                                                          \n     worms             itis       \n Min.   :300735   Min.   :934083  \n 1st Qu.:300735   1st Qu.:934083  \n Median :300735   Median :934083  \n Mean   :300735   Mean   :934083  \n 3rd Qu.:300735   3rd Qu.:934083  \n Max.   :300735   Max.   :934083  \n NA's   :2        NA's   :2       \n```\n:::\n\n```{.r .cell-code}\n## Find how many rows and columns are in the data pull. \n## Because all of the data have been full joined together, \n## there should be the maximum number of rows. \nprint(paste0(\"rows: \", dim(dat)[1], \"; cols: \", dim(dat)[2]))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"rows: 376; cols: 38\"\n```\n:::\n\n```{.r .cell-code}\nhead(dat, 3) %>% \n  flextable::flextable()\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"tabwid\"><style>.cl-10d41ac4{}.cl-10c0ddd8{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-10c77cd8{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-10c77ce2{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-10c79d58{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-10c79d62{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-10c79d63{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-10c79d6c{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-10c79d6d{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-10c79d6e{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-10d41ac4'><thead><tr style=\"overflow-wrap:break-word;\"><th class=\"cl-10c79d58\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\">year</span></p></th><th class=\"cl-10c79d62\"><p class=\"cl-10c77ce2\"><span class=\"cl-10c0ddd8\">srvy</span></p></th><th class=\"cl-10c79d62\"><p class=\"cl-10c77ce2\"><span class=\"cl-10c0ddd8\">survey</span></p></th><th class=\"cl-10c79d62\"><p class=\"cl-10c77ce2\"><span class=\"cl-10c0ddd8\">survey_name</span></p></th><th class=\"cl-10c79d58\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\">survey_definition_id</span></p></th><th class=\"cl-10c79d58\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\">cruise</span></p></th><th class=\"cl-10c79d58\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\">cruisejoin</span></p></th><th class=\"cl-10c79d58\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\">hauljoin</span></p></th><th class=\"cl-10c79d58\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\">haul</span></p></th><th class=\"cl-10c79d58\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\">stratum</span></p></th><th class=\"cl-10c79d62\"><p class=\"cl-10c77ce2\"><span class=\"cl-10c0ddd8\">station</span></p></th><th class=\"cl-10c79d58\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\">vessel_id</span></p></th><th class=\"cl-10c79d62\"><p class=\"cl-10c77ce2\"><span class=\"cl-10c0ddd8\">vessel_name</span></p></th><th class=\"cl-10c79d62\"><p class=\"cl-10c77ce2\"><span class=\"cl-10c0ddd8\">date_time</span></p></th><th class=\"cl-10c79d58\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\">latitude_dd_start</span></p></th><th class=\"cl-10c79d58\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\">longitude_dd_start</span></p></th><th class=\"cl-10c79d58\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\">latitude_dd_end</span></p></th><th class=\"cl-10c79d58\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\">longitude_dd_end</span></p></th><th class=\"cl-10c79d58\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\">bottom_temperature_c</span></p></th><th class=\"cl-10c79d58\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\">surface_temperature_c</span></p></th><th class=\"cl-10c79d58\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\">depth_m</span></p></th><th class=\"cl-10c79d58\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\">distance_fished_km</span></p></th><th class=\"cl-10c79d58\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\">duration_hr</span></p></th><th class=\"cl-10c79d58\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\">net_width_m</span></p></th><th class=\"cl-10c79d58\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\">net_height_m</span></p></th><th class=\"cl-10c79d58\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\">area_swept_km2</span></p></th><th class=\"cl-10c79d58\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\">performance</span></p></th><th class=\"cl-10c79d58\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\">species_code</span></p></th><th class=\"cl-10c79d58\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\">cpue_kgkm2</span></p></th><th class=\"cl-10c79d58\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\">cpue_nokm2</span></p></th><th class=\"cl-10c79d58\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\">count</span></p></th><th class=\"cl-10c79d58\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\">weight_kg</span></p></th><th class=\"cl-10c79d58\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\">taxon_confidence</span></p></th><th class=\"cl-10c79d62\"><p class=\"cl-10c77ce2\"><span class=\"cl-10c0ddd8\">scientific_name</span></p></th><th class=\"cl-10c79d62\"><p class=\"cl-10c77ce2\"><span class=\"cl-10c0ddd8\">common_name</span></p></th><th class=\"cl-10c79d62\"><p class=\"cl-10c77ce2\"><span class=\"cl-10c0ddd8\">id_rank</span></p></th><th class=\"cl-10c79d58\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\">worms</span></p></th><th class=\"cl-10c79d58\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\">itis</span></p></th></tr></thead><tbody><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-10c79d63\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\">2,023</span></p></td><td class=\"cl-10c79d6c\"><p class=\"cl-10c77ce2\"><span class=\"cl-10c0ddd8\">EBS</span></p></td><td class=\"cl-10c79d6c\"><p class=\"cl-10c77ce2\"><span class=\"cl-10c0ddd8\">eastern Bering Sea</span></p></td><td class=\"cl-10c79d6c\"><p class=\"cl-10c77ce2\"><span class=\"cl-10c0ddd8\">Eastern Bering Sea Crab/Groundfish Bottom Trawl Survey</span></p></td><td class=\"cl-10c79d63\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\">98</span></p></td><td class=\"cl-10c79d63\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\">202,301</span></p></td><td class=\"cl-10c79d63\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\">-759</span></p></td><td class=\"cl-10c79d63\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\">-22,490</span></p></td><td class=\"cl-10c79d63\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\">109</span></p></td><td class=\"cl-10c79d63\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\">32</span></p></td><td class=\"cl-10c79d6c\"><p class=\"cl-10c77ce2\"><span class=\"cl-10c0ddd8\">G-18</span></p></td><td class=\"cl-10c79d63\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\">162</span></p></td><td class=\"cl-10c79d6c\"><p class=\"cl-10c77ce2\"><span class=\"cl-10c0ddd8\">ALASKA KNIGHT</span></p></td><td class=\"cl-10c79d6c\"><p class=\"cl-10c77ce2\"><span class=\"cl-10c0ddd8\">2023-06-21T12:51:22Z</span></p></td><td class=\"cl-10c79d63\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\">56.99438</span></p></td><td class=\"cl-10c79d63\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\">-168.3313</span></p></td><td class=\"cl-10c79d63\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\">57.01985</span></p></td><td class=\"cl-10c79d63\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\">-168.3298</span></p></td><td class=\"cl-10c79d63\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\">3.5</span></p></td><td class=\"cl-10c79d63\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\">7.4</span></p></td><td class=\"cl-10c79d63\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\">81</span></p></td><td class=\"cl-10c79d63\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\">2.832</span></p></td><td class=\"cl-10c79d63\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\">0.518</span></p></td><td class=\"cl-10c79d63\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\">17.410</span></p></td><td class=\"cl-10c79d63\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\">1.718</span></p></td><td class=\"cl-10c79d63\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\">0.049305</span></p></td><td class=\"cl-10c79d63\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\">0</span></p></td><td class=\"cl-10c79d63\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\">21,740</span></p></td><td class=\"cl-10c79d63\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\">3,484.790</span></p></td><td class=\"cl-10c79d63\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\">5,983.151</span></p></td><td class=\"cl-10c79d63\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\">295</span></p></td><td class=\"cl-10c79d63\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\">171.818</span></p></td><td class=\"cl-10c79d63\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\"></span></p></td><td class=\"cl-10c79d6c\"><p class=\"cl-10c77ce2\"><span class=\"cl-10c0ddd8\">Gadus chalcogrammus</span></p></td><td class=\"cl-10c79d6c\"><p class=\"cl-10c77ce2\"><span class=\"cl-10c0ddd8\">walleye pollock</span></p></td><td class=\"cl-10c79d6c\"><p class=\"cl-10c77ce2\"><span class=\"cl-10c0ddd8\">species</span></p></td><td class=\"cl-10c79d63\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\">300,735</span></p></td><td class=\"cl-10c79d63\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\">934,083</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-10c79d63\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\">2,023</span></p></td><td class=\"cl-10c79d6c\"><p class=\"cl-10c77ce2\"><span class=\"cl-10c0ddd8\">EBS</span></p></td><td class=\"cl-10c79d6c\"><p class=\"cl-10c77ce2\"><span class=\"cl-10c0ddd8\">eastern Bering Sea</span></p></td><td class=\"cl-10c79d6c\"><p class=\"cl-10c77ce2\"><span class=\"cl-10c0ddd8\">Eastern Bering Sea Crab/Groundfish Bottom Trawl Survey</span></p></td><td class=\"cl-10c79d63\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\">98</span></p></td><td class=\"cl-10c79d63\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\">202,301</span></p></td><td class=\"cl-10c79d63\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\">-760</span></p></td><td class=\"cl-10c79d63\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\">-22,519</span></p></td><td class=\"cl-10c79d63\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\">99</span></p></td><td class=\"cl-10c79d63\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\">32</span></p></td><td class=\"cl-10c79d6c\"><p class=\"cl-10c77ce2\"><span class=\"cl-10c0ddd8\">F-19</span></p></td><td class=\"cl-10c79d63\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\">134</span></p></td><td class=\"cl-10c79d6c\"><p class=\"cl-10c77ce2\"><span class=\"cl-10c0ddd8\">NORTHWEST EXPLORER</span></p></td><td class=\"cl-10c79d6c\"><p class=\"cl-10c77ce2\"><span class=\"cl-10c0ddd8\">2023-06-23T12:29:26Z</span></p></td><td class=\"cl-10c79d63\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\">56.66742</span></p></td><td class=\"cl-10c79d63\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\">-168.9206</span></p></td><td class=\"cl-10c79d63\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\">56.68896</span></p></td><td class=\"cl-10c79d63\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\">-168.8964</span></p></td><td class=\"cl-10c79d63\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\">4.1</span></p></td><td class=\"cl-10c79d63\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\">7.3</span></p></td><td class=\"cl-10c79d63\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\">99</span></p></td><td class=\"cl-10c79d63\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\">2.820</span></p></td><td class=\"cl-10c79d63\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\">0.514</span></p></td><td class=\"cl-10c79d63\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\">18.057</span></p></td><td class=\"cl-10c79d63\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\">1.969</span></p></td><td class=\"cl-10c79d63\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\">0.050921</span></p></td><td class=\"cl-10c79d63\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\">0</span></p></td><td class=\"cl-10c79d63\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\">21,740</span></p></td><td class=\"cl-10c79d63\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\">13,112.849</span></p></td><td class=\"cl-10c79d63\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\">34,799.180</span></p></td><td class=\"cl-10c79d63\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\">1,772</span></p></td><td class=\"cl-10c79d63\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\">667.716</span></p></td><td class=\"cl-10c79d63\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\"></span></p></td><td class=\"cl-10c79d6c\"><p class=\"cl-10c77ce2\"><span class=\"cl-10c0ddd8\">Gadus chalcogrammus</span></p></td><td class=\"cl-10c79d6c\"><p class=\"cl-10c77ce2\"><span class=\"cl-10c0ddd8\">walleye pollock</span></p></td><td class=\"cl-10c79d6c\"><p class=\"cl-10c77ce2\"><span class=\"cl-10c0ddd8\">species</span></p></td><td class=\"cl-10c79d63\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\">300,735</span></p></td><td class=\"cl-10c79d63\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\">934,083</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-10c79d6d\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\">2,023</span></p></td><td class=\"cl-10c79d6e\"><p class=\"cl-10c77ce2\"><span class=\"cl-10c0ddd8\">EBS</span></p></td><td class=\"cl-10c79d6e\"><p class=\"cl-10c77ce2\"><span class=\"cl-10c0ddd8\">eastern Bering Sea</span></p></td><td class=\"cl-10c79d6e\"><p class=\"cl-10c77ce2\"><span class=\"cl-10c0ddd8\">Eastern Bering Sea Crab/Groundfish Bottom Trawl Survey</span></p></td><td class=\"cl-10c79d6d\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\">98</span></p></td><td class=\"cl-10c79d6d\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\">202,301</span></p></td><td class=\"cl-10c79d6d\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\">-759</span></p></td><td class=\"cl-10c79d6d\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\">-22,827</span></p></td><td class=\"cl-10c79d6d\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\">175</span></p></td><td class=\"cl-10c79d6d\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\">43</span></p></td><td class=\"cl-10c79d6e\"><p class=\"cl-10c77ce2\"><span class=\"cl-10c0ddd8\">QP2524</span></p></td><td class=\"cl-10c79d6d\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\">162</span></p></td><td class=\"cl-10c79d6e\"><p class=\"cl-10c77ce2\"><span class=\"cl-10c0ddd8\">ALASKA KNIGHT</span></p></td><td class=\"cl-10c79d6e\"><p class=\"cl-10c77ce2\"><span class=\"cl-10c0ddd8\">2023-07-18T15:36:29Z</span></p></td><td class=\"cl-10c79d6d\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\">60.18568</span></p></td><td class=\"cl-10c79d6d\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\">-173.0366</span></p></td><td class=\"cl-10c79d6d\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\">60.16572</span></p></td><td class=\"cl-10c79d6d\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\">-173.0021</span></p></td><td class=\"cl-10c79d6d\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\">-0.8</span></p></td><td class=\"cl-10c79d6d\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\">7.5</span></p></td><td class=\"cl-10c79d6d\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\">59</span></p></td><td class=\"cl-10c79d6d\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\">2.936</span></p></td><td class=\"cl-10c79d6d\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\">0.532</span></p></td><td class=\"cl-10c79d6d\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\">17.630</span></p></td><td class=\"cl-10c79d6d\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\">2.210</span></p></td><td class=\"cl-10c79d6d\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\">0.051762</span></p></td><td class=\"cl-10c79d6d\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\">0</span></p></td><td class=\"cl-10c79d6d\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\">21,740</span></p></td><td class=\"cl-10c79d6d\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\">2,544.044</span></p></td><td class=\"cl-10c79d6d\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\">6,124.222</span></p></td><td class=\"cl-10c79d6d\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\">317</span></p></td><td class=\"cl-10c79d6d\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\">131.684</span></p></td><td class=\"cl-10c79d6d\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\"></span></p></td><td class=\"cl-10c79d6e\"><p class=\"cl-10c77ce2\"><span class=\"cl-10c0ddd8\">Gadus chalcogrammus</span></p></td><td class=\"cl-10c79d6e\"><p class=\"cl-10c77ce2\"><span class=\"cl-10c0ddd8\">walleye pollock</span></p></td><td class=\"cl-10c79d6e\"><p class=\"cl-10c77ce2\"><span class=\"cl-10c0ddd8\">species</span></p></td><td class=\"cl-10c79d6d\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\">300,735</span></p></td><td class=\"cl-10c79d6d\"><p class=\"cl-10c77cd8\"><span class=\"cl-10c0ddd8\">934,083</span></p></td></tr></tbody></table></div>\n```\n:::\n:::\n\n\n### Visualize CPUE data in distribution map\n\nUsing the zero-filled data from the previous example, we can make a few plots! \n\n### Plot locations\n\n\n::: {.cell tbl-cap='Amount of catch at each station in the 2023 eastern Bering Sea bottom trawl survey. Red triangles denote stations where walleye pollock were not caught. '}\n\n```{.r .cell-code}\nlibrary(ggplot2)\n\nggplot2::ggplot(data = dat %>% dplyr::filter(cpue_kgkm2 != 0), \n                mapping = aes(x = longitude_dd_start, \n                              y = latitude_dd_start, \n                              size = cpue_kgkm2)) + \n  ggplot2::geom_point(alpha = .75) +\n  ggplot2::geom_point(data = dat %>% dplyr::filter(cpue_kgkm2 == 0), \n                      color = \"red\", \n                      shape = 17,\n                      alpha = .75,\n                      size = 3) +\n  ggplot2::xlab(\"Longitude *W\") +\n  ggplot2::ylab(\"Latitude *N\") +\n  ggplot2::ggtitle(label = \"Catches of walleye pollock (Weight CPUE; kg/km2)\", \n                   subtitle = \"2023 eastern Bering Sea bottom trawl survey\") +\n  ggplot2::scale_size_continuous(name = \"Weight (kg)\") + \n  ggplot2::theme_bw()\n```\n\n::: {.cell-output-display}\n![](foss-api-r_files/figure-html/pollock-multi1-loc-1.png){width=672}\n:::\n:::\n\n\n### Plot inverse-distance weighted modeled product of locations\n\nThis map is constructed using [`akgfmaps`](https://github.com/afsc-gap-products/akgfmaps)\n\n\n::: {.cell tbl-cap='Amount of catch at each station in the 2023 eastern Bering Sea bottom trawl survey. Red triangles denote stations where walleye pollock were not caught. '}\n\n```{.r .cell-code}\n# devtools::install_github(\"afsc-gap-products/akgfmaps\", build_vignettes = TRUE)\nlibrary(akgfmaps)\n\nfigure0 <- akgfmaps::make_idw_map(\n  CPUE_KGHA = dat$cpue_kgkm2, # calculates the same, regardless of units.  \n  LATITUDE = dat$latitude_dd_start, \n  LONGITUDE = dat$longitude_dd_start, \n  region = \"bs.south\", # Predefined EBS area\n  set.breaks = \"jenks\", # Gets Jenks breaks from classint::classIntervals()\n  in.crs = \"+proj=longlat\", # Set input coordinate reference system\n  out.crs = \"EPSG:3338\", # Set output coordinate reference system\n  grid.cell = c(20000, 20000))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[inverse distance weighted interpolation]\n[inverse distance weighted interpolation]\n```\n:::\n\n```{.r .cell-code}\nfigure0$plot + # 20x20km grid\n  ggplot2::guides(fill=guide_legend(title = \"walleye pollock\\nCPUE (kg/km2)\"))\n```\n\n::: {.cell-output-display}\n![](foss-api-r_files/figure-html/pollock-multi2-loc-1.png){width=672}\n:::\n:::\n\n\n# Other query examples\n\n## Ex. Combination of year, srvy, stratum\n\nShow haul data where year is less than 1989, srvy = \"EBS\", and stratum is not equal to 81. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nres <- httr::GET(\n  url = paste0(api_link_haul, \n               '?&limit=10000&q={\"year\":{\"$lt\":1989},\"stratum\":{\"$ne\":\"81\"},\"srvy\":\"EBS\"}}'))\ndata <- jsonlite::fromJSON(base::rawToChar(res$content))\ndat <- data$items %>% \n  dplyr::select(-links) # necessary for API accounting, but not part of the dataset)\n```\n:::\n\n\n\n\n\n\n",
    "supporting": [
      "foss-api-r_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../site_libs/tabwid-1.1.3/tabwid.css\" rel=\"stylesheet\" />\r\n<script src=\"../site_libs/tabwid-1.1.3/tabwid.js\"></script>\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}