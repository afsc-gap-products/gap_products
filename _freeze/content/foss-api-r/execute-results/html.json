{
  "hash": "0b2d43f11b5165a34a622aca9e6182f2",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: Access via API and R\nnumber-sections: true\n---\n\n\n\n\n\n**An application programming interface (API) is a way for two or more computer programs to communicate with each other.** More information about how to amend API links can be found [here](https://docs.oracle.com/en/database/oracle/oracle-rest-data-services/22.3/books.html#AELIG90103/). Useful introductions to using APIs in `R` can be found [here](https://www.dataquest.io/blog/r-api-tutorial/). \n\nThere are three tables the user can pull from the API. Learn more about them on the [FOSS data description page](https://afsc-gap-products.github.io/gap_products/content/foss-metadata.html). Here, you can see them in their raw JSON format:\n\n* haul: [https://apps-st.fisheries.noaa.gov/ods/foss/afsc_groundfish_survey_haul/](https://apps-st.fisheries.noaa.gov/ods/foss/afsc_groundfish_survey_haul/)\n* catch: [https://apps-st.fisheries.noaa.gov/ods/foss/afsc_groundfish_survey_catch/](https://apps-st.fisheries.noaa.gov/ods/foss/afsc_groundfish_survey_catch/)\n* species: [https://apps-st.fisheries.noaa.gov/ods/foss/afsc_groundfish_survey_species/](https://apps-st.fisheries.noaa.gov/ods/foss/afsc_groundfish_survey_species/)\n\nHere are some examples of how to use the data with R:\n\n## Ex. Load all rows of the catch, haul, and species data tables\n\nNote that without specifying, a basic query to the API will only return 25 entries. \n\n### Load haul data\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# link to the API\napi_link_haul <- 'https://apps-st.fisheries.noaa.gov/ods/foss/afsc_groundfish_survey_haul/'\n```\n:::\n\n\n\n::: {.cell inlcude='false'}\n\n:::\n\n\n#### Load first 25 rows of data\n\n\n::: {.cell}\n\n```{.r .cell-code}\nres <- httr::GET(url = api_link_haul)\n# res ## Test connection\n\n## convert from JSON format\ndat <- jsonlite::fromJSON(base::rawToChar(res$content))$items\n\n# Find how many rows and columns are in the data pull\nprint(paste0(\"rows: \", nrow(dat), \"; cols: \", ncol(dat)))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"rows: 25; cols: 28\"\n```\n\n\n:::\n:::\n\n\n#### Load all data:\n\nSince the maxim number of rows a user can pull is 10,000 rows in a query, the user needs to cycle through by `offsetting` to the next 10,000 rows (as is shown here). \n\n\n::: {.cell}\n\n```{.r .cell-code}\ndat <- data.frame()\nfor (i in seq(0, 500000, 10000)){\n  ## find how many iterations it takes to cycle through the data\n  print(i)\n  ## query the API link\n  res <- httr::GET(url = paste0(api_link_haul, \"?offset=\",i,\"&limit=10000\"))\n  ## convert from JSON format\n  data <- jsonlite::fromJSON(base::rawToChar(res$content)) \n  \n  ## if there are no data, stop the loop\n  if (is.null(nrow(data$items))) {\n    break\n  }\n  \n  ## bind sub-pull to dat data.frame\n  dat <- dplyr::bind_rows(dat, \n                          data$items |>\n                            dplyr::select(-links)) # necessary for API accounting, but not part of the dataset)\n}\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0\n[1] 10000\n[1] 20000\n[1] 30000\n[1] 40000\n```\n\n\n:::\n:::\n\n\nExplore the data contents:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Find how many rows and columns are in the data pull\nprint(paste0(\"rows: \", nrow(dat), \"; cols: \", ncol(dat)))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"rows: 34839; cols: 27\"\n```\n\n\n:::\n\n```{.r .cell-code}\n# learn about the structure of the data\nsummary(dat)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n      year          srvy              survey          survey_name       \n Min.   :1982   Length:34839       Length:34839       Length:34839      \n 1st Qu.:1997   Class :character   Class :character   Class :character  \n Median :2006   Mode  :character   Mode  :character   Mode  :character  \n Mean   :2006                                                           \n 3rd Qu.:2015                                                           \n Max.   :2025                                                           \n                                                                        \n survey_definition_id     cruise         cruisejoin         hauljoin      \n Min.   : 47.00       Min.   :198201   Min.   :   -777   Min.   : -24955  \n 1st Qu.: 47.00       1st Qu.:199701   1st Qu.:   -700   1st Qu.: -14898  \n Median : 78.00       Median :200601   Median :   -618   Median :  -4846  \n Mean   : 74.77       Mean   :200595   Mean   : 286597   Mean   : 281205  \n 3rd Qu.: 98.00       3rd Qu.:201501   3rd Qu.: 827462   3rd Qu.: 802366  \n Max.   :143.00       Max.   :202502   Max.   :1225395   Max.   :1225635  \n                                                                          \n      haul          stratum        station            vessel_id  \n Min.   :  1.0   Min.   : 10.0   Length:34839       Min.   :  1  \n 1st Qu.: 56.0   1st Qu.: 31.0   Class :character   1st Qu.: 88  \n Median :111.0   Median : 50.0   Mode  :character   Median : 94  \n Mean   :116.6   Mean   :129.4                      Mean   :109  \n 3rd Qu.:169.0   3rd Qu.:141.0                      3rd Qu.:147  \n Max.   :355.0   Max.   :794.0                      Max.   :178  \n                                                                 \n vessel_name         date_time         latitude_dd_start longitude_dd_start\n Length:34839       Length:34839       Min.   :51.19     Min.   :-180.0    \n Class :character   Class :character   1st Qu.:55.02     1st Qu.:-170.7    \n Mode  :character   Mode  :character   Median :57.24     Median :-165.3    \n                                       Mean   :56.90     Mean   :-140.1    \n                                       3rd Qu.:58.98     3rd Qu.:-154.5    \n                                       Max.   :65.34     Max.   : 180.0    \n                                                                           \n latitude_dd_end longitude_dd_end bottom_temperature_c surface_temperature_c\n Min.   :51.19   Min.   :-180.0   Min.   :-2.100       Min.   :-1.100       \n 1st Qu.:55.02   1st Qu.:-170.7   1st Qu.: 2.700       1st Qu.: 5.800       \n Median :57.25   Median :-165.3   Median : 4.100       Median : 7.500       \n Mean   :56.90   Mean   :-140.1   Mean   : 3.843       Mean   : 7.809       \n 3rd Qu.:58.99   3rd Qu.:-154.5   3rd Qu.: 5.200       3rd Qu.: 9.300       \n Max.   :65.35   Max.   : 180.0   Max.   :15.300       Max.   :18.100       \n NA's   :4       NA's   :4        NA's   :1599         NA's   :853          \n    depth_m       distance_fished_km  duration_hr      net_width_m   \n Min.   :   9.0   Min.   :0.135      Min.   :0.0250   Min.   : 7.51  \n 1st Qu.:  68.0   1st Qu.:1.498      1st Qu.:0.2710   1st Qu.:15.58  \n Median : 101.0   Median :2.537      Median :0.4900   Median :16.40  \n Mean   : 136.9   Mean   :2.208      Mean   :0.4009   Mean   :16.43  \n 3rd Qu.: 155.0   3rd Qu.:2.834      3rd Qu.:0.5100   3rd Qu.:17.22  \n Max.   :1200.0   Max.   :4.334      Max.   :0.9800   Max.   :23.82  \n                                                                     \n  net_height_m    area_swept_km2      performance    \n Min.   : 0.000   Min.   :0.002314   Min.   :0.0000  \n 1st Qu.: 2.378   1st Qu.:0.024317   1st Qu.:0.0000  \n Median : 5.816   Median :0.039604   Median :0.0000  \n Mean   : 4.794   Mean   :0.036397   Mean   :0.2782  \n 3rd Qu.: 6.768   3rd Qu.:0.047225   3rd Qu.:0.0000  \n Max.   :11.038   Max.   :0.077795   Max.   :7.0000  \n NA's   :3270                                        \n```\n\n\n:::\n\n```{.r .cell-code}\n# Print the first few lines of the data \ndat |> \n  head(3) |> \n  flextable::flextable() |>\n  flextable::colformat_num(\n      j = c(\"year\", \"cruise\", \"cruisejoin\"), \n      big.mark = \"\") |> \n  flextable::theme_zebra()\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"tabwid\"><style>.cl-f7874c08{}.cl-f772f9e2{font-family:'Arial';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-f772fa00{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-f77afdd6{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-f77afde0{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-f77b47be{width:0.75in;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f77b47d2{width:0.75in;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f77b47dc{width:0.75in;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f77b47e6{width:0.75in;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f77b47fa{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f77b4804{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-f7874c08'><thead><tr style=\"overflow-wrap:break-word;\"><th class=\"cl-f77b47be\"><p class=\"cl-f77afdd6\"><span class=\"cl-f772f9e2\">year</span></p></th><th class=\"cl-f77b47d2\"><p class=\"cl-f77afde0\"><span class=\"cl-f772f9e2\">srvy</span></p></th><th class=\"cl-f77b47d2\"><p class=\"cl-f77afde0\"><span class=\"cl-f772f9e2\">survey</span></p></th><th class=\"cl-f77b47d2\"><p class=\"cl-f77afde0\"><span class=\"cl-f772f9e2\">survey_name</span></p></th><th class=\"cl-f77b47be\"><p class=\"cl-f77afdd6\"><span class=\"cl-f772f9e2\">survey_definition_id</span></p></th><th class=\"cl-f77b47be\"><p class=\"cl-f77afdd6\"><span class=\"cl-f772f9e2\">cruise</span></p></th><th class=\"cl-f77b47be\"><p class=\"cl-f77afdd6\"><span class=\"cl-f772f9e2\">cruisejoin</span></p></th><th class=\"cl-f77b47be\"><p class=\"cl-f77afdd6\"><span class=\"cl-f772f9e2\">hauljoin</span></p></th><th class=\"cl-f77b47be\"><p class=\"cl-f77afdd6\"><span class=\"cl-f772f9e2\">haul</span></p></th><th class=\"cl-f77b47be\"><p class=\"cl-f77afdd6\"><span class=\"cl-f772f9e2\">stratum</span></p></th><th class=\"cl-f77b47d2\"><p class=\"cl-f77afde0\"><span class=\"cl-f772f9e2\">station</span></p></th><th class=\"cl-f77b47be\"><p class=\"cl-f77afdd6\"><span class=\"cl-f772f9e2\">vessel_id</span></p></th><th class=\"cl-f77b47d2\"><p class=\"cl-f77afde0\"><span class=\"cl-f772f9e2\">vessel_name</span></p></th><th class=\"cl-f77b47d2\"><p class=\"cl-f77afde0\"><span class=\"cl-f772f9e2\">date_time</span></p></th><th class=\"cl-f77b47be\"><p class=\"cl-f77afdd6\"><span class=\"cl-f772f9e2\">latitude_dd_start</span></p></th><th class=\"cl-f77b47be\"><p class=\"cl-f77afdd6\"><span class=\"cl-f772f9e2\">longitude_dd_start</span></p></th><th class=\"cl-f77b47be\"><p class=\"cl-f77afdd6\"><span class=\"cl-f772f9e2\">latitude_dd_end</span></p></th><th class=\"cl-f77b47be\"><p class=\"cl-f77afdd6\"><span class=\"cl-f772f9e2\">longitude_dd_end</span></p></th><th class=\"cl-f77b47be\"><p class=\"cl-f77afdd6\"><span class=\"cl-f772f9e2\">bottom_temperature_c</span></p></th><th class=\"cl-f77b47be\"><p class=\"cl-f77afdd6\"><span class=\"cl-f772f9e2\">surface_temperature_c</span></p></th><th class=\"cl-f77b47be\"><p class=\"cl-f77afdd6\"><span class=\"cl-f772f9e2\">depth_m</span></p></th><th class=\"cl-f77b47be\"><p class=\"cl-f77afdd6\"><span class=\"cl-f772f9e2\">distance_fished_km</span></p></th><th class=\"cl-f77b47be\"><p class=\"cl-f77afdd6\"><span class=\"cl-f772f9e2\">duration_hr</span></p></th><th class=\"cl-f77b47be\"><p class=\"cl-f77afdd6\"><span class=\"cl-f772f9e2\">net_width_m</span></p></th><th class=\"cl-f77b47be\"><p class=\"cl-f77afdd6\"><span class=\"cl-f772f9e2\">net_height_m</span></p></th><th class=\"cl-f77b47be\"><p class=\"cl-f77afdd6\"><span class=\"cl-f772f9e2\">area_swept_km2</span></p></th><th class=\"cl-f77b47be\"><p class=\"cl-f77afdd6\"><span class=\"cl-f772f9e2\">performance</span></p></th></tr></thead><tbody><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-f77b47dc\"><p class=\"cl-f77afdd6\"><span class=\"cl-f772fa00\">1989</span></p></td><td class=\"cl-f77b47e6\"><p class=\"cl-f77afde0\"><span class=\"cl-f772fa00\">EBS</span></p></td><td class=\"cl-f77b47e6\"><p class=\"cl-f77afde0\"><span class=\"cl-f772fa00\">eastern Bering Sea</span></p></td><td class=\"cl-f77b47e6\"><p class=\"cl-f77afde0\"><span class=\"cl-f772fa00\">Eastern Bering Sea Crab/Groundfish Bottom Trawl Survey</span></p></td><td class=\"cl-f77b47dc\"><p class=\"cl-f77afdd6\"><span class=\"cl-f772fa00\">98</span></p></td><td class=\"cl-f77b47dc\"><p class=\"cl-f77afdd6\"><span class=\"cl-f772fa00\">198901</span></p></td><td class=\"cl-f77b47dc\"><p class=\"cl-f77afdd6\"><span class=\"cl-f772fa00\">159</span></p></td><td class=\"cl-f77b47dc\"><p class=\"cl-f77afdd6\"><span class=\"cl-f772fa00\">11,795</span></p></td><td class=\"cl-f77b47dc\"><p class=\"cl-f77afdd6\"><span class=\"cl-f772fa00\">153</span></p></td><td class=\"cl-f77b47dc\"><p class=\"cl-f77afdd6\"><span class=\"cl-f772fa00\">61</span></p></td><td class=\"cl-f77b47e6\"><p class=\"cl-f77afde0\"><span class=\"cl-f772fa00\">I-25</span></p></td><td class=\"cl-f77b47dc\"><p class=\"cl-f77afdd6\"><span class=\"cl-f772fa00\">78</span></p></td><td class=\"cl-f77b47e6\"><p class=\"cl-f77afde0\"><span class=\"cl-f772fa00\">OCEAN HOPE 3</span></p></td><td class=\"cl-f77b47e6\"><p class=\"cl-f77afde0\"><span class=\"cl-f772fa00\">1989-07-15T09:00:00Z</span></p></td><td class=\"cl-f77b47dc\"><p class=\"cl-f77afdd6\"><span class=\"cl-f772fa00\">57.65283</span></p></td><td class=\"cl-f77b47dc\"><p class=\"cl-f77afdd6\"><span class=\"cl-f772fa00\">-172.7848</span></p></td><td class=\"cl-f77b47dc\"><p class=\"cl-f77afdd6\"><span class=\"cl-f772fa00\">57.67733</span></p></td><td class=\"cl-f77b47dc\"><p class=\"cl-f77afdd6\"><span class=\"cl-f772fa00\">-172.7922</span></p></td><td class=\"cl-f77b47dc\"><p class=\"cl-f77afdd6\"><span class=\"cl-f772fa00\">3.4</span></p></td><td class=\"cl-f77b47dc\"><p class=\"cl-f77afdd6\"><span class=\"cl-f772fa00\">7.8</span></p></td><td class=\"cl-f77b47dc\"><p class=\"cl-f77afdd6\"><span class=\"cl-f772fa00\">121</span></p></td><td class=\"cl-f77b47dc\"><p class=\"cl-f77afdd6\"><span class=\"cl-f772fa00\">2.759</span></p></td><td class=\"cl-f77b47dc\"><p class=\"cl-f77afdd6\"><span class=\"cl-f772fa00\">0.50</span></p></td><td class=\"cl-f77b47dc\"><p class=\"cl-f77afdd6\"><span class=\"cl-f772fa00\">17.47</span></p></td><td class=\"cl-f77b47dc\"><p class=\"cl-f77afdd6\"><span class=\"cl-f772fa00\"></span></p></td><td class=\"cl-f77b47dc\"><p class=\"cl-f77afdd6\"><span class=\"cl-f772fa00\">0.048200</span></p></td><td class=\"cl-f77b47dc\"><p class=\"cl-f77afdd6\"><span class=\"cl-f772fa00\">0</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-f77b47fa\"><p class=\"cl-f77afdd6\"><span class=\"cl-f772fa00\">1989</span></p></td><td class=\"cl-f77b4804\"><p class=\"cl-f77afde0\"><span class=\"cl-f772fa00\">EBS</span></p></td><td class=\"cl-f77b4804\"><p class=\"cl-f77afde0\"><span class=\"cl-f772fa00\">eastern Bering Sea</span></p></td><td class=\"cl-f77b4804\"><p class=\"cl-f77afde0\"><span class=\"cl-f772fa00\">Eastern Bering Sea Crab/Groundfish Bottom Trawl Survey</span></p></td><td class=\"cl-f77b47fa\"><p class=\"cl-f77afdd6\"><span class=\"cl-f772fa00\">98</span></p></td><td class=\"cl-f77b47fa\"><p class=\"cl-f77afdd6\"><span class=\"cl-f772fa00\">198901</span></p></td><td class=\"cl-f77b47fa\"><p class=\"cl-f77afdd6\"><span class=\"cl-f772fa00\">159</span></p></td><td class=\"cl-f77b47fa\"><p class=\"cl-f77afdd6\"><span class=\"cl-f772fa00\">11,796</span></p></td><td class=\"cl-f77b47fa\"><p class=\"cl-f77afdd6\"><span class=\"cl-f772fa00\">154</span></p></td><td class=\"cl-f77b47fa\"><p class=\"cl-f77afdd6\"><span class=\"cl-f772fa00\">61</span></p></td><td class=\"cl-f77b4804\"><p class=\"cl-f77afde0\"><span class=\"cl-f772fa00\">J-25</span></p></td><td class=\"cl-f77b47fa\"><p class=\"cl-f77afdd6\"><span class=\"cl-f772fa00\">78</span></p></td><td class=\"cl-f77b4804\"><p class=\"cl-f77afde0\"><span class=\"cl-f772fa00\">OCEAN HOPE 3</span></p></td><td class=\"cl-f77b4804\"><p class=\"cl-f77afde0\"><span class=\"cl-f772fa00\">1989-07-15T12:00:00Z</span></p></td><td class=\"cl-f77b47fa\"><p class=\"cl-f77afdd6\"><span class=\"cl-f772fa00\">57.98600</span></p></td><td class=\"cl-f77b47fa\"><p class=\"cl-f77afdd6\"><span class=\"cl-f772fa00\">-172.8603</span></p></td><td class=\"cl-f77b47fa\"><p class=\"cl-f77afdd6\"><span class=\"cl-f772fa00\">58.01000</span></p></td><td class=\"cl-f77b47fa\"><p class=\"cl-f77afdd6\"><span class=\"cl-f772fa00\">-172.8702</span></p></td><td class=\"cl-f77b47fa\"><p class=\"cl-f77afdd6\"><span class=\"cl-f772fa00\">3.1</span></p></td><td class=\"cl-f77b47fa\"><p class=\"cl-f77afdd6\"><span class=\"cl-f772fa00\">8.0</span></p></td><td class=\"cl-f77b47fa\"><p class=\"cl-f77afdd6\"><span class=\"cl-f772fa00\">110</span></p></td><td class=\"cl-f77b47fa\"><p class=\"cl-f77afdd6\"><span class=\"cl-f772fa00\">2.741</span></p></td><td class=\"cl-f77b47fa\"><p class=\"cl-f77afdd6\"><span class=\"cl-f772fa00\">0.50</span></p></td><td class=\"cl-f77b47fa\"><p class=\"cl-f77afdd6\"><span class=\"cl-f772fa00\">17.47</span></p></td><td class=\"cl-f77b47fa\"><p class=\"cl-f77afdd6\"><span class=\"cl-f772fa00\"></span></p></td><td class=\"cl-f77b47fa\"><p class=\"cl-f77afdd6\"><span class=\"cl-f772fa00\">0.047885</span></p></td><td class=\"cl-f77b47fa\"><p class=\"cl-f77afdd6\"><span class=\"cl-f772fa00\">0</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-f77b47dc\"><p class=\"cl-f77afdd6\"><span class=\"cl-f772fa00\">1989</span></p></td><td class=\"cl-f77b47e6\"><p class=\"cl-f77afde0\"><span class=\"cl-f772fa00\">EBS</span></p></td><td class=\"cl-f77b47e6\"><p class=\"cl-f77afde0\"><span class=\"cl-f772fa00\">eastern Bering Sea</span></p></td><td class=\"cl-f77b47e6\"><p class=\"cl-f77afde0\"><span class=\"cl-f772fa00\">Eastern Bering Sea Crab/Groundfish Bottom Trawl Survey</span></p></td><td class=\"cl-f77b47dc\"><p class=\"cl-f77afdd6\"><span class=\"cl-f772fa00\">98</span></p></td><td class=\"cl-f77b47dc\"><p class=\"cl-f77afdd6\"><span class=\"cl-f772fa00\">198901</span></p></td><td class=\"cl-f77b47dc\"><p class=\"cl-f77afdd6\"><span class=\"cl-f772fa00\">159</span></p></td><td class=\"cl-f77b47dc\"><p class=\"cl-f77afdd6\"><span class=\"cl-f772fa00\">11,797</span></p></td><td class=\"cl-f77b47dc\"><p class=\"cl-f77afdd6\"><span class=\"cl-f772fa00\">155</span></p></td><td class=\"cl-f77b47dc\"><p class=\"cl-f77afdd6\"><span class=\"cl-f772fa00\">61</span></p></td><td class=\"cl-f77b47e6\"><p class=\"cl-f77afde0\"><span class=\"cl-f772fa00\">K-25</span></p></td><td class=\"cl-f77b47dc\"><p class=\"cl-f77afdd6\"><span class=\"cl-f772fa00\">78</span></p></td><td class=\"cl-f77b47e6\"><p class=\"cl-f77afde0\"><span class=\"cl-f772fa00\">OCEAN HOPE 3</span></p></td><td class=\"cl-f77b47e6\"><p class=\"cl-f77afde0\"><span class=\"cl-f772fa00\">1989-07-15T14:00:00Z</span></p></td><td class=\"cl-f77b47dc\"><p class=\"cl-f77afdd6\"><span class=\"cl-f772fa00\">58.32133</span></p></td><td class=\"cl-f77b47dc\"><p class=\"cl-f77afdd6\"><span class=\"cl-f772fa00\">-172.9123</span></p></td><td class=\"cl-f77b47dc\"><p class=\"cl-f77afdd6\"><span class=\"cl-f772fa00\">58.33733</span></p></td><td class=\"cl-f77b47dc\"><p class=\"cl-f77afdd6\"><span class=\"cl-f772fa00\">-172.9138</span></p></td><td class=\"cl-f77b47dc\"><p class=\"cl-f77afdd6\"><span class=\"cl-f772fa00\">3.1</span></p></td><td class=\"cl-f77b47dc\"><p class=\"cl-f77afdd6\"><span class=\"cl-f772fa00\">8.4</span></p></td><td class=\"cl-f77b47dc\"><p class=\"cl-f77afdd6\"><span class=\"cl-f772fa00\">110</span></p></td><td class=\"cl-f77b47dc\"><p class=\"cl-f77afdd6\"><span class=\"cl-f772fa00\">1.796</span></p></td><td class=\"cl-f77b47dc\"><p class=\"cl-f77afdd6\"><span class=\"cl-f772fa00\">0.33</span></p></td><td class=\"cl-f77b47dc\"><p class=\"cl-f77afdd6\"><span class=\"cl-f772fa00\">17.47</span></p></td><td class=\"cl-f77b47dc\"><p class=\"cl-f77afdd6\"><span class=\"cl-f772fa00\"></span></p></td><td class=\"cl-f77b47dc\"><p class=\"cl-f77afdd6\"><span class=\"cl-f772fa00\">0.031376</span></p></td><td class=\"cl-f77b47dc\"><p class=\"cl-f77afdd6\"><span class=\"cl-f772fa00\">0</span></p></td></tr></tbody></table></div>\n```\n\n:::\n\n```{.r .cell-code}\n# save outputs for later comparison\ndat_haul_api <- dat\n```\n:::\n\n\n### Load catch data\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# link to the API\napi_link_catch <- 'https://apps-st.fisheries.noaa.gov/ods/foss/afsc_groundfish_survey_catch/'\n```\n:::\n\n\n\n::: {.cell inlcude='false'}\n\n:::\n\n\n#### Load first 25 rows of data\n\n\n::: {.cell}\n\n```{.r .cell-code}\nres <- httr::GET(url = api_link_catch)\n# res ## Test connection\n\n## convert from JSON format\ndat <- jsonlite::fromJSON(base::rawToChar(res$content))$items\n\n# Find how many rows and columns are in the data pull\nprint(paste0(\"rows: \", nrow(dat), \"; cols: \", ncol(dat)))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"rows: 25; cols: 8\"\n```\n\n\n:::\n:::\n\n\n#### Load all data\n\nSince the maxim number of rows a user can pull is 10,000 rows in a query, the user needs to cycle through by `offsetting` to the next 10,000 rows (as is shown here). \n\n\n::: {.cell}\n\n```{.r .cell-code}\ndat <- data.frame()\n# for (i in seq(0, 100000, 10000)){\nfor (i in seq(0, 1000000, 10000)){\n  ## find how many iterations it takes to cycle through the data\n  # print(i)\n  ## query the API link\n  res <- httr::GET(url = paste0(api_link_catch, \"?offset=\",i,\"&limit=10000\"))\n  ## convert from JSON format\n  data <- jsonlite::fromJSON(base::rawToChar(res$content)) \n  \n  ## if there are no data, stop the loop\n  if (is.null(nrow(data$items))) {\n    break\n  }\n  \n  ## bind sub-pull to dat data.frame\n  dat <- dplyr::bind_rows(dat, \n                          data$items |>\n                            dplyr::select(-links)) # necessary for API accounting, but not part of the dataset)\n}\n```\n:::\n\n\nExplore the data contents:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Find how many rows and columns are in the data pull\nprint(paste0(\"rows: \", nrow(dat), \"; cols: \", ncol(dat)))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"rows: 917401; cols: 7\"\n```\n\n\n:::\n\n```{.r .cell-code}\n# learn about the structure of the data\nsummary(dat)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n    hauljoin        species_code     cpue_kgkm2          cpue_nokm2        \n Min.   : -24955   Min.   :    1   Min.   :      0.0   Min.   :      12.9  \n 1st Qu.: -15284   1st Qu.:20510   1st Qu.:      5.6   1st Qu.:      58.5  \n Median :  -5742   Median :40500   Median :     48.9   Median :     214.8  \n Mean   : 271952   Mean   :45282   Mean   :   1236.9   Mean   :    4613.4  \n 3rd Qu.: 802106   3rd Qu.:71890   3rd Qu.:    371.8   3rd Qu.:    1146.5  \n Max.   :1225635   Max.   :99999   Max.   :3226234.7   Max.   :21780780.3  \n                                                       NA's   :91873       \n     count            weight_kg         taxon_confidence  \n Min.   :     1.0   Min.   :    0.001   Length:917401     \n 1st Qu.:     2.0   1st Qu.:    0.200   Class :character  \n Median :     8.0   Median :    1.814   Mode  :character  \n Mean   :   181.2   Mean   :   41.359                     \n 3rd Qu.:    43.0   3rd Qu.:   13.800                     \n Max.   :867119.0   Max.   :18187.700                     \n NA's   :91873                                            \n```\n\n\n:::\n\n```{.r .cell-code}\n# Print the first few lines of the data \ndat |> \n  head(3) |> \n  flextable::flextable() |>\n  flextable::colformat_num(\n      j = c(\"species_code\"), \n      big.mark = \"\") |> \n  flextable::theme_zebra()\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"tabwid\"><style>.cl-aeda3c8a{}.cl-aec8b172{font-family:'Arial';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-aec8b186{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-aecfbda0{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-aecfbdb4{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-aed00116{width:0.75in;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-aed00120{width:0.75in;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-aed00134{width:0.75in;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-aed00135{width:0.75in;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-aed0013e{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-aed0013f{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-aeda3c8a'><thead><tr style=\"overflow-wrap:break-word;\"><th class=\"cl-aed00116\"><p class=\"cl-aecfbda0\"><span class=\"cl-aec8b172\">hauljoin</span></p></th><th class=\"cl-aed00116\"><p class=\"cl-aecfbda0\"><span class=\"cl-aec8b172\">species_code</span></p></th><th class=\"cl-aed00116\"><p class=\"cl-aecfbda0\"><span class=\"cl-aec8b172\">cpue_kgkm2</span></p></th><th class=\"cl-aed00116\"><p class=\"cl-aecfbda0\"><span class=\"cl-aec8b172\">cpue_nokm2</span></p></th><th class=\"cl-aed00116\"><p class=\"cl-aecfbda0\"><span class=\"cl-aec8b172\">count</span></p></th><th class=\"cl-aed00116\"><p class=\"cl-aecfbda0\"><span class=\"cl-aec8b172\">weight_kg</span></p></th><th class=\"cl-aed00120\"><p class=\"cl-aecfbdb4\"><span class=\"cl-aec8b172\">taxon_confidence</span></p></th></tr></thead><tbody><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-aed00134\"><p class=\"cl-aecfbda0\"><span class=\"cl-aec8b186\">-24,470</span></p></td><td class=\"cl-aed00134\"><p class=\"cl-aecfbda0\"><span class=\"cl-aec8b186\">68578</span></p></td><td class=\"cl-aed00134\"><p class=\"cl-aecfbda0\"><span class=\"cl-aec8b186\">84.5611</span></p></td><td class=\"cl-aed00134\"><p class=\"cl-aecfbda0\"><span class=\"cl-aec8b186\">1,297.341</span></p></td><td class=\"cl-aed00134\"><p class=\"cl-aecfbda0\"><span class=\"cl-aec8b186\">61</span></p></td><td class=\"cl-aed00134\"><p class=\"cl-aecfbda0\"><span class=\"cl-aec8b186\">3.976</span></p></td><td class=\"cl-aed00135\"><p class=\"cl-aecfbdb4\"><span class=\"cl-aec8b186\"></span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-aed0013e\"><p class=\"cl-aecfbda0\"><span class=\"cl-aec8b186\">-24,470</span></p></td><td class=\"cl-aed0013e\"><p class=\"cl-aecfbda0\"><span class=\"cl-aec8b186\">68580</span></p></td><td class=\"cl-aed0013e\"><p class=\"cl-aecfbda0\"><span class=\"cl-aec8b186\">2,703.0414</span></p></td><td class=\"cl-aed0013e\"><p class=\"cl-aecfbda0\"><span class=\"cl-aec8b186\">24,798.350</span></p></td><td class=\"cl-aed0013e\"><p class=\"cl-aecfbda0\"><span class=\"cl-aec8b186\">1,166</span></p></td><td class=\"cl-aed0013e\"><p class=\"cl-aecfbda0\"><span class=\"cl-aec8b186\">127.095</span></p></td><td class=\"cl-aed0013f\"><p class=\"cl-aecfbdb4\"><span class=\"cl-aec8b186\"></span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-aed00134\"><p class=\"cl-aecfbda0\"><span class=\"cl-aec8b186\">-24,470</span></p></td><td class=\"cl-aed00134\"><p class=\"cl-aecfbda0\"><span class=\"cl-aec8b186\">68590</span></p></td><td class=\"cl-aed00134\"><p class=\"cl-aecfbda0\"><span class=\"cl-aec8b186\">348.6019</span></p></td><td class=\"cl-aed00134\"><p class=\"cl-aecfbda0\"><span class=\"cl-aec8b186\">3,062.575</span></p></td><td class=\"cl-aed00134\"><p class=\"cl-aecfbda0\"><span class=\"cl-aec8b186\">144</span></p></td><td class=\"cl-aed00134\"><p class=\"cl-aecfbda0\"><span class=\"cl-aec8b186\">16.391</span></p></td><td class=\"cl-aed00135\"><p class=\"cl-aecfbdb4\"><span class=\"cl-aec8b186\"></span></p></td></tr></tbody></table></div>\n```\n\n:::\n\n```{.r .cell-code}\n# save outputs for later comparison\ndat_catch_api <- dat\n```\n:::\n\n\n### Load species data\n\nSince there are less than 10,000 rows of species data (and the maxim number of rows a user can pull from this API is 10,000 rows in a query), we can simply call `?offset=0&limit=10000` in our query call. \n\n\n::: {.cell}\n\n```{.r .cell-code}\n# link to the API\napi_link_species <- 'https://apps-st.fisheries.noaa.gov/ods/foss/afsc_groundfish_survey_species/'\n```\n:::\n\n\n\n::: {.cell inlcude='false'}\n\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nres <- httr::GET(url = paste0(api_link_species, \"?offset=0&limit=10000\"))\n\n## convert from JSON format\ndata <- jsonlite::fromJSON(base::rawToChar(res$content))\ndat <- data$items  |>\n  dplyr::select(-links) # necessary for API accounting, but not part of the dataset\n```\n:::\n\n\nExplore the data contents:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Find how many rows and columns are in the data pull\nprint(paste0(\"rows: \", nrow(dat), \"; cols: \", ncol(dat)))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"rows: 1014; cols: 6\"\n```\n\n\n:::\n\n```{.r .cell-code}\n# learn about the structure of the data\nsummary(dat)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  species_code   scientific_name    common_name          id_rank         \n Min.   :    1   Length:1014        Length:1014        Length:1014       \n 1st Qu.:22177   Class :character   Class :character   Class :character  \n Median :66868   Mode  :character   Mode  :character   Mode  :character  \n Mean   :50653                                                           \n 3rd Qu.:75077                                                           \n Max.   :99999                                                           \n                                                                         \n     worms              itis        \n Min.   :     51   Min.   :  46861  \n 1st Qu.: 127206   1st Qu.:  97781  \n Median : 254573   Median : 162045  \n Mean   : 293224   Mean   : 217907  \n 3rd Qu.: 342060   3rd Qu.: 167487  \n Max.   :1699296   Max.   :1206057  \n NA's   :82        NA's   :132      \n```\n\n\n:::\n\n```{.r .cell-code}\n# Print the first few lines of the data \ndat |> \n  head(3) |> \n  flextable::flextable() |>\n  flextable::colformat_num(\n      j = c(\"species_code\", \"worms\", \"itis\"), # \n      big.mark = \"\") |> \n  flextable::theme_zebra()\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"tabwid\"><style>.cl-af77f948{}.cl-af671b78{font-family:'Arial';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-af671b8c{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-af6dca4a{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-af6dca54{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-af6e07e4{width:0.75in;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-af6e07ee{width:0.75in;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-af6e07f8{width:0.75in;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-af6e0802{width:0.75in;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-af6e080c{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-af6e080d{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-af77f948'><thead><tr style=\"overflow-wrap:break-word;\"><th class=\"cl-af6e07e4\"><p class=\"cl-af6dca4a\"><span class=\"cl-af671b78\">species_code</span></p></th><th class=\"cl-af6e07ee\"><p class=\"cl-af6dca54\"><span class=\"cl-af671b78\">scientific_name</span></p></th><th class=\"cl-af6e07ee\"><p class=\"cl-af6dca54\"><span class=\"cl-af671b78\">common_name</span></p></th><th class=\"cl-af6e07ee\"><p class=\"cl-af6dca54\"><span class=\"cl-af671b78\">id_rank</span></p></th><th class=\"cl-af6e07e4\"><p class=\"cl-af6dca4a\"><span class=\"cl-af671b78\">worms</span></p></th><th class=\"cl-af6e07e4\"><p class=\"cl-af6dca4a\"><span class=\"cl-af671b78\">itis</span></p></th></tr></thead><tbody><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-af6e07f8\"><p class=\"cl-af6dca4a\"><span class=\"cl-af671b8c\">1</span></p></td><td class=\"cl-af6e0802\"><p class=\"cl-af6dca54\"><span class=\"cl-af671b8c\"></span></p></td><td class=\"cl-af6e0802\"><p class=\"cl-af6dca54\"><span class=\"cl-af671b8c\">fish egg unid.</span></p></td><td class=\"cl-af6e0802\"><p class=\"cl-af6dca54\"><span class=\"cl-af671b8c\"></span></p></td><td class=\"cl-af6e07f8\"><p class=\"cl-af6dca4a\"><span class=\"cl-af671b8c\"></span></p></td><td class=\"cl-af6e07f8\"><p class=\"cl-af6dca4a\"><span class=\"cl-af671b8c\"></span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-af6e080c\"><p class=\"cl-af6dca4a\"><span class=\"cl-af671b8c\">2</span></p></td><td class=\"cl-af6e080d\"><p class=\"cl-af6dca54\"><span class=\"cl-af671b8c\"></span></p></td><td class=\"cl-af6e080d\"><p class=\"cl-af6dca54\"><span class=\"cl-af671b8c\">fish larvae unid.</span></p></td><td class=\"cl-af6e080d\"><p class=\"cl-af6dca54\"><span class=\"cl-af671b8c\"></span></p></td><td class=\"cl-af6e080c\"><p class=\"cl-af6dca4a\"><span class=\"cl-af671b8c\"></span></p></td><td class=\"cl-af6e080c\"><p class=\"cl-af6dca4a\"><span class=\"cl-af671b8c\"></span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-af6e07f8\"><p class=\"cl-af6dca4a\"><span class=\"cl-af671b8c\">3</span></p></td><td class=\"cl-af6e0802\"><p class=\"cl-af6dca54\"><span class=\"cl-af671b8c\"></span></p></td><td class=\"cl-af6e0802\"><p class=\"cl-af6dca54\"><span class=\"cl-af671b8c\">fish unid.</span></p></td><td class=\"cl-af6e0802\"><p class=\"cl-af6dca54\"><span class=\"cl-af671b8c\"></span></p></td><td class=\"cl-af6e07f8\"><p class=\"cl-af6dca4a\"><span class=\"cl-af671b8c\"></span></p></td><td class=\"cl-af6e07f8\"><p class=\"cl-af6dca4a\"><span class=\"cl-af671b8c\"></span></p></td></tr></tbody></table></div>\n```\n\n:::\n\n```{.r .cell-code}\n# save outputs for later comparison\ndat_species_api <- dat\n```\n:::\n\n\n## Ex. Create zero-filled data using data loaded in last example\n\nIt is important to create and have access to zero-fill (presence and absence) so you can do simple analyses and plot data. \n\nFirst prepare a table with all combinations of what species should be listed for what hauls/surveys. For zero-filled data, all species caught in a survey need to have zero or non-zero row entries for a haul\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncomb <- dplyr::full_join(\n  # find all species that have been caught, by survey\n  x = dplyr::left_join(dat_catch_api, dat_haul_api, by = \"hauljoin\") |>\n    dplyr::select(survey_definition_id, species_code) |>\n    dplyr::distinct(),\n  # find all haul events (hauljoins), by survey\n  y = dat_haul_api |>\n    dplyr::select(survey_definition_id, hauljoin) |>\n    dplyr::distinct(),\n  relationship = \"many-to-many\",\n  by = \"survey_definition_id\"\n) |> \n  dplyr::select(-survey_definition_id) # now, redundant\n```\n:::\n\n\nExplore the data contents:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nprint(paste0(\"rows: \", nrow(comb), \"; cols: \", ncol(comb)))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"rows: 22070179; cols: 2\"\n```\n\n\n:::\n\n```{.r .cell-code}\ncomb |> head(3) |> \n  flextable::flextable()  |>\n  flextable::colformat_num(\n      j = c(\"species_code\", \"hauljoin\"), \n      big.mark = \"\") |> \n  flextable::theme_zebra()\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"tabwid\"><style>.cl-b1100336{}.cl-b0ff9992{font-family:'Arial';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-b0ff99b0{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-b1063b8a{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-b1067aa0{width:0.75in;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b1067ab4{width:0.75in;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-b1067ab5{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-b1100336'><thead><tr style=\"overflow-wrap:break-word;\"><th class=\"cl-b1067aa0\"><p class=\"cl-b1063b8a\"><span class=\"cl-b0ff9992\">species_code</span></p></th><th class=\"cl-b1067aa0\"><p class=\"cl-b1063b8a\"><span class=\"cl-b0ff9992\">hauljoin</span></p></th></tr></thead><tbody><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-b1067ab4\"><p class=\"cl-b1063b8a\"><span class=\"cl-b0ff99b0\">68578</span></p></td><td class=\"cl-b1067ab4\"><p class=\"cl-b1063b8a\"><span class=\"cl-b0ff99b0\">11795</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-b1067ab5\"><p class=\"cl-b1063b8a\"><span class=\"cl-b0ff99b0\">68578</span></p></td><td class=\"cl-b1067ab5\"><p class=\"cl-b1063b8a\"><span class=\"cl-b0ff99b0\">11796</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-b1067ab4\"><p class=\"cl-b1063b8a\"><span class=\"cl-b0ff99b0\">68578</span></p></td><td class=\"cl-b1067ab4\"><p class=\"cl-b1063b8a\"><span class=\"cl-b0ff99b0\">11797</span></p></td></tr></tbody></table></div>\n```\n\n:::\n:::\n\n\nNow, using that table of combinations (here, called `comb`), join data to make a full zero-filled CPUE dataset. When all of the data have been full joined together, there should be the maximum number of rows in `comb`. \n\n\n::: {.cell}\n\n```{.r .cell-code}\ndat <- comb |>\n  # add species data\n  dplyr::left_join(dat_species_api) |> # , \"species_code\"\n  # add haul data\n  dplyr::left_join(dat_haul_api) |> # , c(\"hauljoin\")\n  # add catch data\n  dplyr::left_join(dat_catch_api) |> # , c(\"species_code\", \"hauljoin\")\n  # modify/clean up zero-filled rows\n  dplyr::mutate(\n    cpue_kgkm2 = ifelse(is.na(cpue_kgkm2), 0, cpue_kgkm2),\n    cpue_nokm2 = ifelse(is.na(cpue_nokm2), 0, cpue_nokm2),\n    count = ifelse(is.na(count), 0, count),\n    weight_kg = ifelse(is.na(weight_kg), 0, weight_kg))\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nTRUE Joining with `by = join_by(species_code)`\nTRUE Joining with `by = join_by(hauljoin)`\nTRUE Joining with `by = join_by(species_code, hauljoin)`\n```\n\n\n:::\n:::\n\n\nExplore the data contents:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Find how many rows and columns are in the data pull\nprint(paste0(\"rows: \", nrow(dat), \"; cols: \", ncol(dat)))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"rows: 22070179; cols: 38\"\n```\n\n\n:::\n\n```{.r .cell-code}\n# learn about the structure of the data\nsummary(dat)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  species_code      hauljoin       scientific_name    common_name       \n Min.   :    1   Min.   : -24955   Length:22070179    Length:22070179   \n 1st Qu.:21800   1st Qu.: -14713   Class :character   Class :character  \n Median :66770   Median :  -5025   Mode  :character   Mode  :character  \n Mean   :50356   Mean   : 289418                                        \n 3rd Qu.:74983   3rd Qu.: 816069                                        \n Max.   :99999   Max.   :1225635                                        \n                                                                        \n   id_rank              worms              itis              year     \n Length:22070179    Min.   :     51   Min.   :  46861   Min.   :1982  \n Class :character   1st Qu.: 126737   1st Qu.:  97160   1st Qu.:1997  \n Mode  :character   Median : 254508   Median : 160846   Median :2007  \n                    Mean   : 266901   Mean   : 202211   Mean   :2006  \n                    3rd Qu.: 291581   3rd Qu.: 167452   3rd Qu.:2015  \n                    Max.   :1699296   Max.   :1206057   Max.   :2025  \n                    NA's   :1614127   NA's   :2538236                 \n     srvy              survey          survey_name        survey_definition_id\n Length:22070179    Length:22070179    Length:22070179    Min.   : 47.0       \n Class :character   Class :character   Class :character   1st Qu.: 47.0       \n Mode  :character   Mode  :character   Mode  :character   Median : 52.0       \n                                                          Mean   : 69.1       \n                                                          3rd Qu.: 98.0       \n                                                          Max.   :143.0       \n                                                                              \n     cruise         cruisejoin           haul        stratum     \n Min.   :198201   Min.   :   -777   Min.   :  1   Min.   : 10.0  \n 1st Qu.:199701   1st Qu.:   -700   1st Qu.: 59   1st Qu.: 31.0  \n Median :200701   Median :   -623   Median :116   Median : 61.0  \n Mean   :200607   Mean   : 294711   Mean   :122   Mean   :140.5  \n 3rd Qu.:201501   3rd Qu.: 837799   3rd Qu.:176   3rd Qu.:211.0  \n Max.   :202502   Max.   :1225395   Max.   :355   Max.   :794.0  \n                                                                 \n   station            vessel_id     vessel_name         date_time        \n Length:22070179    Min.   :  1.0   Length:22070179    Length:22070179   \n Class :character   1st Qu.: 88.0   Class :character   Class :character  \n Mode  :character   Median : 94.0   Mode  :character   Mode  :character  \n                    Mean   :111.2                                        \n                    3rd Qu.:148.0                                        \n                    Max.   :178.0                                        \n                                                                         \n latitude_dd_start longitude_dd_start latitude_dd_end longitude_dd_end\n Min.   :51.19     Min.   :-180.0     Min.   :51.19   Min.   :-180.0  \n 1st Qu.:54.73     1st Qu.:-169.9     1st Qu.:54.73   1st Qu.:-169.9  \n Median :56.99     Median :-163.4     Median :56.99   Median :-163.4  \n Mean   :56.65     Mean   :-137.1     Mean   :56.65   Mean   :-137.1  \n 3rd Qu.:58.68     3rd Qu.:-152.1     3rd Qu.:58.68   3rd Qu.:-152.1  \n Max.   :65.34     Max.   : 180.0     Max.   :65.35   Max.   : 180.0  \n                                      NA's   :2251    NA's   :2251    \n bottom_temperature_c surface_temperature_c    depth_m       distance_fished_km\n Min.   :-2.10        Min.   :-1.10         Min.   :   9.0   Min.   :0.135     \n 1st Qu.: 3.10        1st Qu.: 5.90         1st Qu.:  71.0   1st Qu.:1.481     \n Median : 4.30        Median : 7.60         Median : 109.0   Median :1.675     \n Mean   : 4.12        Mean   : 8.06         Mean   : 141.3   Mean   :2.096     \n 3rd Qu.: 5.40        3rd Qu.: 9.70         3rd Qu.: 166.0   3rd Qu.:2.804     \n Max.   :15.30        Max.   :18.10         Max.   :1200.0   Max.   :4.334     \n NA's   :1094226      NA's   :593432                                           \n  duration_hr     net_width_m     net_height_m     area_swept_km2    \n Min.   :0.025   Min.   : 7.51   Min.   : 0.00     Min.   :0.002314  \n 1st Qu.:0.269   1st Qu.:15.54   1st Qu.: 2.58     1st Qu.:0.023848  \n Median :0.305   Median :16.34   Median : 6.17     Median :0.028048  \n Mean   :0.380   Mean   :16.38   Mean   : 5.18     Mean   :0.034451  \n 3rd Qu.:0.500   3rd Qu.:17.16   3rd Qu.: 6.88     3rd Qu.:0.046246  \n Max.   :0.980   Max.   :23.82   Max.   :11.04     Max.   :0.077795  \n                                 NA's   :1723925                     \n  performance       cpue_kgkm2          cpue_nokm2             count          \n Min.   :0.0000   Min.   :      0.0   Min.   :       0.0   Min.   :     0.00  \n 1st Qu.:0.0000   1st Qu.:      0.0   1st Qu.:       0.0   1st Qu.:     0.00  \n Median :0.0000   Median :      0.0   Median :       0.0   Median :     0.00  \n Mean   :0.2917   Mean   :     51.4   Mean   :     172.6   Mean   :     6.78  \n 3rd Qu.:0.0000   3rd Qu.:      0.0   3rd Qu.:       0.0   3rd Qu.:     0.00  \n Max.   :7.0000   Max.   :3226234.7   Max.   :21780780.3   Max.   :867119.00  \n                                                                              \n   weight_kg         taxon_confidence  \n Min.   :    0.000   Length:22070179   \n 1st Qu.:    0.000   Class :character  \n Median :    0.000   Mode  :character  \n Mean   :    1.719                     \n 3rd Qu.:    0.000                     \n Max.   :18187.700                     \n                                       \n```\n\n\n:::\n\n```{.r .cell-code}\n# Print the first few lines of the data \ndat |> \n  head(3) |> \n  flextable::flextable() |>\n  flextable::colformat_num(\n      j = c(\"species_code\", \"hauljoin\", \"year\", \"cruise\", \"cruisejoin\", \"worms\", \"itis\"), #\n      big.mark = \"\") |> \n  flextable::theme_zebra()\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"tabwid\"><style>.cl-dbc3ea20{}.cl-dbb0b73e{font-family:'Arial';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-dbb0b752{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-dbb816c8{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-dbb816dc{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-dbb858ae{width:0.75in;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dbb858c2{width:0.75in;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dbb858c3{width:0.75in;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dbb858cc{width:0.75in;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dbb858cd{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dbb858d6{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-dbc3ea20'><thead><tr style=\"overflow-wrap:break-word;\"><th class=\"cl-dbb858ae\"><p class=\"cl-dbb816c8\"><span class=\"cl-dbb0b73e\">species_code</span></p></th><th class=\"cl-dbb858ae\"><p class=\"cl-dbb816c8\"><span class=\"cl-dbb0b73e\">hauljoin</span></p></th><th class=\"cl-dbb858c2\"><p class=\"cl-dbb816dc\"><span class=\"cl-dbb0b73e\">scientific_name</span></p></th><th class=\"cl-dbb858c2\"><p class=\"cl-dbb816dc\"><span class=\"cl-dbb0b73e\">common_name</span></p></th><th class=\"cl-dbb858c2\"><p class=\"cl-dbb816dc\"><span class=\"cl-dbb0b73e\">id_rank</span></p></th><th class=\"cl-dbb858ae\"><p class=\"cl-dbb816c8\"><span class=\"cl-dbb0b73e\">worms</span></p></th><th class=\"cl-dbb858ae\"><p class=\"cl-dbb816c8\"><span class=\"cl-dbb0b73e\">itis</span></p></th><th class=\"cl-dbb858ae\"><p class=\"cl-dbb816c8\"><span class=\"cl-dbb0b73e\">year</span></p></th><th class=\"cl-dbb858c2\"><p class=\"cl-dbb816dc\"><span class=\"cl-dbb0b73e\">srvy</span></p></th><th class=\"cl-dbb858c2\"><p class=\"cl-dbb816dc\"><span class=\"cl-dbb0b73e\">survey</span></p></th><th class=\"cl-dbb858c2\"><p class=\"cl-dbb816dc\"><span class=\"cl-dbb0b73e\">survey_name</span></p></th><th class=\"cl-dbb858ae\"><p class=\"cl-dbb816c8\"><span class=\"cl-dbb0b73e\">survey_definition_id</span></p></th><th class=\"cl-dbb858ae\"><p class=\"cl-dbb816c8\"><span class=\"cl-dbb0b73e\">cruise</span></p></th><th class=\"cl-dbb858ae\"><p class=\"cl-dbb816c8\"><span class=\"cl-dbb0b73e\">cruisejoin</span></p></th><th class=\"cl-dbb858ae\"><p class=\"cl-dbb816c8\"><span class=\"cl-dbb0b73e\">haul</span></p></th><th class=\"cl-dbb858ae\"><p class=\"cl-dbb816c8\"><span class=\"cl-dbb0b73e\">stratum</span></p></th><th class=\"cl-dbb858c2\"><p class=\"cl-dbb816dc\"><span class=\"cl-dbb0b73e\">station</span></p></th><th class=\"cl-dbb858ae\"><p class=\"cl-dbb816c8\"><span class=\"cl-dbb0b73e\">vessel_id</span></p></th><th class=\"cl-dbb858c2\"><p class=\"cl-dbb816dc\"><span class=\"cl-dbb0b73e\">vessel_name</span></p></th><th class=\"cl-dbb858c2\"><p class=\"cl-dbb816dc\"><span class=\"cl-dbb0b73e\">date_time</span></p></th><th class=\"cl-dbb858ae\"><p class=\"cl-dbb816c8\"><span class=\"cl-dbb0b73e\">latitude_dd_start</span></p></th><th class=\"cl-dbb858ae\"><p class=\"cl-dbb816c8\"><span class=\"cl-dbb0b73e\">longitude_dd_start</span></p></th><th class=\"cl-dbb858ae\"><p class=\"cl-dbb816c8\"><span class=\"cl-dbb0b73e\">latitude_dd_end</span></p></th><th class=\"cl-dbb858ae\"><p class=\"cl-dbb816c8\"><span class=\"cl-dbb0b73e\">longitude_dd_end</span></p></th><th class=\"cl-dbb858ae\"><p class=\"cl-dbb816c8\"><span class=\"cl-dbb0b73e\">bottom_temperature_c</span></p></th><th class=\"cl-dbb858ae\"><p class=\"cl-dbb816c8\"><span class=\"cl-dbb0b73e\">surface_temperature_c</span></p></th><th class=\"cl-dbb858ae\"><p class=\"cl-dbb816c8\"><span class=\"cl-dbb0b73e\">depth_m</span></p></th><th class=\"cl-dbb858ae\"><p class=\"cl-dbb816c8\"><span class=\"cl-dbb0b73e\">distance_fished_km</span></p></th><th class=\"cl-dbb858ae\"><p class=\"cl-dbb816c8\"><span class=\"cl-dbb0b73e\">duration_hr</span></p></th><th class=\"cl-dbb858ae\"><p class=\"cl-dbb816c8\"><span class=\"cl-dbb0b73e\">net_width_m</span></p></th><th class=\"cl-dbb858ae\"><p class=\"cl-dbb816c8\"><span class=\"cl-dbb0b73e\">net_height_m</span></p></th><th class=\"cl-dbb858ae\"><p class=\"cl-dbb816c8\"><span class=\"cl-dbb0b73e\">area_swept_km2</span></p></th><th class=\"cl-dbb858ae\"><p class=\"cl-dbb816c8\"><span class=\"cl-dbb0b73e\">performance</span></p></th><th class=\"cl-dbb858ae\"><p class=\"cl-dbb816c8\"><span class=\"cl-dbb0b73e\">cpue_kgkm2</span></p></th><th class=\"cl-dbb858ae\"><p class=\"cl-dbb816c8\"><span class=\"cl-dbb0b73e\">cpue_nokm2</span></p></th><th class=\"cl-dbb858ae\"><p class=\"cl-dbb816c8\"><span class=\"cl-dbb0b73e\">count</span></p></th><th class=\"cl-dbb858ae\"><p class=\"cl-dbb816c8\"><span class=\"cl-dbb0b73e\">weight_kg</span></p></th><th class=\"cl-dbb858c2\"><p class=\"cl-dbb816dc\"><span class=\"cl-dbb0b73e\">taxon_confidence</span></p></th></tr></thead><tbody><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-dbb858c3\"><p class=\"cl-dbb816c8\"><span class=\"cl-dbb0b752\">68578</span></p></td><td class=\"cl-dbb858c3\"><p class=\"cl-dbb816c8\"><span class=\"cl-dbb0b752\">11795</span></p></td><td class=\"cl-dbb858cc\"><p class=\"cl-dbb816dc\"><span class=\"cl-dbb0b752\">Hyas lyratus</span></p></td><td class=\"cl-dbb858cc\"><p class=\"cl-dbb816dc\"><span class=\"cl-dbb0b752\">Pacific lyre crab</span></p></td><td class=\"cl-dbb858cc\"><p class=\"cl-dbb816dc\"><span class=\"cl-dbb0b752\">species</span></p></td><td class=\"cl-dbb858c3\"><p class=\"cl-dbb816c8\"><span class=\"cl-dbb0b752\">442167</span></p></td><td class=\"cl-dbb858c3\"><p class=\"cl-dbb816c8\"><span class=\"cl-dbb0b752\">98422</span></p></td><td class=\"cl-dbb858c3\"><p class=\"cl-dbb816c8\"><span class=\"cl-dbb0b752\">1989</span></p></td><td class=\"cl-dbb858cc\"><p class=\"cl-dbb816dc\"><span class=\"cl-dbb0b752\">EBS</span></p></td><td class=\"cl-dbb858cc\"><p class=\"cl-dbb816dc\"><span class=\"cl-dbb0b752\">eastern Bering Sea</span></p></td><td class=\"cl-dbb858cc\"><p class=\"cl-dbb816dc\"><span class=\"cl-dbb0b752\">Eastern Bering Sea Crab/Groundfish Bottom Trawl Survey</span></p></td><td class=\"cl-dbb858c3\"><p class=\"cl-dbb816c8\"><span class=\"cl-dbb0b752\">98</span></p></td><td class=\"cl-dbb858c3\"><p class=\"cl-dbb816c8\"><span class=\"cl-dbb0b752\">198901</span></p></td><td class=\"cl-dbb858c3\"><p class=\"cl-dbb816c8\"><span class=\"cl-dbb0b752\">159</span></p></td><td class=\"cl-dbb858c3\"><p class=\"cl-dbb816c8\"><span class=\"cl-dbb0b752\">153</span></p></td><td class=\"cl-dbb858c3\"><p class=\"cl-dbb816c8\"><span class=\"cl-dbb0b752\">61</span></p></td><td class=\"cl-dbb858cc\"><p class=\"cl-dbb816dc\"><span class=\"cl-dbb0b752\">I-25</span></p></td><td class=\"cl-dbb858c3\"><p class=\"cl-dbb816c8\"><span class=\"cl-dbb0b752\">78</span></p></td><td class=\"cl-dbb858cc\"><p class=\"cl-dbb816dc\"><span class=\"cl-dbb0b752\">OCEAN HOPE 3</span></p></td><td class=\"cl-dbb858cc\"><p class=\"cl-dbb816dc\"><span class=\"cl-dbb0b752\">1989-07-15T09:00:00Z</span></p></td><td class=\"cl-dbb858c3\"><p class=\"cl-dbb816c8\"><span class=\"cl-dbb0b752\">57.65283</span></p></td><td class=\"cl-dbb858c3\"><p class=\"cl-dbb816c8\"><span class=\"cl-dbb0b752\">-172.7848</span></p></td><td class=\"cl-dbb858c3\"><p class=\"cl-dbb816c8\"><span class=\"cl-dbb0b752\">57.67733</span></p></td><td class=\"cl-dbb858c3\"><p class=\"cl-dbb816c8\"><span class=\"cl-dbb0b752\">-172.7922</span></p></td><td class=\"cl-dbb858c3\"><p class=\"cl-dbb816c8\"><span class=\"cl-dbb0b752\">3.4</span></p></td><td class=\"cl-dbb858c3\"><p class=\"cl-dbb816c8\"><span class=\"cl-dbb0b752\">7.8</span></p></td><td class=\"cl-dbb858c3\"><p class=\"cl-dbb816c8\"><span class=\"cl-dbb0b752\">121</span></p></td><td class=\"cl-dbb858c3\"><p class=\"cl-dbb816c8\"><span class=\"cl-dbb0b752\">2.759</span></p></td><td class=\"cl-dbb858c3\"><p class=\"cl-dbb816c8\"><span class=\"cl-dbb0b752\">0.50</span></p></td><td class=\"cl-dbb858c3\"><p class=\"cl-dbb816c8\"><span class=\"cl-dbb0b752\">17.47</span></p></td><td class=\"cl-dbb858c3\"><p class=\"cl-dbb816c8\"><span class=\"cl-dbb0b752\"></span></p></td><td class=\"cl-dbb858c3\"><p class=\"cl-dbb816c8\"><span class=\"cl-dbb0b752\">0.048200</span></p></td><td class=\"cl-dbb858c3\"><p class=\"cl-dbb816c8\"><span class=\"cl-dbb0b752\">0</span></p></td><td class=\"cl-dbb858c3\"><p class=\"cl-dbb816c8\"><span class=\"cl-dbb0b752\">0.00000</span></p></td><td class=\"cl-dbb858c3\"><p class=\"cl-dbb816c8\"><span class=\"cl-dbb0b752\">0.0000</span></p></td><td class=\"cl-dbb858c3\"><p class=\"cl-dbb816c8\"><span class=\"cl-dbb0b752\">0</span></p></td><td class=\"cl-dbb858c3\"><p class=\"cl-dbb816c8\"><span class=\"cl-dbb0b752\">0.000</span></p></td><td class=\"cl-dbb858cc\"><p class=\"cl-dbb816dc\"><span class=\"cl-dbb0b752\"></span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-dbb858cd\"><p class=\"cl-dbb816c8\"><span class=\"cl-dbb0b752\">68578</span></p></td><td class=\"cl-dbb858cd\"><p class=\"cl-dbb816c8\"><span class=\"cl-dbb0b752\">11796</span></p></td><td class=\"cl-dbb858d6\"><p class=\"cl-dbb816dc\"><span class=\"cl-dbb0b752\">Hyas lyratus</span></p></td><td class=\"cl-dbb858d6\"><p class=\"cl-dbb816dc\"><span class=\"cl-dbb0b752\">Pacific lyre crab</span></p></td><td class=\"cl-dbb858d6\"><p class=\"cl-dbb816dc\"><span class=\"cl-dbb0b752\">species</span></p></td><td class=\"cl-dbb858cd\"><p class=\"cl-dbb816c8\"><span class=\"cl-dbb0b752\">442167</span></p></td><td class=\"cl-dbb858cd\"><p class=\"cl-dbb816c8\"><span class=\"cl-dbb0b752\">98422</span></p></td><td class=\"cl-dbb858cd\"><p class=\"cl-dbb816c8\"><span class=\"cl-dbb0b752\">1989</span></p></td><td class=\"cl-dbb858d6\"><p class=\"cl-dbb816dc\"><span class=\"cl-dbb0b752\">EBS</span></p></td><td class=\"cl-dbb858d6\"><p class=\"cl-dbb816dc\"><span class=\"cl-dbb0b752\">eastern Bering Sea</span></p></td><td class=\"cl-dbb858d6\"><p class=\"cl-dbb816dc\"><span class=\"cl-dbb0b752\">Eastern Bering Sea Crab/Groundfish Bottom Trawl Survey</span></p></td><td class=\"cl-dbb858cd\"><p class=\"cl-dbb816c8\"><span class=\"cl-dbb0b752\">98</span></p></td><td class=\"cl-dbb858cd\"><p class=\"cl-dbb816c8\"><span class=\"cl-dbb0b752\">198901</span></p></td><td class=\"cl-dbb858cd\"><p class=\"cl-dbb816c8\"><span class=\"cl-dbb0b752\">159</span></p></td><td class=\"cl-dbb858cd\"><p class=\"cl-dbb816c8\"><span class=\"cl-dbb0b752\">154</span></p></td><td class=\"cl-dbb858cd\"><p class=\"cl-dbb816c8\"><span class=\"cl-dbb0b752\">61</span></p></td><td class=\"cl-dbb858d6\"><p class=\"cl-dbb816dc\"><span class=\"cl-dbb0b752\">J-25</span></p></td><td class=\"cl-dbb858cd\"><p class=\"cl-dbb816c8\"><span class=\"cl-dbb0b752\">78</span></p></td><td class=\"cl-dbb858d6\"><p class=\"cl-dbb816dc\"><span class=\"cl-dbb0b752\">OCEAN HOPE 3</span></p></td><td class=\"cl-dbb858d6\"><p class=\"cl-dbb816dc\"><span class=\"cl-dbb0b752\">1989-07-15T12:00:00Z</span></p></td><td class=\"cl-dbb858cd\"><p class=\"cl-dbb816c8\"><span class=\"cl-dbb0b752\">57.98600</span></p></td><td class=\"cl-dbb858cd\"><p class=\"cl-dbb816c8\"><span class=\"cl-dbb0b752\">-172.8603</span></p></td><td class=\"cl-dbb858cd\"><p class=\"cl-dbb816c8\"><span class=\"cl-dbb0b752\">58.01000</span></p></td><td class=\"cl-dbb858cd\"><p class=\"cl-dbb816c8\"><span class=\"cl-dbb0b752\">-172.8702</span></p></td><td class=\"cl-dbb858cd\"><p class=\"cl-dbb816c8\"><span class=\"cl-dbb0b752\">3.1</span></p></td><td class=\"cl-dbb858cd\"><p class=\"cl-dbb816c8\"><span class=\"cl-dbb0b752\">8.0</span></p></td><td class=\"cl-dbb858cd\"><p class=\"cl-dbb816c8\"><span class=\"cl-dbb0b752\">110</span></p></td><td class=\"cl-dbb858cd\"><p class=\"cl-dbb816c8\"><span class=\"cl-dbb0b752\">2.741</span></p></td><td class=\"cl-dbb858cd\"><p class=\"cl-dbb816c8\"><span class=\"cl-dbb0b752\">0.50</span></p></td><td class=\"cl-dbb858cd\"><p class=\"cl-dbb816c8\"><span class=\"cl-dbb0b752\">17.47</span></p></td><td class=\"cl-dbb858cd\"><p class=\"cl-dbb816c8\"><span class=\"cl-dbb0b752\"></span></p></td><td class=\"cl-dbb858cd\"><p class=\"cl-dbb816c8\"><span class=\"cl-dbb0b752\">0.047885</span></p></td><td class=\"cl-dbb858cd\"><p class=\"cl-dbb816c8\"><span class=\"cl-dbb0b752\">0</span></p></td><td class=\"cl-dbb858cd\"><p class=\"cl-dbb816c8\"><span class=\"cl-dbb0b752\">14.20061</span></p></td><td class=\"cl-dbb858cd\"><p class=\"cl-dbb816c8\"><span class=\"cl-dbb0b752\">229.7157</span></p></td><td class=\"cl-dbb858cd\"><p class=\"cl-dbb816c8\"><span class=\"cl-dbb0b752\">11</span></p></td><td class=\"cl-dbb858cd\"><p class=\"cl-dbb816c8\"><span class=\"cl-dbb0b752\">0.680</span></p></td><td class=\"cl-dbb858d6\"><p class=\"cl-dbb816dc\"><span class=\"cl-dbb0b752\">High</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-dbb858c3\"><p class=\"cl-dbb816c8\"><span class=\"cl-dbb0b752\">68578</span></p></td><td class=\"cl-dbb858c3\"><p class=\"cl-dbb816c8\"><span class=\"cl-dbb0b752\">11797</span></p></td><td class=\"cl-dbb858cc\"><p class=\"cl-dbb816dc\"><span class=\"cl-dbb0b752\">Hyas lyratus</span></p></td><td class=\"cl-dbb858cc\"><p class=\"cl-dbb816dc\"><span class=\"cl-dbb0b752\">Pacific lyre crab</span></p></td><td class=\"cl-dbb858cc\"><p class=\"cl-dbb816dc\"><span class=\"cl-dbb0b752\">species</span></p></td><td class=\"cl-dbb858c3\"><p class=\"cl-dbb816c8\"><span class=\"cl-dbb0b752\">442167</span></p></td><td class=\"cl-dbb858c3\"><p class=\"cl-dbb816c8\"><span class=\"cl-dbb0b752\">98422</span></p></td><td class=\"cl-dbb858c3\"><p class=\"cl-dbb816c8\"><span class=\"cl-dbb0b752\">1989</span></p></td><td class=\"cl-dbb858cc\"><p class=\"cl-dbb816dc\"><span class=\"cl-dbb0b752\">EBS</span></p></td><td class=\"cl-dbb858cc\"><p class=\"cl-dbb816dc\"><span class=\"cl-dbb0b752\">eastern Bering Sea</span></p></td><td class=\"cl-dbb858cc\"><p class=\"cl-dbb816dc\"><span class=\"cl-dbb0b752\">Eastern Bering Sea Crab/Groundfish Bottom Trawl Survey</span></p></td><td class=\"cl-dbb858c3\"><p class=\"cl-dbb816c8\"><span class=\"cl-dbb0b752\">98</span></p></td><td class=\"cl-dbb858c3\"><p class=\"cl-dbb816c8\"><span class=\"cl-dbb0b752\">198901</span></p></td><td class=\"cl-dbb858c3\"><p class=\"cl-dbb816c8\"><span class=\"cl-dbb0b752\">159</span></p></td><td class=\"cl-dbb858c3\"><p class=\"cl-dbb816c8\"><span class=\"cl-dbb0b752\">155</span></p></td><td class=\"cl-dbb858c3\"><p class=\"cl-dbb816c8\"><span class=\"cl-dbb0b752\">61</span></p></td><td class=\"cl-dbb858cc\"><p class=\"cl-dbb816dc\"><span class=\"cl-dbb0b752\">K-25</span></p></td><td class=\"cl-dbb858c3\"><p class=\"cl-dbb816c8\"><span class=\"cl-dbb0b752\">78</span></p></td><td class=\"cl-dbb858cc\"><p class=\"cl-dbb816dc\"><span class=\"cl-dbb0b752\">OCEAN HOPE 3</span></p></td><td class=\"cl-dbb858cc\"><p class=\"cl-dbb816dc\"><span class=\"cl-dbb0b752\">1989-07-15T14:00:00Z</span></p></td><td class=\"cl-dbb858c3\"><p class=\"cl-dbb816c8\"><span class=\"cl-dbb0b752\">58.32133</span></p></td><td class=\"cl-dbb858c3\"><p class=\"cl-dbb816c8\"><span class=\"cl-dbb0b752\">-172.9123</span></p></td><td class=\"cl-dbb858c3\"><p class=\"cl-dbb816c8\"><span class=\"cl-dbb0b752\">58.33733</span></p></td><td class=\"cl-dbb858c3\"><p class=\"cl-dbb816c8\"><span class=\"cl-dbb0b752\">-172.9138</span></p></td><td class=\"cl-dbb858c3\"><p class=\"cl-dbb816c8\"><span class=\"cl-dbb0b752\">3.1</span></p></td><td class=\"cl-dbb858c3\"><p class=\"cl-dbb816c8\"><span class=\"cl-dbb0b752\">8.4</span></p></td><td class=\"cl-dbb858c3\"><p class=\"cl-dbb816c8\"><span class=\"cl-dbb0b752\">110</span></p></td><td class=\"cl-dbb858c3\"><p class=\"cl-dbb816c8\"><span class=\"cl-dbb0b752\">1.796</span></p></td><td class=\"cl-dbb858c3\"><p class=\"cl-dbb816c8\"><span class=\"cl-dbb0b752\">0.33</span></p></td><td class=\"cl-dbb858c3\"><p class=\"cl-dbb816c8\"><span class=\"cl-dbb0b752\">17.47</span></p></td><td class=\"cl-dbb858c3\"><p class=\"cl-dbb816c8\"><span class=\"cl-dbb0b752\"></span></p></td><td class=\"cl-dbb858c3\"><p class=\"cl-dbb816c8\"><span class=\"cl-dbb0b752\">0.031376</span></p></td><td class=\"cl-dbb858c3\"><p class=\"cl-dbb816c8\"><span class=\"cl-dbb0b752\">0</span></p></td><td class=\"cl-dbb858c3\"><p class=\"cl-dbb816c8\"><span class=\"cl-dbb0b752\">14.46960</span></p></td><td class=\"cl-dbb858c3\"><p class=\"cl-dbb816c8\"><span class=\"cl-dbb0b752\">318.7137</span></p></td><td class=\"cl-dbb858c3\"><p class=\"cl-dbb816c8\"><span class=\"cl-dbb0b752\">10</span></p></td><td class=\"cl-dbb858c3\"><p class=\"cl-dbb816c8\"><span class=\"cl-dbb0b752\">0.454</span></p></td><td class=\"cl-dbb858cc\"><p class=\"cl-dbb816dc\"><span class=\"cl-dbb0b752\">High</span></p></td></tr></tbody></table></div>\n```\n\n:::\n\n```{.r .cell-code}\n# save outputs for later comparison\ndat_zerofill_api <- dat\n```\n:::\n\n\n## Ex. Visualize zero-filled data for 2023 eastern Bering Sea walleye pollock in CPUE data in distribution map\n\nUsing the zero-filled data from the previous example, we can make a few plots! \n\nHere is some example data of 2023 through 2019 (`year %in% 2019:2023`) eastern and northern Bering Sea (`srvy %in% c(\"EBS\", \"NBS)`) walleye pollock (`species_code == 21740`). \n\n\n::: {.cell}\n\n```{.r .cell-code}\ndat <- dat_zerofill_api |> \n  dplyr::filter(year %in% 2019:2023 & \n                  srvy %in% c(\"EBS\", \"NBS\") & \n                  species_code == 21740) |> \n  dplyr::select(year, common_name, longitude_dd_start, latitude_dd_start, cpue_kgkm2)\n\n# Find how many rows and columns are in the data pull\nprint(paste0(\"rows: \", nrow(dat), \"; cols: \", ncol(dat)))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"rows: 2052; cols: 5\"\n```\n\n\n:::\n\n```{.r .cell-code}\n# # learn about the structure of the data\n# summary(dat)\n\n# Print the first few lines of the data \ndat |> \n  head(3) |> \n  flextable::flextable() |>\n  flextable::colformat_num(\n      j = c(\"year\"), \n      big.mark = \"\") |> \n  flextable::theme_zebra()\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"tabwid\"><style>.cl-dd0892be{}.cl-dcf7e69e{font-family:'Arial';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-dcf7e6a8{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-dcfe877e{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-dcfe8792{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-dcfec4c8{width:0.75in;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dcfec4d2{width:0.75in;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dcfec4dc{width:0.75in;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dcfec4e6{width:0.75in;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dcfec4e7{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dcfec4f0{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-dd0892be'><thead><tr style=\"overflow-wrap:break-word;\"><th class=\"cl-dcfec4c8\"><p class=\"cl-dcfe877e\"><span class=\"cl-dcf7e69e\">year</span></p></th><th class=\"cl-dcfec4d2\"><p class=\"cl-dcfe8792\"><span class=\"cl-dcf7e69e\">common_name</span></p></th><th class=\"cl-dcfec4c8\"><p class=\"cl-dcfe877e\"><span class=\"cl-dcf7e69e\">longitude_dd_start</span></p></th><th class=\"cl-dcfec4c8\"><p class=\"cl-dcfe877e\"><span class=\"cl-dcf7e69e\">latitude_dd_start</span></p></th><th class=\"cl-dcfec4c8\"><p class=\"cl-dcfe877e\"><span class=\"cl-dcf7e69e\">cpue_kgkm2</span></p></th></tr></thead><tbody><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-dcfec4dc\"><p class=\"cl-dcfe877e\"><span class=\"cl-dcf7e6a8\">2021</span></p></td><td class=\"cl-dcfec4e6\"><p class=\"cl-dcfe8792\"><span class=\"cl-dcf7e6a8\">walleye pollock</span></p></td><td class=\"cl-dcfec4dc\"><p class=\"cl-dcfe877e\"><span class=\"cl-dcf7e6a8\">-172.1196</span></p></td><td class=\"cl-dcfec4dc\"><p class=\"cl-dcfe877e\"><span class=\"cl-dcf7e6a8\">57.35342</span></p></td><td class=\"cl-dcfec4dc\"><p class=\"cl-dcfe877e\"><span class=\"cl-dcf7e6a8\">4,836.466</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-dcfec4e7\"><p class=\"cl-dcfe877e\"><span class=\"cl-dcf7e6a8\">2021</span></p></td><td class=\"cl-dcfec4f0\"><p class=\"cl-dcfe8792\"><span class=\"cl-dcf7e6a8\">walleye pollock</span></p></td><td class=\"cl-dcfec4e7\"><p class=\"cl-dcfe877e\"><span class=\"cl-dcf7e6a8\">-171.4952</span></p></td><td class=\"cl-dcfec4e7\"><p class=\"cl-dcfe877e\"><span class=\"cl-dcf7e6a8\">57.32779</span></p></td><td class=\"cl-dcfec4e7\"><p class=\"cl-dcfe877e\"><span class=\"cl-dcf7e6a8\">12,709.182</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-dcfec4dc\"><p class=\"cl-dcfe877e\"><span class=\"cl-dcf7e6a8\">2021</span></p></td><td class=\"cl-dcfec4e6\"><p class=\"cl-dcfe8792\"><span class=\"cl-dcf7e6a8\">walleye pollock</span></p></td><td class=\"cl-dcfec4dc\"><p class=\"cl-dcfe877e\"><span class=\"cl-dcf7e6a8\">-171.3904</span></p></td><td class=\"cl-dcfec4dc\"><p class=\"cl-dcfe877e\"><span class=\"cl-dcf7e6a8\">57.00871</span></p></td><td class=\"cl-dcfec4dc\"><p class=\"cl-dcfe877e\"><span class=\"cl-dcf7e6a8\">18,944.559</span></p></td></tr></tbody></table></div>\n```\n\n:::\n:::\n\n\n### Plot locations on map\n\n\n::: {.cell tbl-cap='CPUE (kg/km^2) of walleye pollock catch at each station in the 2019-2023 eastern and northern Bering Sea bottom trawl surveys. Size of black circles denote magnitude of CPUE caught at station and red triangles denote stations where walleye pollock were not caught. '}\n\n```{.r .cell-code}\nlibrary(ggplot2)\n\nggplot2::ggplot(data = dat |> dplyr::filter(cpue_kgkm2 != 0), \n                mapping = aes(x = longitude_dd_start, \n                              y = latitude_dd_start, \n                              size = cpue_kgkm2)) + \n  ggplot2::geom_point(alpha = .75) +\n  ggplot2::geom_point(data = dat |> dplyr::filter(cpue_kgkm2 == 0), \n                      color = \"red\", \n                      shape = 17,\n                      alpha = .75,\n                      size = 3) +\n  ggplot2::xlab(\"Longitude *W\") +\n  ggplot2::ylab(\"Latitude *N\") +\n  ggplot2::ggtitle(label = \"CPUE (kg/km^2) of walleye pollock (Weight CPUE; kg/km2)\", \n                   subtitle = \"Eastern Bering Sea bottom trawl survey\") +\n  ggplot2::scale_size_continuous(name = \"Weight (kg)\") + \n  ggplot2::facet_wrap(facets = vars(year)) + \n  ggplot2::theme_bw()\n```\n\n::: {.cell-output-display}\n![](foss-api-r_files/figure-html/pollock-multi-loc-1.png){width=672}\n:::\n:::\n\n\n### Plot inverse-distance weighted plot of CPUE\n\nThis map is constructed using [`akgfmaps`](https://github.com/afsc-gap-products/akgfmaps). To make IDW plots, you must have data from all stations surveyed, even if no fish of interest were found there. \n\nThese plots are similar to those published in the [annual Bering Sea data reports](https://www.fisheries.noaa.gov/alaska/science-data/groundfish-assessment-program-bottom-trawl-surveys#communications). \n\n\n::: {.cell tbl-cap='Inverse-distance weight CPUE of walleye pollock catch at each station in the 2019-2023 eastern and northern Bering Sea bottom trawl surveys. '}\n\n```{.r .cell-code}\n# devtools::install_github(\"afsc-gap-products/akgfmaps\", build_vignettes = TRUE)\nlibrary(akgfmaps)\nidw <- akgfmaps::make_idw_stack(\n  x = dat |> \n    dplyr::select(COMMON_NAME = common_name, \n                  CPUE_KGHA = cpue_kgkm2, \n                  LATITUDE = latitude_dd_start, \n                  LONGITUDE = longitude_dd_start, \n                  year), \n  grouping.vars = \"year\", \n  region = \"bs.all\", # Predefined EBS area\n  set.breaks = \"jenks\", # Gets Jenks breaks from classint::classIntervals()\n  in.crs = \"+proj=longlat\", # Set input coordinate reference system\n  out.crs = \"EPSG:3338\", # Set output coordinate reference system\n  extrapolation.grid.type = \"sf\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[inverse distance weighted interpolation]\n[inverse distance weighted interpolation]\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[inverse distance weighted interpolation]\n[inverse distance weighted interpolation]\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[inverse distance weighted interpolation]\n[inverse distance weighted interpolation]\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[inverse distance weighted interpolation]\n[inverse distance weighted interpolation]\n```\n\n\n:::\n\n```{.r .cell-code}\nshps <- akgfmaps::get_base_layers(\n  select.region = \"bs.all\", \n  # include.corners = TRUE, \n  set.crs = \"EPSG:3338\")\n\nshps$survey.area$SRVY <- c(\"EBS\", \"NBS\")\nshps$survey.area$SURVEY <- c(\"EBS\", \"NBS\")\n\n# set.breaks <- akgfmaps::eval_plot_breaks(CPUE = dat$cpue_kgkm2, n.breaks = 5)\n# set.breaks <- as.vector(unlist(set.breaks[set.breaks$style == \"pretty\", -1]))\nset.breaks <- c(0, 50000, 100000, 150000, 200000, 250000)\n\nfigure_print <- ggplot() +\n  # add map of alaska\n  ggplot2::geom_sf(data = shps$akland,\n                   color = NA,\n                   fill = \"grey50\") +\n  # add IDW plots\n  geom_sf(data = idw$extrapolation.stack,\n          mapping = aes(fill = var1.pred),\n          na.rm = FALSE,\n          show.legend = TRUE, \n          color = NA) +\n  ggplot2::scale_fill_manual(\n    name = \"walleye pollock\\nCPUE (kg/km2)\",\n    values =  c(\"gray90\",\n                viridis::viridis(\n                  option = \"mako\",\n                  direction = -1,\n                  n = length(set.breaks)-1,\n                  begin = 0.20,\n                  end = 0.80)),\n    na.translate = FALSE, # Don't use NA\n    drop = FALSE) + \n  # seperate plots by year\n  ggplot2::facet_wrap(facets = vars(year), nrow = 2) + \n  # add survey area\n  ggplot2::geom_sf(\n    data = shps$survey.area, \n    mapping = aes(color = SURVEY, \n                  geometry = geometry), \n    fill = \"transparent\", \n    linewidth = 1, \n    show.legend = FALSE) +\n  ggplot2::scale_color_manual(\n    name = \" \", \n    values = c(\"grey30\", \"grey50\"),\n    breaks = shps$survey.area$SURVEY,\n    labels = shps$survey.area$SRVY) + \n  # lat/lon axis and map bounds\n  ggplot2::scale_x_continuous(name = \"Longitude W\",\n                              breaks = seq(-180, -150, 5)) +\n  ggplot2::scale_y_continuous(name = \"Latitude N\",\n                              breaks = seq(50, 65, 5)) + # seq(52, 62, 2)\n  ggplot2::coord_sf(xlim = sf::st_bbox(shps$survey.area)[c(1,3)],\n                    ylim = sf::st_bbox(shps$survey.area)[c(2,4)]) +\n  # add theme aesthetics\n  ggplot2::guides(\n    fill = guide_legend(\n      order = 1,\n      title.position = \"top\",\n      label.position = \"bottom\",\n      title.hjust = 0.5,\n      override.aes = list(color = NA),\n      nrow = 1),\n    color = \"none\") +\n  ggplot2::theme( \n    panel.background = element_rect(fill = \"white\", colour = NA), \n    panel.border = element_rect(fill = NA, colour = \"grey20\"), \n    strip.background = element_blank(), \n    strip.text = element_text(size = 10, face = \"bold\"), \n    legend.text = element_text(size = 9),\n    legend.background = element_rect(colour = \"transparent\", \n                                     fill = \"transparent\"),\n    legend.key = element_rect(colour = \"transparent\", \n                              fill = \"transparent\"),\n    legend.position = \"bottom\", \n    legend.box = \"horizontal\",\n    legend.box.spacing = unit(0, \"pt\"), # reduce space between legend & plot\n    legend.margin=margin(0, 0, 0, 0) )\n\nfigure_print\n```\n\n::: {.cell-output-display}\n![](foss-api-r_files/figure-html/pollock-multi-idw-1.png){width=576}\n:::\n:::\n\n\n## Ex. Show catch data for 2023 eastern Bering Sea Walleye Pollock (one species in one survey region in one year)\n\nData downloads and joins for just one species, survey, and year are much faster and easier to do. \n\nFirst, because `year` is identified in the haul table, we need to identify all of the hauls (or more specifically, `hauljoin` codes) that were completed in the eastern Bering Sea (`\"srvy\":\"EBS\"`) in 2023 (`\"year\":2023`). \n\nNote: Check how many rows and columns are in the data pull. The eastern Bering Sea survey (before 2024) has 376 stations in it, and pollock are often found in throughout the region so this should have a similar number of rows. \n\n\n::: {.cell}\n\n```{.r .cell-code}\n## query the API link\nres <- httr::GET(url = paste0(api_link_haul, '?limit=10000&q={\"year\":2023,\"srvy\":\"EBS\"}'))\n\n## convert from JSON format\ndata <- jsonlite::fromJSON(base::rawToChar(res$content)) \ndat <- data$items |>\n  dplyr::select(-links) # necessary for API accounting, but not part of the dataset\n\n## show summary of data to make sure it is subset correctly\nsummary(dat |> dplyr::mutate(srvy = as.factor(srvy)))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n      year       srvy        survey          survey_name       \n Min.   :2023   EBS:376   Length:376         Length:376        \n 1st Qu.:2023             Class :character   Class :character  \n Median :2023             Mode  :character   Mode  :character  \n Mean   :2023                                                  \n 3rd Qu.:2023                                                  \n Max.   :2023                                                  \n survey_definition_id     cruise         cruisejoin        hauljoin     \n Min.   :98           Min.   :202301   Min.   :-760.0   Min.   :-23019  \n 1st Qu.:98           1st Qu.:202301   1st Qu.:-760.0   1st Qu.:-22776  \n Median :98           Median :202301   Median :-759.0   Median :-22539  \n Mean   :98           Mean   :202301   Mean   :-759.5   Mean   :-22552  \n 3rd Qu.:98           3rd Qu.:202301   3rd Qu.:-759.0   3rd Qu.:-22333  \n Max.   :98           Max.   :202301   Max.   :-759.0   Max.   :-22110  \n      haul           stratum        station            vessel_id    \n Min.   :  7.00   Min.   :10.00   Length:376         Min.   :134.0  \n 1st Qu.: 65.75   1st Qu.:31.00   Class :character   1st Qu.:134.0  \n Median :114.00   Median :41.00   Mode  :character   Median :162.0  \n Mean   :114.16   Mean   :39.22                      Mean   :148.3  \n 3rd Qu.:161.25   3rd Qu.:50.00                      3rd Qu.:162.0  \n Max.   :224.00   Max.   :90.00                      Max.   :162.0  \n vessel_name         date_time         latitude_dd_start longitude_dd_start\n Length:376         Length:376         Min.   :54.66     Min.   :-178.2    \n Class :character   Class :character   1st Qu.:57.00     1st Qu.:-172.7    \n Mode  :character   Mode  :character   Median :58.02     Median :-168.9    \n                                       Mean   :58.26     Mean   :-168.8    \n                                       3rd Qu.:59.50     3rd Qu.:-165.2    \n                                       Max.   :62.01     Max.   :-158.3    \n latitude_dd_end longitude_dd_end bottom_temperature_c surface_temperature_c\n Min.   :54.68   Min.   :-178.2   Min.   :-1.600       Min.   : 1.700       \n 1st Qu.:57.01   1st Qu.:-172.7   1st Qu.: 1.200       1st Qu.: 4.200       \n Median :58.02   Median :-168.9   Median : 2.700       Median : 6.550       \n Mean   :58.26   Mean   :-168.8   Mean   : 2.249       Mean   : 6.386       \n 3rd Qu.:59.50   3rd Qu.:-165.2   3rd Qu.: 3.500       3rd Qu.: 8.525       \n Max.   :62.01   Max.   :-158.3   Max.   : 5.400       Max.   :11.000       \n    depth_m       distance_fished_km  duration_hr      net_width_m   \n Min.   : 20.00   Min.   :1.065      Min.   :0.1890   Min.   :12.90  \n 1st Qu.: 54.75   1st Qu.:2.805      1st Qu.:0.5100   1st Qu.:16.66  \n Median : 74.00   Median :2.889      Median :0.5180   Median :17.27  \n Mean   : 80.75   Mean   :2.854      Mean   :0.5129   Mean   :17.15  \n 3rd Qu.:105.00   3rd Qu.:2.945      3rd Qu.:0.5260   3rd Qu.:17.83  \n Max.   :171.00   Max.   :3.849      Max.   :0.6560   Max.   :20.29  \n  net_height_m   area_swept_km2     performance    \n Min.   :1.300   Min.   :0.02017   Min.   :0.0000  \n 1st Qu.:1.875   1st Qu.:0.04725   1st Qu.:0.0000  \n Median :2.064   Median :0.04944   Median :0.0000  \n Mean   :2.107   Mean   :0.04892   Mean   :0.1075  \n 3rd Qu.:2.343   3rd Qu.:0.05134   3rd Qu.:0.0000  \n Max.   :3.196   Max.   :0.06369   Max.   :6.2200  \n```\n\n\n:::\n\n```{.r .cell-code}\n## Find how many rows and columns are in the data pull. \nprint(paste0(\"rows: \", nrow(dat), \"; cols: \", ncol(dat)))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"rows: 376; cols: 27\"\n```\n\n\n:::\n\n```{.r .cell-code}\n# save outputs for later comparison\ndat_haul_ex <- dat\n```\n:::\n\n\n\n\n::: {.cell tbl-cap='Haul data filtered by `year = 2023` and `SRVY = \\'EBS\\'`. '}\n\n```{.r .cell-code}\n# Print the first few lines of the data \ndat_haul_ex |> \n  head(3) |> \n  flextable::flextable() |>\n  flextable::colformat_num(\n      j = c(\"year\", \"hauljoin\", \"cruise\"), \n      big.mark = \"\") |> \n  flextable::theme_zebra()\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"tabwid\"><style>.cl-08fca07c{}.cl-08e3f234{font-family:'Arial';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-08e3f248{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-08ebcb9e{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-08ebcbb2{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-08ec0e24{width:0.75in;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-08ec0e2e{width:0.75in;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-08ec0e38{width:0.75in;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-08ec0e42{width:0.75in;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-08ec0e4c{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-08ec0e56{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-08fca07c'><thead><tr style=\"overflow-wrap:break-word;\"><th class=\"cl-08ec0e24\"><p class=\"cl-08ebcb9e\"><span class=\"cl-08e3f234\">year</span></p></th><th class=\"cl-08ec0e2e\"><p class=\"cl-08ebcbb2\"><span class=\"cl-08e3f234\">srvy</span></p></th><th class=\"cl-08ec0e2e\"><p class=\"cl-08ebcbb2\"><span class=\"cl-08e3f234\">survey</span></p></th><th class=\"cl-08ec0e2e\"><p class=\"cl-08ebcbb2\"><span class=\"cl-08e3f234\">survey_name</span></p></th><th class=\"cl-08ec0e24\"><p class=\"cl-08ebcb9e\"><span class=\"cl-08e3f234\">survey_definition_id</span></p></th><th class=\"cl-08ec0e24\"><p class=\"cl-08ebcb9e\"><span class=\"cl-08e3f234\">cruise</span></p></th><th class=\"cl-08ec0e24\"><p class=\"cl-08ebcb9e\"><span class=\"cl-08e3f234\">cruisejoin</span></p></th><th class=\"cl-08ec0e24\"><p class=\"cl-08ebcb9e\"><span class=\"cl-08e3f234\">hauljoin</span></p></th><th class=\"cl-08ec0e24\"><p class=\"cl-08ebcb9e\"><span class=\"cl-08e3f234\">haul</span></p></th><th class=\"cl-08ec0e24\"><p class=\"cl-08ebcb9e\"><span class=\"cl-08e3f234\">stratum</span></p></th><th class=\"cl-08ec0e2e\"><p class=\"cl-08ebcbb2\"><span class=\"cl-08e3f234\">station</span></p></th><th class=\"cl-08ec0e24\"><p class=\"cl-08ebcb9e\"><span class=\"cl-08e3f234\">vessel_id</span></p></th><th class=\"cl-08ec0e2e\"><p class=\"cl-08ebcbb2\"><span class=\"cl-08e3f234\">vessel_name</span></p></th><th class=\"cl-08ec0e2e\"><p class=\"cl-08ebcbb2\"><span class=\"cl-08e3f234\">date_time</span></p></th><th class=\"cl-08ec0e24\"><p class=\"cl-08ebcb9e\"><span class=\"cl-08e3f234\">latitude_dd_start</span></p></th><th class=\"cl-08ec0e24\"><p class=\"cl-08ebcb9e\"><span class=\"cl-08e3f234\">longitude_dd_start</span></p></th><th class=\"cl-08ec0e24\"><p class=\"cl-08ebcb9e\"><span class=\"cl-08e3f234\">latitude_dd_end</span></p></th><th class=\"cl-08ec0e24\"><p class=\"cl-08ebcb9e\"><span class=\"cl-08e3f234\">longitude_dd_end</span></p></th><th class=\"cl-08ec0e24\"><p class=\"cl-08ebcb9e\"><span class=\"cl-08e3f234\">bottom_temperature_c</span></p></th><th class=\"cl-08ec0e24\"><p class=\"cl-08ebcb9e\"><span class=\"cl-08e3f234\">surface_temperature_c</span></p></th><th class=\"cl-08ec0e24\"><p class=\"cl-08ebcb9e\"><span class=\"cl-08e3f234\">depth_m</span></p></th><th class=\"cl-08ec0e24\"><p class=\"cl-08ebcb9e\"><span class=\"cl-08e3f234\">distance_fished_km</span></p></th><th class=\"cl-08ec0e24\"><p class=\"cl-08ebcb9e\"><span class=\"cl-08e3f234\">duration_hr</span></p></th><th class=\"cl-08ec0e24\"><p class=\"cl-08ebcb9e\"><span class=\"cl-08e3f234\">net_width_m</span></p></th><th class=\"cl-08ec0e24\"><p class=\"cl-08ebcb9e\"><span class=\"cl-08e3f234\">net_height_m</span></p></th><th class=\"cl-08ec0e24\"><p class=\"cl-08ebcb9e\"><span class=\"cl-08e3f234\">area_swept_km2</span></p></th><th class=\"cl-08ec0e24\"><p class=\"cl-08ebcb9e\"><span class=\"cl-08e3f234\">performance</span></p></th></tr></thead><tbody><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-08ec0e38\"><p class=\"cl-08ebcb9e\"><span class=\"cl-08e3f248\">2023</span></p></td><td class=\"cl-08ec0e42\"><p class=\"cl-08ebcbb2\"><span class=\"cl-08e3f248\">EBS</span></p></td><td class=\"cl-08ec0e42\"><p class=\"cl-08ebcbb2\"><span class=\"cl-08e3f248\">eastern Bering Sea</span></p></td><td class=\"cl-08ec0e42\"><p class=\"cl-08ebcbb2\"><span class=\"cl-08e3f248\">Eastern Bering Sea Crab/Groundfish Bottom Trawl Survey</span></p></td><td class=\"cl-08ec0e38\"><p class=\"cl-08ebcb9e\"><span class=\"cl-08e3f248\">98</span></p></td><td class=\"cl-08ec0e38\"><p class=\"cl-08ebcb9e\"><span class=\"cl-08e3f248\">202301</span></p></td><td class=\"cl-08ec0e38\"><p class=\"cl-08ebcb9e\"><span class=\"cl-08e3f248\">-759</span></p></td><td class=\"cl-08ec0e38\"><p class=\"cl-08ebcb9e\"><span class=\"cl-08e3f248\">-22283</span></p></td><td class=\"cl-08ec0e38\"><p class=\"cl-08ebcb9e\"><span class=\"cl-08e3f248\">64</span></p></td><td class=\"cl-08ec0e38\"><p class=\"cl-08ebcb9e\"><span class=\"cl-08e3f248\">31</span></p></td><td class=\"cl-08ec0e42\"><p class=\"cl-08ebcbb2\"><span class=\"cl-08e3f248\">G-08</span></p></td><td class=\"cl-08ec0e38\"><p class=\"cl-08ebcb9e\"><span class=\"cl-08e3f248\">162</span></p></td><td class=\"cl-08ec0e42\"><p class=\"cl-08ebcbb2\"><span class=\"cl-08e3f248\">ALASKA KNIGHT</span></p></td><td class=\"cl-08ec0e42\"><p class=\"cl-08ebcbb2\"><span class=\"cl-08e3f248\">2023-06-08T10:05:05Z</span></p></td><td class=\"cl-08ec0e38\"><p class=\"cl-08ebcb9e\"><span class=\"cl-08e3f248\">57.00863</span></p></td><td class=\"cl-08ec0e38\"><p class=\"cl-08ebcb9e\"><span class=\"cl-08e3f248\">-163.3957</span></p></td><td class=\"cl-08ec0e38\"><p class=\"cl-08ebcb9e\"><span class=\"cl-08e3f248\">56.98449</span></p></td><td class=\"cl-08ec0e38\"><p class=\"cl-08ebcb9e\"><span class=\"cl-08e3f248\">-163.4006</span></p></td><td class=\"cl-08ec0e38\"><p class=\"cl-08ebcb9e\"><span class=\"cl-08e3f248\">2.7</span></p></td><td class=\"cl-08ec0e38\"><p class=\"cl-08ebcb9e\"><span class=\"cl-08e3f248\">5.1</span></p></td><td class=\"cl-08ec0e38\"><p class=\"cl-08ebcb9e\"><span class=\"cl-08e3f248\">66</span></p></td><td class=\"cl-08ec0e38\"><p class=\"cl-08ebcb9e\"><span class=\"cl-08e3f248\">2.700</span></p></td><td class=\"cl-08ec0e38\"><p class=\"cl-08ebcb9e\"><span class=\"cl-08e3f248\">0.488</span></p></td><td class=\"cl-08ec0e38\"><p class=\"cl-08ebcb9e\"><span class=\"cl-08e3f248\">16.526</span></p></td><td class=\"cl-08ec0e38\"><p class=\"cl-08ebcb9e\"><span class=\"cl-08e3f248\">2.466</span></p></td><td class=\"cl-08ec0e38\"><p class=\"cl-08ebcb9e\"><span class=\"cl-08e3f248\">0.044620</span></p></td><td class=\"cl-08ec0e38\"><p class=\"cl-08ebcb9e\"><span class=\"cl-08e3f248\">0.0</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-08ec0e4c\"><p class=\"cl-08ebcb9e\"><span class=\"cl-08e3f248\">2023</span></p></td><td class=\"cl-08ec0e56\"><p class=\"cl-08ebcbb2\"><span class=\"cl-08e3f248\">EBS</span></p></td><td class=\"cl-08ec0e56\"><p class=\"cl-08ebcbb2\"><span class=\"cl-08e3f248\">eastern Bering Sea</span></p></td><td class=\"cl-08ec0e56\"><p class=\"cl-08ebcbb2\"><span class=\"cl-08e3f248\">Eastern Bering Sea Crab/Groundfish Bottom Trawl Survey</span></p></td><td class=\"cl-08ec0e4c\"><p class=\"cl-08ebcb9e\"><span class=\"cl-08e3f248\">98</span></p></td><td class=\"cl-08ec0e4c\"><p class=\"cl-08ebcb9e\"><span class=\"cl-08e3f248\">202301</span></p></td><td class=\"cl-08ec0e4c\"><p class=\"cl-08ebcb9e\"><span class=\"cl-08e3f248\">-759</span></p></td><td class=\"cl-08ec0e4c\"><p class=\"cl-08ebcb9e\"><span class=\"cl-08e3f248\">-22284</span></p></td><td class=\"cl-08ec0e4c\"><p class=\"cl-08ebcb9e\"><span class=\"cl-08e3f248\">63</span></p></td><td class=\"cl-08ec0e4c\"><p class=\"cl-08ebcb9e\"><span class=\"cl-08e3f248\">10</span></p></td><td class=\"cl-08ec0e56\"><p class=\"cl-08ebcbb2\"><span class=\"cl-08e3f248\">H-08</span></p></td><td class=\"cl-08ec0e4c\"><p class=\"cl-08ebcb9e\"><span class=\"cl-08e3f248\">162</span></p></td><td class=\"cl-08ec0e56\"><p class=\"cl-08ebcbb2\"><span class=\"cl-08e3f248\">ALASKA KNIGHT</span></p></td><td class=\"cl-08ec0e56\"><p class=\"cl-08ebcbb2\"><span class=\"cl-08e3f248\">2023-06-08T07:24:07Z</span></p></td><td class=\"cl-08ec0e4c\"><p class=\"cl-08ebcb9e\"><span class=\"cl-08e3f248\">57.34861</span></p></td><td class=\"cl-08ec0e4c\"><p class=\"cl-08ebcb9e\"><span class=\"cl-08e3f248\">-163.3868</span></p></td><td class=\"cl-08ec0e4c\"><p class=\"cl-08ebcb9e\"><span class=\"cl-08e3f248\">57.32483</span></p></td><td class=\"cl-08ec0e4c\"><p class=\"cl-08ebcb9e\"><span class=\"cl-08e3f248\">-163.3967</span></p></td><td class=\"cl-08ec0e4c\"><p class=\"cl-08ebcb9e\"><span class=\"cl-08e3f248\">1.7</span></p></td><td class=\"cl-08ec0e4c\"><p class=\"cl-08ebcb9e\"><span class=\"cl-08e3f248\">4.2</span></p></td><td class=\"cl-08ec0e4c\"><p class=\"cl-08ebcb9e\"><span class=\"cl-08e3f248\">53</span></p></td><td class=\"cl-08ec0e4c\"><p class=\"cl-08ebcb9e\"><span class=\"cl-08e3f248\">2.710</span></p></td><td class=\"cl-08ec0e4c\"><p class=\"cl-08ebcb9e\"><span class=\"cl-08e3f248\">0.494</span></p></td><td class=\"cl-08ec0e4c\"><p class=\"cl-08ebcb9e\"><span class=\"cl-08e3f248\">16.714</span></p></td><td class=\"cl-08ec0e4c\"><p class=\"cl-08ebcb9e\"><span class=\"cl-08e3f248\">2.132</span></p></td><td class=\"cl-08ec0e4c\"><p class=\"cl-08ebcb9e\"><span class=\"cl-08e3f248\">0.045295</span></p></td><td class=\"cl-08ec0e4c\"><p class=\"cl-08ebcb9e\"><span class=\"cl-08e3f248\">0.0</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-08ec0e38\"><p class=\"cl-08ebcb9e\"><span class=\"cl-08e3f248\">2023</span></p></td><td class=\"cl-08ec0e42\"><p class=\"cl-08ebcbb2\"><span class=\"cl-08e3f248\">EBS</span></p></td><td class=\"cl-08ec0e42\"><p class=\"cl-08ebcbb2\"><span class=\"cl-08e3f248\">eastern Bering Sea</span></p></td><td class=\"cl-08ec0e42\"><p class=\"cl-08ebcbb2\"><span class=\"cl-08e3f248\">Eastern Bering Sea Crab/Groundfish Bottom Trawl Survey</span></p></td><td class=\"cl-08ec0e38\"><p class=\"cl-08ebcb9e\"><span class=\"cl-08e3f248\">98</span></p></td><td class=\"cl-08ec0e38\"><p class=\"cl-08ebcb9e\"><span class=\"cl-08e3f248\">202301</span></p></td><td class=\"cl-08ec0e38\"><p class=\"cl-08ebcb9e\"><span class=\"cl-08e3f248\">-759</span></p></td><td class=\"cl-08ec0e38\"><p class=\"cl-08ebcb9e\"><span class=\"cl-08e3f248\">-22285</span></p></td><td class=\"cl-08ec0e38\"><p class=\"cl-08ebcb9e\"><span class=\"cl-08e3f248\">66</span></p></td><td class=\"cl-08ec0e38\"><p class=\"cl-08ebcb9e\"><span class=\"cl-08e3f248\">31</span></p></td><td class=\"cl-08ec0e42\"><p class=\"cl-08ebcbb2\"><span class=\"cl-08e3f248\">E-08</span></p></td><td class=\"cl-08ec0e38\"><p class=\"cl-08ebcb9e\"><span class=\"cl-08e3f248\">162</span></p></td><td class=\"cl-08ec0e42\"><p class=\"cl-08ebcbb2\"><span class=\"cl-08e3f248\">ALASKA KNIGHT</span></p></td><td class=\"cl-08ec0e42\"><p class=\"cl-08ebcbb2\"><span class=\"cl-08e3f248\">2023-06-08T15:23:29Z</span></p></td><td class=\"cl-08ec0e38\"><p class=\"cl-08ebcb9e\"><span class=\"cl-08e3f248\">56.33826</span></p></td><td class=\"cl-08ec0e38\"><p class=\"cl-08ebcb9e\"><span class=\"cl-08e3f248\">-163.4162</span></p></td><td class=\"cl-08ec0e38\"><p class=\"cl-08ebcb9e\"><span class=\"cl-08e3f248\">56.31646</span></p></td><td class=\"cl-08ec0e38\"><p class=\"cl-08ebcb9e\"><span class=\"cl-08e3f248\">-163.4189</span></p></td><td class=\"cl-08ec0e38\"><p class=\"cl-08ebcb9e\"><span class=\"cl-08e3f248\">3.1</span></p></td><td class=\"cl-08ec0e38\"><p class=\"cl-08ebcb9e\"><span class=\"cl-08e3f248\">6.5</span></p></td><td class=\"cl-08ec0e38\"><p class=\"cl-08ebcb9e\"><span class=\"cl-08e3f248\">84</span></p></td><td class=\"cl-08ec0e38\"><p class=\"cl-08ebcb9e\"><span class=\"cl-08e3f248\">2.428</span></p></td><td class=\"cl-08ec0e38\"><p class=\"cl-08ebcb9e\"><span class=\"cl-08e3f248\">0.442</span></p></td><td class=\"cl-08ec0e38\"><p class=\"cl-08ebcb9e\"><span class=\"cl-08e3f248\">16.040</span></p></td><td class=\"cl-08ec0e38\"><p class=\"cl-08ebcb9e\"><span class=\"cl-08e3f248\">2.396</span></p></td><td class=\"cl-08ec0e38\"><p class=\"cl-08ebcb9e\"><span class=\"cl-08e3f248\">0.038945</span></p></td><td class=\"cl-08ec0e38\"><p class=\"cl-08ebcb9e\"><span class=\"cl-08e3f248\">1.1</span></p></td></tr></tbody></table></div>\n```\n\n:::\n:::\n\n\n### Identify `species_code` for walleye pollock\n\nIn the catch data, we itemize species catches by `species_code`. To find out which `species_code` to use, you can check variations on the following code. Note that here the word `pollock` is case sensitive. All species `common_name` entries are lower case except for proper nouns (e.g., \"Pacific\"). The notation for finding a string is to use `%` around the phrase. Since `%` is a reserved character in a URL, you have to replace `%` with `%25`. Similarly, `%20` needs to be used in place of a space (e.g., between \"walleye\" and \"pollock\": `\"walleye%20pollock\"}'`).  \n\n\n::: {.cell}\n\n```{.r .cell-code}\n## query the API link. Use: \nres <- httr::GET(url = paste0(api_link_species, '?q={%22common_name%22:%22walleye%20pollock%22}'))\n# OR\nres <- httr::GET(url = paste0(api_link_species, '?q={\"common_name\":{\"$like\":\"%25pollock%25\"}}'))\n# OR\nres <- httr::GET(url = paste0(api_link_species, '?q={\"common_name\":\"walleye%20pollock\"}'))\n\n## convert from JSON format\ndata <- jsonlite::fromJSON(base::rawToChar(res$content)) \n\n# save outputs for later comparison\ndat_species_ex <- data$items |> dplyr::select(-links) # necessary for API accounting, but not part of the dataset\n```\n:::\n\n\n\n::: {.cell tbl-cap='Walleye pollock species information. '}\n\n```{.r .cell-code}\n# Print the first few lines of the data\ndat_species_ex |> \n  head(3) |> \n  flextable::flextable() |>\n  flextable::colformat_num(\n      j = c(\"species_code\"), \n      big.mark = \"\") |> \n  flextable::theme_zebra()\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"tabwid\"><style>.cl-097d26f2{}.cl-096bc416{font-family:'Arial';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-096bc42a{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-0972a2b8{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-0972a2cc{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-0972eab6{width:0.75in;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0972eaca{width:0.75in;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0972eacb{width:0.75in;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-0972ead4{width:0.75in;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-097d26f2'><thead><tr style=\"overflow-wrap:break-word;\"><th class=\"cl-0972eab6\"><p class=\"cl-0972a2b8\"><span class=\"cl-096bc416\">species_code</span></p></th><th class=\"cl-0972eaca\"><p class=\"cl-0972a2cc\"><span class=\"cl-096bc416\">scientific_name</span></p></th><th class=\"cl-0972eaca\"><p class=\"cl-0972a2cc\"><span class=\"cl-096bc416\">common_name</span></p></th><th class=\"cl-0972eaca\"><p class=\"cl-0972a2cc\"><span class=\"cl-096bc416\">id_rank</span></p></th><th class=\"cl-0972eab6\"><p class=\"cl-0972a2b8\"><span class=\"cl-096bc416\">worms</span></p></th><th class=\"cl-0972eab6\"><p class=\"cl-0972a2b8\"><span class=\"cl-096bc416\">itis</span></p></th></tr></thead><tbody><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-0972eacb\"><p class=\"cl-0972a2b8\"><span class=\"cl-096bc42a\">21740</span></p></td><td class=\"cl-0972ead4\"><p class=\"cl-0972a2cc\"><span class=\"cl-096bc42a\">Gadus chalcogrammus</span></p></td><td class=\"cl-0972ead4\"><p class=\"cl-0972a2cc\"><span class=\"cl-096bc42a\">walleye pollock</span></p></td><td class=\"cl-0972ead4\"><p class=\"cl-0972a2cc\"><span class=\"cl-096bc42a\">species</span></p></td><td class=\"cl-0972eacb\"><p class=\"cl-0972a2b8\"><span class=\"cl-096bc42a\">300,735</span></p></td><td class=\"cl-0972eacb\"><p class=\"cl-0972a2b8\"><span class=\"cl-096bc42a\">934,083</span></p></td></tr></tbody></table></div>\n```\n\n:::\n:::\n\n\n### Then, apply the `hauljoins` and `species_code` to catch query\n\nWe'll use the data from the haul and species table we collected before to select 2023 eastern Bering Sea walleye pollock catch data. \n\n\n::: {.cell}\n\n```{.r .cell-code}\n## query the API link\n# data for all walleye pollock caught in all 2023 eastern Bering Sea survey hauls\ndat <- data.frame()\n# there must be a better way to select multiple values for one parameter, \n# but saving that, we will loop through each hauljoin and collect the data of interest\nfor (i in 1:nrow(dat_haul_ex)) {\n  res <- httr::GET(url = paste0(\n    api_link_catch, \n    '?q={\"species_code\":21740,\"hauljoin\":', dat_haul_ex$hauljoin[i],'}'))\n  ## convert from JSON format\n  data <- jsonlite::fromJSON(base::rawToChar(res$content)) \n  if (length(data$items) != 0) {\n    dat <- dplyr::bind_rows(\n      dat,\n      data$items |> \n        dplyr::select(-links)) # necessary for API accounting, but not part of the dataset\n  }\n}\n```\n:::\n\n\nExplore data:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Find how many rows and columns are in the data pull\nprint(paste0(\"rows: \", nrow(dat), \"; cols: \", ncol(dat)))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"rows: 374; cols: 7\"\n```\n\n\n:::\n\n```{.r .cell-code}\n# learn about the structure of the data\nsummary(dat)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n    hauljoin       species_code     cpue_kgkm2          cpue_nokm2       \n Min.   :-23019   Min.   :21740   Min.   :    10.34   Min.   :    18.26  \n 1st Qu.:-22777   1st Qu.:21740   1st Qu.:  1454.44   1st Qu.:  2281.20  \n Median :-22540   Median :21740   Median :  3286.76   Median :  5863.07  \n Mean   :-22553   Mean   :21740   Mean   :  6364.85   Mean   : 11540.65  \n 3rd Qu.:-22324   3rd Qu.:21740   3rd Qu.:  6956.25   3rd Qu.: 12456.99  \n Max.   :-22110   Max.   :21740   Max.   :148679.68   Max.   :202321.08  \n     count          weight_kg        taxon_confidence  \n Min.   :   1.0   Min.   :   0.492   Length:374        \n 1st Qu.: 113.2   1st Qu.:  71.560   Class :character  \n Median : 284.0   Median : 162.310   Mode  :character  \n Mean   : 572.8   Mean   : 315.419                     \n 3rd Qu.: 616.5   3rd Qu.: 350.399                     \n Max.   :9997.0   Max.   :7346.495                     \n```\n\n\n:::\n\n```{.r .cell-code}\n# Print the first few lines of the data \ndat |> \n  head(3) |> \n  flextable::flextable() |>\n  flextable::colformat_num(\n      j = c(\"hauljoin\", \"species_code\"), \n      big.mark = \"\") |> \n  flextable::theme_zebra()\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"tabwid\"><style>.cl-390ea652{}.cl-38f87882{font-family:'Arial';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-38f87896{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-38ff6d22{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-38ff6d36{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-38ffafd0{width:0.75in;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-38ffafe4{width:0.75in;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-38ffafe5{width:0.75in;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-38ffaff8{width:0.75in;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-38ffaff9{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-38ffb002{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-390ea652'><thead><tr style=\"overflow-wrap:break-word;\"><th class=\"cl-38ffafd0\"><p class=\"cl-38ff6d22\"><span class=\"cl-38f87882\">hauljoin</span></p></th><th class=\"cl-38ffafd0\"><p class=\"cl-38ff6d22\"><span class=\"cl-38f87882\">species_code</span></p></th><th class=\"cl-38ffafd0\"><p class=\"cl-38ff6d22\"><span class=\"cl-38f87882\">cpue_kgkm2</span></p></th><th class=\"cl-38ffafd0\"><p class=\"cl-38ff6d22\"><span class=\"cl-38f87882\">cpue_nokm2</span></p></th><th class=\"cl-38ffafd0\"><p class=\"cl-38ff6d22\"><span class=\"cl-38f87882\">count</span></p></th><th class=\"cl-38ffafd0\"><p class=\"cl-38ff6d22\"><span class=\"cl-38f87882\">weight_kg</span></p></th><th class=\"cl-38ffafe4\"><p class=\"cl-38ff6d36\"><span class=\"cl-38f87882\">taxon_confidence</span></p></th></tr></thead><tbody><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-38ffafe5\"><p class=\"cl-38ff6d22\"><span class=\"cl-38f87896\">-22283</span></p></td><td class=\"cl-38ffafe5\"><p class=\"cl-38ff6d22\"><span class=\"cl-38f87896\">21740</span></p></td><td class=\"cl-38ffafe5\"><p class=\"cl-38ff6d22\"><span class=\"cl-38f87896\">644.3718</span></p></td><td class=\"cl-38ffafe5\"><p class=\"cl-38ff6d22\"><span class=\"cl-38f87896\">963.6891</span></p></td><td class=\"cl-38ffafe5\"><p class=\"cl-38ff6d22\"><span class=\"cl-38f87896\">43</span></p></td><td class=\"cl-38ffafe5\"><p class=\"cl-38ff6d22\"><span class=\"cl-38f87896\">28.752</span></p></td><td class=\"cl-38ffaff8\"><p class=\"cl-38ff6d36\"><span class=\"cl-38f87896\">High</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-38ffaff9\"><p class=\"cl-38ff6d22\"><span class=\"cl-38f87896\">-22284</span></p></td><td class=\"cl-38ffaff9\"><p class=\"cl-38ff6d22\"><span class=\"cl-38f87896\">21740</span></p></td><td class=\"cl-38ffaff9\"><p class=\"cl-38ff6d22\"><span class=\"cl-38f87896\">3,554.5913</span></p></td><td class=\"cl-38ffaff9\"><p class=\"cl-38ff6d22\"><span class=\"cl-38f87896\">6,998.5742</span></p></td><td class=\"cl-38ffaff9\"><p class=\"cl-38ff6d22\"><span class=\"cl-38f87896\">317</span></p></td><td class=\"cl-38ffaff9\"><p class=\"cl-38ff6d22\"><span class=\"cl-38f87896\">161.005</span></p></td><td class=\"cl-38ffb002\"><p class=\"cl-38ff6d36\"><span class=\"cl-38f87896\">High</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-38ffafe5\"><p class=\"cl-38ff6d22\"><span class=\"cl-38f87896\">-22285</span></p></td><td class=\"cl-38ffafe5\"><p class=\"cl-38ff6d22\"><span class=\"cl-38f87896\">21740</span></p></td><td class=\"cl-38ffafe5\"><p class=\"cl-38ff6d22\"><span class=\"cl-38f87896\">6,940.8696</span></p></td><td class=\"cl-38ffafe5\"><p class=\"cl-38ff6d22\"><span class=\"cl-38f87896\">9,808.6744</span></p></td><td class=\"cl-38ffafe5\"><p class=\"cl-38ff6d22\"><span class=\"cl-38f87896\">382</span></p></td><td class=\"cl-38ffafe5\"><p class=\"cl-38ff6d22\"><span class=\"cl-38f87896\">270.313</span></p></td><td class=\"cl-38ffaff8\"><p class=\"cl-38ff6d36\"><span class=\"cl-38f87896\">High</span></p></td></tr></tbody></table></div>\n```\n\n:::\n\n```{.r .cell-code}\n# save outputs for later comparison\ndat_catch_ex <- dat\n```\n:::\n\n\nFor reference and to help break down the above query, see these other query examples:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# data for haul -22775 (i.e., one specific haul)?\nres <- httr::GET(url = paste0(api_link_catch, \n                              '?offset=',i,'&limit=10000&q={\"hauljoin\":-22775}'))\n\n# data for all walleye pollock (i.e., one species) caught in all years and surveys\nres <- httr::GET(url = paste0(api_link_catch, \n                              '?offset=',i,'&limit=10000&q={\"species_code\":21740}'))\n```\n:::\n\n\n\n\n\n\n\n### Create zero-filled data for 2023 eastern Bering Sea walleye pollock and plot\n\nIt is important to create and have access to zero-fill (presence and absence) so you can do simple analyses and plot data. \n\n\n::: {.cell}\n\n```{.r .cell-code}\ndat <- dplyr::full_join(\n  dat_haul_ex,\n  dat_catch_ex) |> \n  dplyr::full_join(\n    dat_species_ex)  |> \n  # modify zero-filled rows\n  dplyr::mutate(\n    cpue_kgkm2 = ifelse(is.na(cpue_kgkm2), 0, cpue_kgkm2),\n    cpue_nokm2 = ifelse(is.na(cpue_nokm2), 0, cpue_nokm2),\n    count = ifelse(is.na(count), 0, count),\n    weight_kg = ifelse(is.na(weight_kg), 0, weight_kg))\n```\n:::\n\n\nExplore data\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Find how many rows and columns are in the data pull\nprint(paste0(\"rows: \", nrow(dat), \"; cols: \", ncol(dat)))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"rows: 376; cols: 38\"\n```\n\n\n:::\n\n```{.r .cell-code}\n# learn about the structure of the data\nsummary(dat)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n      year          srvy              survey          survey_name       \n Min.   :2023   Length:376         Length:376         Length:376        \n 1st Qu.:2023   Class :character   Class :character   Class :character  \n Median :2023   Mode  :character   Mode  :character   Mode  :character  \n Mean   :2023                                                           \n 3rd Qu.:2023                                                           \n Max.   :2023                                                           \n                                                                        \n survey_definition_id     cruise         cruisejoin        hauljoin     \n Min.   :98           Min.   :202301   Min.   :-760.0   Min.   :-23019  \n 1st Qu.:98           1st Qu.:202301   1st Qu.:-760.0   1st Qu.:-22776  \n Median :98           Median :202301   Median :-759.0   Median :-22539  \n Mean   :98           Mean   :202301   Mean   :-759.5   Mean   :-22552  \n 3rd Qu.:98           3rd Qu.:202301   3rd Qu.:-759.0   3rd Qu.:-22333  \n Max.   :98           Max.   :202301   Max.   :-759.0   Max.   :-22110  \n                                                                        \n      haul           stratum        station            vessel_id    \n Min.   :  7.00   Min.   :10.00   Length:376         Min.   :134.0  \n 1st Qu.: 65.75   1st Qu.:31.00   Class :character   1st Qu.:134.0  \n Median :114.00   Median :41.00   Mode  :character   Median :162.0  \n Mean   :114.16   Mean   :39.22                      Mean   :148.3  \n 3rd Qu.:161.25   3rd Qu.:50.00                      3rd Qu.:162.0  \n Max.   :224.00   Max.   :90.00                      Max.   :162.0  \n                                                                    \n vessel_name         date_time         latitude_dd_start longitude_dd_start\n Length:376         Length:376         Min.   :54.66     Min.   :-178.2    \n Class :character   Class :character   1st Qu.:57.00     1st Qu.:-172.7    \n Mode  :character   Mode  :character   Median :58.02     Median :-168.9    \n                                       Mean   :58.26     Mean   :-168.8    \n                                       3rd Qu.:59.50     3rd Qu.:-165.2    \n                                       Max.   :62.01     Max.   :-158.3    \n                                                                           \n latitude_dd_end longitude_dd_end bottom_temperature_c surface_temperature_c\n Min.   :54.68   Min.   :-178.2   Min.   :-1.600       Min.   : 1.700       \n 1st Qu.:57.01   1st Qu.:-172.7   1st Qu.: 1.200       1st Qu.: 4.200       \n Median :58.02   Median :-168.9   Median : 2.700       Median : 6.550       \n Mean   :58.26   Mean   :-168.8   Mean   : 2.249       Mean   : 6.386       \n 3rd Qu.:59.50   3rd Qu.:-165.2   3rd Qu.: 3.500       3rd Qu.: 8.525       \n Max.   :62.01   Max.   :-158.3   Max.   : 5.400       Max.   :11.000       \n                                                                            \n    depth_m       distance_fished_km  duration_hr      net_width_m   \n Min.   : 20.00   Min.   :1.065      Min.   :0.1890   Min.   :12.90  \n 1st Qu.: 54.75   1st Qu.:2.805      1st Qu.:0.5100   1st Qu.:16.66  \n Median : 74.00   Median :2.889      Median :0.5180   Median :17.27  \n Mean   : 80.75   Mean   :2.854      Mean   :0.5129   Mean   :17.15  \n 3rd Qu.:105.00   3rd Qu.:2.945      3rd Qu.:0.5260   3rd Qu.:17.83  \n Max.   :171.00   Max.   :3.849      Max.   :0.6560   Max.   :20.29  \n                                                                     \n  net_height_m   area_swept_km2     performance      species_code  \n Min.   :1.300   Min.   :0.02017   Min.   :0.0000   Min.   :21740  \n 1st Qu.:1.875   1st Qu.:0.04725   1st Qu.:0.0000   1st Qu.:21740  \n Median :2.064   Median :0.04944   Median :0.0000   Median :21740  \n Mean   :2.107   Mean   :0.04892   Mean   :0.1075   Mean   :21740  \n 3rd Qu.:2.343   3rd Qu.:0.05134   3rd Qu.:0.0000   3rd Qu.:21740  \n Max.   :3.196   Max.   :0.06369   Max.   :6.2200   Max.   :21740  \n                                                    NA's   :2      \n   cpue_kgkm2       cpue_nokm2         count          weight_kg      \n Min.   :     0   Min.   :     0   Min.   :   0.0   Min.   :   0.00  \n 1st Qu.:  1431   1st Qu.:  2268   1st Qu.: 112.0   1st Qu.:  70.64  \n Median :  3273   Median :  5842   Median : 280.0   Median : 161.44  \n Mean   :  6331   Mean   : 11479   Mean   : 569.8   Mean   : 313.74  \n 3rd Qu.:  6946   3rd Qu.: 12345   3rd Qu.: 611.5   3rd Qu.: 349.81  \n Max.   :148680   Max.   :202321   Max.   :9997.0   Max.   :7346.49  \n                                                                     \n taxon_confidence   scientific_name    common_name          id_rank         \n Length:376         Length:376         Length:376         Length:376        \n Class :character   Class :character   Class :character   Class :character  \n Mode  :character   Mode  :character   Mode  :character   Mode  :character  \n                                                                            \n                                                                            \n                                                                            \n                                                                            \n     worms             itis       \n Min.   :300735   Min.   :934083  \n 1st Qu.:300735   1st Qu.:934083  \n Median :300735   Median :934083  \n Mean   :300735   Mean   :934083  \n 3rd Qu.:300735   3rd Qu.:934083  \n Max.   :300735   Max.   :934083  \n NA's   :2        NA's   :2       \n```\n\n\n:::\n\n```{.r .cell-code}\n# Print the first few lines of the data \ndat |> \n  head(3) |> \n  flextable::flextable() |>\n  flextable::colformat_num(\n      j = c(\"year\", \"cruise\", \"cruisejoin\", \"species_code\"), \n      big.mark = \"\") |> \n  flextable::theme_zebra()\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"tabwid\"><style>.cl-39b0c59a{}.cl-399bfafc{font-family:'Arial';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-399bfb10{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-39a389de{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-39a389f2{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-39a3cf34{width:0.75in;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-39a3cf48{width:0.75in;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-39a3cf52{width:0.75in;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-39a3cf53{width:0.75in;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-39a3cf5c{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-39a3cf66{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-39b0c59a'><thead><tr style=\"overflow-wrap:break-word;\"><th class=\"cl-39a3cf34\"><p class=\"cl-39a389de\"><span class=\"cl-399bfafc\">year</span></p></th><th class=\"cl-39a3cf48\"><p class=\"cl-39a389f2\"><span class=\"cl-399bfafc\">srvy</span></p></th><th class=\"cl-39a3cf48\"><p class=\"cl-39a389f2\"><span class=\"cl-399bfafc\">survey</span></p></th><th class=\"cl-39a3cf48\"><p class=\"cl-39a389f2\"><span class=\"cl-399bfafc\">survey_name</span></p></th><th class=\"cl-39a3cf34\"><p class=\"cl-39a389de\"><span class=\"cl-399bfafc\">survey_definition_id</span></p></th><th class=\"cl-39a3cf34\"><p class=\"cl-39a389de\"><span class=\"cl-399bfafc\">cruise</span></p></th><th class=\"cl-39a3cf34\"><p class=\"cl-39a389de\"><span class=\"cl-399bfafc\">cruisejoin</span></p></th><th class=\"cl-39a3cf34\"><p class=\"cl-39a389de\"><span class=\"cl-399bfafc\">hauljoin</span></p></th><th class=\"cl-39a3cf34\"><p class=\"cl-39a389de\"><span class=\"cl-399bfafc\">haul</span></p></th><th class=\"cl-39a3cf34\"><p class=\"cl-39a389de\"><span class=\"cl-399bfafc\">stratum</span></p></th><th class=\"cl-39a3cf48\"><p class=\"cl-39a389f2\"><span class=\"cl-399bfafc\">station</span></p></th><th class=\"cl-39a3cf34\"><p class=\"cl-39a389de\"><span class=\"cl-399bfafc\">vessel_id</span></p></th><th class=\"cl-39a3cf48\"><p class=\"cl-39a389f2\"><span class=\"cl-399bfafc\">vessel_name</span></p></th><th class=\"cl-39a3cf48\"><p class=\"cl-39a389f2\"><span class=\"cl-399bfafc\">date_time</span></p></th><th class=\"cl-39a3cf34\"><p class=\"cl-39a389de\"><span class=\"cl-399bfafc\">latitude_dd_start</span></p></th><th class=\"cl-39a3cf34\"><p class=\"cl-39a389de\"><span class=\"cl-399bfafc\">longitude_dd_start</span></p></th><th class=\"cl-39a3cf34\"><p class=\"cl-39a389de\"><span class=\"cl-399bfafc\">latitude_dd_end</span></p></th><th class=\"cl-39a3cf34\"><p class=\"cl-39a389de\"><span class=\"cl-399bfafc\">longitude_dd_end</span></p></th><th class=\"cl-39a3cf34\"><p class=\"cl-39a389de\"><span class=\"cl-399bfafc\">bottom_temperature_c</span></p></th><th class=\"cl-39a3cf34\"><p class=\"cl-39a389de\"><span class=\"cl-399bfafc\">surface_temperature_c</span></p></th><th class=\"cl-39a3cf34\"><p class=\"cl-39a389de\"><span class=\"cl-399bfafc\">depth_m</span></p></th><th class=\"cl-39a3cf34\"><p class=\"cl-39a389de\"><span class=\"cl-399bfafc\">distance_fished_km</span></p></th><th class=\"cl-39a3cf34\"><p class=\"cl-39a389de\"><span class=\"cl-399bfafc\">duration_hr</span></p></th><th class=\"cl-39a3cf34\"><p class=\"cl-39a389de\"><span class=\"cl-399bfafc\">net_width_m</span></p></th><th class=\"cl-39a3cf34\"><p class=\"cl-39a389de\"><span class=\"cl-399bfafc\">net_height_m</span></p></th><th class=\"cl-39a3cf34\"><p class=\"cl-39a389de\"><span class=\"cl-399bfafc\">area_swept_km2</span></p></th><th class=\"cl-39a3cf34\"><p class=\"cl-39a389de\"><span class=\"cl-399bfafc\">performance</span></p></th><th class=\"cl-39a3cf34\"><p class=\"cl-39a389de\"><span class=\"cl-399bfafc\">species_code</span></p></th><th class=\"cl-39a3cf34\"><p class=\"cl-39a389de\"><span class=\"cl-399bfafc\">cpue_kgkm2</span></p></th><th class=\"cl-39a3cf34\"><p class=\"cl-39a389de\"><span class=\"cl-399bfafc\">cpue_nokm2</span></p></th><th class=\"cl-39a3cf34\"><p class=\"cl-39a389de\"><span class=\"cl-399bfafc\">count</span></p></th><th class=\"cl-39a3cf34\"><p class=\"cl-39a389de\"><span class=\"cl-399bfafc\">weight_kg</span></p></th><th class=\"cl-39a3cf48\"><p class=\"cl-39a389f2\"><span class=\"cl-399bfafc\">taxon_confidence</span></p></th><th class=\"cl-39a3cf48\"><p class=\"cl-39a389f2\"><span class=\"cl-399bfafc\">scientific_name</span></p></th><th class=\"cl-39a3cf48\"><p class=\"cl-39a389f2\"><span class=\"cl-399bfafc\">common_name</span></p></th><th class=\"cl-39a3cf48\"><p class=\"cl-39a389f2\"><span class=\"cl-399bfafc\">id_rank</span></p></th><th class=\"cl-39a3cf34\"><p class=\"cl-39a389de\"><span class=\"cl-399bfafc\">worms</span></p></th><th class=\"cl-39a3cf34\"><p class=\"cl-39a389de\"><span class=\"cl-399bfafc\">itis</span></p></th></tr></thead><tbody><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-39a3cf52\"><p class=\"cl-39a389de\"><span class=\"cl-399bfb10\">2023</span></p></td><td class=\"cl-39a3cf53\"><p class=\"cl-39a389f2\"><span class=\"cl-399bfb10\">EBS</span></p></td><td class=\"cl-39a3cf53\"><p class=\"cl-39a389f2\"><span class=\"cl-399bfb10\">eastern Bering Sea</span></p></td><td class=\"cl-39a3cf53\"><p class=\"cl-39a389f2\"><span class=\"cl-399bfb10\">Eastern Bering Sea Crab/Groundfish Bottom Trawl Survey</span></p></td><td class=\"cl-39a3cf52\"><p class=\"cl-39a389de\"><span class=\"cl-399bfb10\">98</span></p></td><td class=\"cl-39a3cf52\"><p class=\"cl-39a389de\"><span class=\"cl-399bfb10\">202301</span></p></td><td class=\"cl-39a3cf52\"><p class=\"cl-39a389de\"><span class=\"cl-399bfb10\">-759</span></p></td><td class=\"cl-39a3cf52\"><p class=\"cl-39a389de\"><span class=\"cl-399bfb10\">-22,283</span></p></td><td class=\"cl-39a3cf52\"><p class=\"cl-39a389de\"><span class=\"cl-399bfb10\">64</span></p></td><td class=\"cl-39a3cf52\"><p class=\"cl-39a389de\"><span class=\"cl-399bfb10\">31</span></p></td><td class=\"cl-39a3cf53\"><p class=\"cl-39a389f2\"><span class=\"cl-399bfb10\">G-08</span></p></td><td class=\"cl-39a3cf52\"><p class=\"cl-39a389de\"><span class=\"cl-399bfb10\">162</span></p></td><td class=\"cl-39a3cf53\"><p class=\"cl-39a389f2\"><span class=\"cl-399bfb10\">ALASKA KNIGHT</span></p></td><td class=\"cl-39a3cf53\"><p class=\"cl-39a389f2\"><span class=\"cl-399bfb10\">2023-06-08T10:05:05Z</span></p></td><td class=\"cl-39a3cf52\"><p class=\"cl-39a389de\"><span class=\"cl-399bfb10\">57.00863</span></p></td><td class=\"cl-39a3cf52\"><p class=\"cl-39a389de\"><span class=\"cl-399bfb10\">-163.3957</span></p></td><td class=\"cl-39a3cf52\"><p class=\"cl-39a389de\"><span class=\"cl-399bfb10\">56.98449</span></p></td><td class=\"cl-39a3cf52\"><p class=\"cl-39a389de\"><span class=\"cl-399bfb10\">-163.4006</span></p></td><td class=\"cl-39a3cf52\"><p class=\"cl-39a389de\"><span class=\"cl-399bfb10\">2.7</span></p></td><td class=\"cl-39a3cf52\"><p class=\"cl-39a389de\"><span class=\"cl-399bfb10\">5.1</span></p></td><td class=\"cl-39a3cf52\"><p class=\"cl-39a389de\"><span class=\"cl-399bfb10\">66</span></p></td><td class=\"cl-39a3cf52\"><p class=\"cl-39a389de\"><span class=\"cl-399bfb10\">2.700</span></p></td><td class=\"cl-39a3cf52\"><p class=\"cl-39a389de\"><span class=\"cl-399bfb10\">0.488</span></p></td><td class=\"cl-39a3cf52\"><p class=\"cl-39a389de\"><span class=\"cl-399bfb10\">16.526</span></p></td><td class=\"cl-39a3cf52\"><p class=\"cl-39a389de\"><span class=\"cl-399bfb10\">2.466</span></p></td><td class=\"cl-39a3cf52\"><p class=\"cl-39a389de\"><span class=\"cl-399bfb10\">0.044620</span></p></td><td class=\"cl-39a3cf52\"><p class=\"cl-39a389de\"><span class=\"cl-399bfb10\">0.0</span></p></td><td class=\"cl-39a3cf52\"><p class=\"cl-39a389de\"><span class=\"cl-399bfb10\">21740</span></p></td><td class=\"cl-39a3cf52\"><p class=\"cl-39a389de\"><span class=\"cl-399bfb10\">644.3718</span></p></td><td class=\"cl-39a3cf52\"><p class=\"cl-39a389de\"><span class=\"cl-399bfb10\">963.6891</span></p></td><td class=\"cl-39a3cf52\"><p class=\"cl-39a389de\"><span class=\"cl-399bfb10\">43</span></p></td><td class=\"cl-39a3cf52\"><p class=\"cl-39a389de\"><span class=\"cl-399bfb10\">28.752</span></p></td><td class=\"cl-39a3cf53\"><p class=\"cl-39a389f2\"><span class=\"cl-399bfb10\">High</span></p></td><td class=\"cl-39a3cf53\"><p class=\"cl-39a389f2\"><span class=\"cl-399bfb10\">Gadus chalcogrammus</span></p></td><td class=\"cl-39a3cf53\"><p class=\"cl-39a389f2\"><span class=\"cl-399bfb10\">walleye pollock</span></p></td><td class=\"cl-39a3cf53\"><p class=\"cl-39a389f2\"><span class=\"cl-399bfb10\">species</span></p></td><td class=\"cl-39a3cf52\"><p class=\"cl-39a389de\"><span class=\"cl-399bfb10\">300,735</span></p></td><td class=\"cl-39a3cf52\"><p class=\"cl-39a389de\"><span class=\"cl-399bfb10\">934,083</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-39a3cf5c\"><p class=\"cl-39a389de\"><span class=\"cl-399bfb10\">2023</span></p></td><td class=\"cl-39a3cf66\"><p class=\"cl-39a389f2\"><span class=\"cl-399bfb10\">EBS</span></p></td><td class=\"cl-39a3cf66\"><p class=\"cl-39a389f2\"><span class=\"cl-399bfb10\">eastern Bering Sea</span></p></td><td class=\"cl-39a3cf66\"><p class=\"cl-39a389f2\"><span class=\"cl-399bfb10\">Eastern Bering Sea Crab/Groundfish Bottom Trawl Survey</span></p></td><td class=\"cl-39a3cf5c\"><p class=\"cl-39a389de\"><span class=\"cl-399bfb10\">98</span></p></td><td class=\"cl-39a3cf5c\"><p class=\"cl-39a389de\"><span class=\"cl-399bfb10\">202301</span></p></td><td class=\"cl-39a3cf5c\"><p class=\"cl-39a389de\"><span class=\"cl-399bfb10\">-759</span></p></td><td class=\"cl-39a3cf5c\"><p class=\"cl-39a389de\"><span class=\"cl-399bfb10\">-22,284</span></p></td><td class=\"cl-39a3cf5c\"><p class=\"cl-39a389de\"><span class=\"cl-399bfb10\">63</span></p></td><td class=\"cl-39a3cf5c\"><p class=\"cl-39a389de\"><span class=\"cl-399bfb10\">10</span></p></td><td class=\"cl-39a3cf66\"><p class=\"cl-39a389f2\"><span class=\"cl-399bfb10\">H-08</span></p></td><td class=\"cl-39a3cf5c\"><p class=\"cl-39a389de\"><span class=\"cl-399bfb10\">162</span></p></td><td class=\"cl-39a3cf66\"><p class=\"cl-39a389f2\"><span class=\"cl-399bfb10\">ALASKA KNIGHT</span></p></td><td class=\"cl-39a3cf66\"><p class=\"cl-39a389f2\"><span class=\"cl-399bfb10\">2023-06-08T07:24:07Z</span></p></td><td class=\"cl-39a3cf5c\"><p class=\"cl-39a389de\"><span class=\"cl-399bfb10\">57.34861</span></p></td><td class=\"cl-39a3cf5c\"><p class=\"cl-39a389de\"><span class=\"cl-399bfb10\">-163.3868</span></p></td><td class=\"cl-39a3cf5c\"><p class=\"cl-39a389de\"><span class=\"cl-399bfb10\">57.32483</span></p></td><td class=\"cl-39a3cf5c\"><p class=\"cl-39a389de\"><span class=\"cl-399bfb10\">-163.3967</span></p></td><td class=\"cl-39a3cf5c\"><p class=\"cl-39a389de\"><span class=\"cl-399bfb10\">1.7</span></p></td><td class=\"cl-39a3cf5c\"><p class=\"cl-39a389de\"><span class=\"cl-399bfb10\">4.2</span></p></td><td class=\"cl-39a3cf5c\"><p class=\"cl-39a389de\"><span class=\"cl-399bfb10\">53</span></p></td><td class=\"cl-39a3cf5c\"><p class=\"cl-39a389de\"><span class=\"cl-399bfb10\">2.710</span></p></td><td class=\"cl-39a3cf5c\"><p class=\"cl-39a389de\"><span class=\"cl-399bfb10\">0.494</span></p></td><td class=\"cl-39a3cf5c\"><p class=\"cl-39a389de\"><span class=\"cl-399bfb10\">16.714</span></p></td><td class=\"cl-39a3cf5c\"><p class=\"cl-39a389de\"><span class=\"cl-399bfb10\">2.132</span></p></td><td class=\"cl-39a3cf5c\"><p class=\"cl-39a389de\"><span class=\"cl-399bfb10\">0.045295</span></p></td><td class=\"cl-39a3cf5c\"><p class=\"cl-39a389de\"><span class=\"cl-399bfb10\">0.0</span></p></td><td class=\"cl-39a3cf5c\"><p class=\"cl-39a389de\"><span class=\"cl-399bfb10\">21740</span></p></td><td class=\"cl-39a3cf5c\"><p class=\"cl-39a389de\"><span class=\"cl-399bfb10\">3,554.5913</span></p></td><td class=\"cl-39a3cf5c\"><p class=\"cl-39a389de\"><span class=\"cl-399bfb10\">6,998.5742</span></p></td><td class=\"cl-39a3cf5c\"><p class=\"cl-39a389de\"><span class=\"cl-399bfb10\">317</span></p></td><td class=\"cl-39a3cf5c\"><p class=\"cl-39a389de\"><span class=\"cl-399bfb10\">161.005</span></p></td><td class=\"cl-39a3cf66\"><p class=\"cl-39a389f2\"><span class=\"cl-399bfb10\">High</span></p></td><td class=\"cl-39a3cf66\"><p class=\"cl-39a389f2\"><span class=\"cl-399bfb10\">Gadus chalcogrammus</span></p></td><td class=\"cl-39a3cf66\"><p class=\"cl-39a389f2\"><span class=\"cl-399bfb10\">walleye pollock</span></p></td><td class=\"cl-39a3cf66\"><p class=\"cl-39a389f2\"><span class=\"cl-399bfb10\">species</span></p></td><td class=\"cl-39a3cf5c\"><p class=\"cl-39a389de\"><span class=\"cl-399bfb10\">300,735</span></p></td><td class=\"cl-39a3cf5c\"><p class=\"cl-39a389de\"><span class=\"cl-399bfb10\">934,083</span></p></td></tr><tr style=\"overflow-wrap:break-word;\"><td class=\"cl-39a3cf52\"><p class=\"cl-39a389de\"><span class=\"cl-399bfb10\">2023</span></p></td><td class=\"cl-39a3cf53\"><p class=\"cl-39a389f2\"><span class=\"cl-399bfb10\">EBS</span></p></td><td class=\"cl-39a3cf53\"><p class=\"cl-39a389f2\"><span class=\"cl-399bfb10\">eastern Bering Sea</span></p></td><td class=\"cl-39a3cf53\"><p class=\"cl-39a389f2\"><span class=\"cl-399bfb10\">Eastern Bering Sea Crab/Groundfish Bottom Trawl Survey</span></p></td><td class=\"cl-39a3cf52\"><p class=\"cl-39a389de\"><span class=\"cl-399bfb10\">98</span></p></td><td class=\"cl-39a3cf52\"><p class=\"cl-39a389de\"><span class=\"cl-399bfb10\">202301</span></p></td><td class=\"cl-39a3cf52\"><p class=\"cl-39a389de\"><span class=\"cl-399bfb10\">-759</span></p></td><td class=\"cl-39a3cf52\"><p class=\"cl-39a389de\"><span class=\"cl-399bfb10\">-22,285</span></p></td><td class=\"cl-39a3cf52\"><p class=\"cl-39a389de\"><span class=\"cl-399bfb10\">66</span></p></td><td class=\"cl-39a3cf52\"><p class=\"cl-39a389de\"><span class=\"cl-399bfb10\">31</span></p></td><td class=\"cl-39a3cf53\"><p class=\"cl-39a389f2\"><span class=\"cl-399bfb10\">E-08</span></p></td><td class=\"cl-39a3cf52\"><p class=\"cl-39a389de\"><span class=\"cl-399bfb10\">162</span></p></td><td class=\"cl-39a3cf53\"><p class=\"cl-39a389f2\"><span class=\"cl-399bfb10\">ALASKA KNIGHT</span></p></td><td class=\"cl-39a3cf53\"><p class=\"cl-39a389f2\"><span class=\"cl-399bfb10\">2023-06-08T15:23:29Z</span></p></td><td class=\"cl-39a3cf52\"><p class=\"cl-39a389de\"><span class=\"cl-399bfb10\">56.33826</span></p></td><td class=\"cl-39a3cf52\"><p class=\"cl-39a389de\"><span class=\"cl-399bfb10\">-163.4162</span></p></td><td class=\"cl-39a3cf52\"><p class=\"cl-39a389de\"><span class=\"cl-399bfb10\">56.31646</span></p></td><td class=\"cl-39a3cf52\"><p class=\"cl-39a389de\"><span class=\"cl-399bfb10\">-163.4189</span></p></td><td class=\"cl-39a3cf52\"><p class=\"cl-39a389de\"><span class=\"cl-399bfb10\">3.1</span></p></td><td class=\"cl-39a3cf52\"><p class=\"cl-39a389de\"><span class=\"cl-399bfb10\">6.5</span></p></td><td class=\"cl-39a3cf52\"><p class=\"cl-39a389de\"><span class=\"cl-399bfb10\">84</span></p></td><td class=\"cl-39a3cf52\"><p class=\"cl-39a389de\"><span class=\"cl-399bfb10\">2.428</span></p></td><td class=\"cl-39a3cf52\"><p class=\"cl-39a389de\"><span class=\"cl-399bfb10\">0.442</span></p></td><td class=\"cl-39a3cf52\"><p class=\"cl-39a389de\"><span class=\"cl-399bfb10\">16.040</span></p></td><td class=\"cl-39a3cf52\"><p class=\"cl-39a389de\"><span class=\"cl-399bfb10\">2.396</span></p></td><td class=\"cl-39a3cf52\"><p class=\"cl-39a389de\"><span class=\"cl-399bfb10\">0.038945</span></p></td><td class=\"cl-39a3cf52\"><p class=\"cl-39a389de\"><span class=\"cl-399bfb10\">1.1</span></p></td><td class=\"cl-39a3cf52\"><p class=\"cl-39a389de\"><span class=\"cl-399bfb10\">21740</span></p></td><td class=\"cl-39a3cf52\"><p class=\"cl-39a389de\"><span class=\"cl-399bfb10\">6,940.8696</span></p></td><td class=\"cl-39a3cf52\"><p class=\"cl-39a389de\"><span class=\"cl-399bfb10\">9,808.6744</span></p></td><td class=\"cl-39a3cf52\"><p class=\"cl-39a389de\"><span class=\"cl-399bfb10\">382</span></p></td><td class=\"cl-39a3cf52\"><p class=\"cl-39a389de\"><span class=\"cl-399bfb10\">270.313</span></p></td><td class=\"cl-39a3cf53\"><p class=\"cl-39a389f2\"><span class=\"cl-399bfb10\">High</span></p></td><td class=\"cl-39a3cf53\"><p class=\"cl-39a389f2\"><span class=\"cl-399bfb10\">Gadus chalcogrammus</span></p></td><td class=\"cl-39a3cf53\"><p class=\"cl-39a389f2\"><span class=\"cl-399bfb10\">walleye pollock</span></p></td><td class=\"cl-39a3cf53\"><p class=\"cl-39a389f2\"><span class=\"cl-399bfb10\">species</span></p></td><td class=\"cl-39a3cf52\"><p class=\"cl-39a389de\"><span class=\"cl-399bfb10\">300,735</span></p></td><td class=\"cl-39a3cf52\"><p class=\"cl-39a389de\"><span class=\"cl-399bfb10\">934,083</span></p></td></tr></tbody></table></div>\n```\n\n:::\n:::\n\n\n### Visualize CPUE data in distribution map\n\nUsing the zero-filled data from the previous example, we can make a few plots! \n\n## Plot locations\n\n\n::: {.cell tbl-cap='CPUE (kg/km^2) of walleye pollock catch at each station in the 2023 eastern Bering Sea bottom trawl survey. Size of black circles denote magnitude of CPUE caught at station and red triangles denote stations where walleye pollock were not caught. '}\n\n```{.r .cell-code}\nlibrary(ggplot2)\n\nggplot2::ggplot(data = dat |> dplyr::filter(cpue_kgkm2 != 0), \n                mapping = aes(x = longitude_dd_start, \n                              y = latitude_dd_start, \n                              size = cpue_kgkm2)) + \n  ggplot2::geom_point(alpha = .75) +\n  ggplot2::geom_point(data = dat |> dplyr::filter(cpue_kgkm2 == 0), \n                      color = \"red\", \n                      shape = 17,\n                      alpha = .75,\n                      size = 3) +\n  ggplot2::xlab(\"Longitude *W\") +\n  ggplot2::ylab(\"Latitude *N\") +\n  ggplot2::ggtitle(label = \"Catches of walleye pollock (Weight CPUE; kg/km2)\", \n                   subtitle = \"2023 eastern Bering Sea bottom trawl survey\") +\n  ggplot2::scale_size_continuous(name = \"Weight (kg)\") + \n  ggplot2::theme_bw()\n```\n\n::: {.cell-output-display}\n![](foss-api-r_files/figure-html/pollock-multi1-loc-1.png){width=672}\n:::\n:::\n\n\n### Plot inverse-distance weighted modeled product of locations\n\nThis map is constructed using [`akgfmaps`](https://github.com/afsc-gap-products/akgfmaps)\n\n\n::: {.cell tbl-cap='Inverse-distance weight CPUE of walleye pollock catch at each station in the 2023 eastern Bering Sea bottom trawl survey. '}\n\n```{.r .cell-code}\n# devtools::install_github(\"afsc-gap-products/akgfmaps\", build_vignettes = TRUE)\nlibrary(akgfmaps)\n\nfigure0 <- akgfmaps::make_idw_map(\n  CPUE_KGHA = dat$cpue_kgkm2, # calculates the same, regardless of units.  \n  LATITUDE = dat$latitude_dd_start, \n  LONGITUDE = dat$longitude_dd_start, \n  region = \"bs.south\", # Predefined EBS area\n  set.breaks = \"jenks\", # Gets Jenks breaks from classint::classIntervals()\n  in.crs = \"+proj=longlat\", # Set input coordinate reference system\n  out.crs = \"EPSG:3338\", # Set output coordinate reference system\n  extrapolation.grid.type = \"sf\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[inverse distance weighted interpolation]\n[inverse distance weighted interpolation]\n```\n\n\n:::\n\n```{.r .cell-code}\nfigure0$plot + # 20x20km grid\n  ggplot2::guides(fill=guide_legend(title = \"walleye pollock\\nCPUE (kg/km2)\"))\n```\n\n::: {.cell-output-display}\n![](foss-api-r_files/figure-html/pollock-multi2-loc-1.png){width=672}\n:::\n:::\n\n\n",
    "supporting": [
      "foss-api-r_files\\figure-html"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../site_libs/tabwid-1.1.3/tabwid.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/tabwid-1.1.3/tabwid.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}